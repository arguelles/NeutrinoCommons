<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">

body { font-family: courier; font-size: 12; }

.code  { font-size: 9; color: #444444; display: none; margin-left: 20px; }
.py_c_api  { color: red; }
.py_macro_api  { color: #FF7000; }
.pyx_c_api  { color: #FF3000; }
.pyx_macro_api  { color: #FF7000; }
.refnanny  { color: #FFA000; }

.error_goto  { color: #FFA000; }

.tag  {  }

.coerce  { color: #008000; border: 1px dotted #008000 }

.py_attr { color: #FF0000; font-weight: bold; }
.c_attr  { color: #0000FF; }

.py_call { color: #FF0000; font-weight: bold; }
.c_call  { color: #0000FF; }

.line { margin: 0em }

</style>
<script>
function toggleDiv(id) {
    theDiv = document.getElementById(id);
    if (theDiv.style.display == 'none') theDiv.style.display = 'block';
    else theDiv.style.display = 'none';
}
</script>
</head>
        <body>
<p>Generated by Cython 0.14.1 on Sun Feb 19 00:21:06 2012
<p>Raw output: <a href="optneuosc.c">optneuosc.c</a>
<pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1")'> 1: """ Small library with the optimiced python osc. calculation functions.</pre>
<pre id='line1' class='code' style='background-color: #FFFF79'>
  /* "optneuosc.pyx":1
 * """ Small library with the optimiced python osc. calculation functions.             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * This library is implemented in Cython. And is meant to be fully compatible
 * with #{neuosc}.
 */
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s____test__, ((PyObject *)__pyx_t_1)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2")'> 2: This library is implemented in Cython. And is meant to be fully compatible</pre>
<pre id='line2' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line3")'> 3: with #{neuosc}.</pre>
<pre id='line3' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line4")'> 4: """</pre>
<pre id='line4' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line5")'> 5: from libc.math cimport sin,cos,sqrt,log</pre>
<pre id='line5' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line6")'> 6: from numpy import zeros,dot,array</pre>
<pre id='line6' class='code' style='background-color: #FFFF2b'>
  /* "optneuosc.pyx":6
 * """
 * from libc.math cimport sin,cos,sqrt,log
 * from numpy import zeros,dot,array             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * from scipy.linalg.matfuncs import expm2
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__zeros));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__zeros));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__zeros));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__dot));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_n_s__dot));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__dot));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__array));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, ((PyObject *)__pyx_n_s__array));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__array));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__numpy), ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__zeros, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__dot);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__dot, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__array, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line7")'> 7: </pre>
<pre id='line7' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line8")'> 8: from scipy.linalg.matfuncs import expm2</pre>
<pre id='line8' class='code' style='background-color: #FFFF4f'>
  /* "optneuosc.pyx":8
 * from numpy import zeros,dot,array
 * 
 * from scipy.linalg.matfuncs import expm2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * # importing some UNoptimice libraries
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s__expm2));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__expm2));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s__expm2));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s_32), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__expm2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__expm2, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line9")'> 9: </pre>
<pre id='line9' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line10")'> 10: # importing some UNoptimice libraries</pre>
<pre id='line10' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line11")'> 11: import neutrinocommon.tools.generaltools as gt</pre>
<pre id='line11' class='code' style='background-color: #FFFF62'>
  /* "optneuosc.pyx":11
 * 
 * # importing some UNoptimice libraries
 * import neutrinocommon.tools.generaltools as gt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import neutrinocommon.shareobjects.taudecay as td
 * import neutrinocommon.physconst.physicsconstants as PC
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s_34));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s_34));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s_33), ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__gt, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line12")'> 12: import neutrinocommon.shareobjects.taudecay as td</pre>
<pre id='line12' class='code' style='background-color: #FFFF62'>
  /* "optneuosc.pyx":12
 * # importing some UNoptimice libraries
 * import neutrinocommon.tools.generaltools as gt
 * import neutrinocommon.shareobjects.taudecay as td             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import neutrinocommon.physconst.physicsconstants as PC
 * import neutrinocommon.neu.xsections as xs
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s_34));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s_34));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s_35), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__td, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line13")'> 13: import neutrinocommon.physconst.physicsconstants as PC</pre>
<pre id='line13' class='code' style='background-color: #FFFF62'>
  /* "optneuosc.pyx":13
 * import neutrinocommon.tools.generaltools as gt
 * import neutrinocommon.shareobjects.taudecay as td
 * import neutrinocommon.physconst.physicsconstants as PC             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import neutrinocommon.neu.xsections as xs
 * import neutrinocommon.neu.neuosc as no
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s_34));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s_34));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s_36), ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__PC, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 13; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line14")'> 14: import neutrinocommon.neu.xsections as xs</pre>
<pre id='line14' class='code' style='background-color: #FFFF62'>
  /* "optneuosc.pyx":14
 * import neutrinocommon.shareobjects.taudecay as td
 * import neutrinocommon.physconst.physicsconstants as PC
 * import neutrinocommon.neu.xsections as xs             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import neutrinocommon.neu.neuosc as no
 * # python modules
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s_34));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s_34));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s_37), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__xs, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line15")'> 15: import neutrinocommon.neu.neuosc as no</pre>
<pre id='line15' class='code' style='background-color: #FFFF62'>
  /* "optneuosc.pyx":15
 * import neutrinocommon.physconst.physicsconstants as PC
 * import neutrinocommon.neu.xsections as xs
 * import neutrinocommon.neu.neuosc as no             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * # python modules
 * import numpy as np
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s_34));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_n_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s_34));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s_38), ((PyObject *)__pyx_t_1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__no, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line16")'> 16: # python modules</pre>
<pre id='line16' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line17")'> 17: import numpy as np</pre>
<pre id='line17' class='code' style='background-color: #FFFF8d'>
  /* "optneuosc.pyx":17
 * import neutrinocommon.neu.neuosc as no
 * # python modules
 * import numpy as np             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * cimport numpy as np
 * import pygsl.odeiv as odeiv
 */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__numpy), 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__np, __pyx_t_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line18")'> 18: cimport numpy as np</pre>
<pre id='line18' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line19")'> 19: import pygsl.odeiv as odeiv</pre>
<pre id='line19' class='code' style='background-color: #FFFF62'>
  /* "optneuosc.pyx":19
 * import numpy as np
 * cimport numpy as np
 * import pygsl.odeiv as odeiv             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * import scipy as sp
 * 
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_n_s_34));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_n_s_34));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_n_s_34));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s_39), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__odeiv, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line20")'> 20: import scipy as sp</pre>
<pre id='line20' class='code' style='background-color: #FFFF8d'>
  /* "optneuosc.pyx":20
 * cimport numpy as np
 * import pygsl.odeiv as odeiv
 * import scipy as sp             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * # FUNCTIONS #
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(((PyObject *)__pyx_n_s__scipy), 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_m, __pyx_n_s__sp, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line21")'> 21: </pre>
<pre id='line21' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line22")'> 22: # FUNCTIONS #</pre>
<pre id='line22' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line23")'> 23: </pre>
<pre id='line23' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line24")'> 24: cdef extern from "complex.h":</pre>
<pre id='line24' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line25")'> 25:     double norm(complex)</pre>
<pre id='line25' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line26")'> 26: </pre>
<pre id='line26' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line27")'> 27: cdef double norm(complex x):</pre>
<pre id='line27' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":27
 *     double norm(complex)
 * 
 * cdef double norm(complex x):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return sqrt(x.real*x.real + x.imag*x.imag)
 * 
 */

__PYX_EXTERN_C  double norm(__pyx_t_double_complex __pyx_v_x) {
  double __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("norm");
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line28")'> 28:     return sqrt(x.real*x.real + x.imag*x.imag)</pre>
<pre id='line28' class='code' style='background-color: #FFFFaa'>
  /* "optneuosc.pyx":28
 * 
 * cdef double norm(complex x):
 *     return sqrt(x.real*x.real + x.imag*x.imag)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef double chi2(double th, double exp):
 */
  __pyx_r = sqrt(((<span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_v_x) * <span class='pyx_macro_api'>__Pyx_CREAL</span>(__pyx_v_x)) + (<span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_v_x) * <span class='pyx_macro_api'>__Pyx_CIMAG</span>(__pyx_v_x))));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line29")'> 29: </pre>
<pre id='line29' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line30")'> 30: cdef double chi2(double th, double exp):</pre>
<pre id='line30' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":30
 *     return sqrt(x.real*x.real + x.imag*x.imag)
 * 
 * cdef double chi2(double th, double exp):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef double chi
 *     chi = (exp - th)*(exp - th)/exp
 */

static  double __pyx_f_9optneuosc_chi2(double __pyx_v_th, double __pyx_v_exp) {
  double __pyx_v_chi;
  double __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("chi2");
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line31")'> 31:     cdef double chi</pre>
<pre id='line31' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line32")'> 32:     chi = (exp - th)*(exp - th)/exp</pre>
<pre id='line32' class='code' style='background-color: #FFFFaa'>
  /* "optneuosc.pyx":32
 * cdef double chi2(double th, double exp):
 *     cdef double chi
 *     chi = (exp - th)*(exp - th)/exp             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return chi
 * 
 */
  __pyx_t_1 = ((__pyx_v_exp - __pyx_v_th) * (__pyx_v_exp - __pyx_v_th));
  if (unlikely(__pyx_v_exp == 0)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
   <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_chi = (__pyx_t_1 / __pyx_v_exp);
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line33")'> 33:     return chi</pre>
<pre id='line33' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":33
 *     cdef double chi
 *     chi = (exp - th)*(exp - th)/exp
 *     return chi             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef cvec(vv,param):
 */
  __pyx_r = __pyx_v_chi;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("optneuosc.chi2");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line34")'> 34: </pre>
<pre id='line34' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line35")'> 35: cpdef cvec(vv,param):</pre>
<pre id='line35' class='code' style='background-color: #FFFF2b'>
/* "optneuosc.pyx":35
 *     return chi
 * 
 * cpdef cvec(vv,param):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i
 *     neu = zeros([param.numneu,1],complex)
 */

static PyObject *__pyx_pf_9optneuosc_cvec(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_cvec(PyObject *__pyx_v_vv, PyObject *__pyx_v_param, int __pyx_skip_dispatch) {
  int __pyx_v_i;
  PyObject *__pyx_v_neu;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("cvec");
  __pyx_v_neu = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":35
 *     return chi
 * 
 * cpdef cvec(vv,param):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i
 *     neu = zeros([param.numneu,1],complex)
 */

static PyObject *__pyx_pf_9optneuosc_cvec(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_9optneuosc_cvec(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vv = 0;
  PyObject *__pyx_v_param = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__vv,&__pyx_n_s__param,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("cvec");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__vv);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__param);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cvec", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "cvec") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_vv = values[0];
    __pyx_v_param = values[1];
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_vv = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    __pyx_v_param = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cvec", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.cvec");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_vv;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_f_9optneuosc_cvec(__pyx_t_1, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.cvec");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line36")'> 36:     cdef int i</pre>
<pre id='line36' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line37")'> 37:     neu = zeros([param.numneu,1],complex)</pre>
<pre id='line37' class='code' style='background-color: #FFFF3e'>
  /* "optneuosc.pyx":37
 * cpdef cvec(vv,param):
 *     cdef int i
 *     neu = zeros([param.numneu,1],complex)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     for i in range(0,2*param.numneu,2):
 *         neu[i/2,0] = complex(vv[i],vv[i+1])
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)(&PyComplex_Type))));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)((PyObject*)(&PyComplex_Type))));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)(&PyComplex_Type))));
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neu);
  __pyx_v_neu = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line38")'> 38:     for i in range(0,2*param.numneu,2):</pre>
<pre id='line38' class='code' style='background-color: #FFFF4f'>
  /* "optneuosc.pyx":38
 *     cdef int i
 *     neu = zeros([param.numneu,1],complex)
 *     for i in range(0,2*param.numneu,2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         neu[i/2,0] = complex(vv[i],vv[i+1])
 *     return neu
 */
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_4 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=2) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFF36' onclick='toggleDiv("line39")'> 39:         neu[i/2,0] = complex(vv[i],vv[i+1])</pre>
<pre id='line39' class='code' style='background-color: #FFFF36'>
    /* "optneuosc.pyx":39
 *     neu = zeros([param.numneu,1],complex)
 *     for i in range(0,2*param.numneu,2):
 *         neu[i/2,0] = complex(vv[i],vv[i+1])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return neu
 * 
 */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_vv, __pyx_v_i, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_6 = (__pyx_v_i + 1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_vv, __pyx_t_6, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_2 = 0;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyComplex_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__Pyx_div_long(__pyx_v_i, 2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_0);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
    __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_neu, ((PyObject *)__pyx_t_2), __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line40")'> 40:     return neu</pre>
<pre id='line40' class='code' style='background-color: #FFFF7f'>
  /* "optneuosc.pyx":40
 *     for i in range(0,2*param.numneu,2):
 *         neu[i/2,0] = complex(vv[i],vv[i+1])
 *     return neu             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef rvec(vv,param):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_neu);
  __pyx_r = __pyx_v_neu;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.cvec");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neu);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line41")'> 41: </pre>
<pre id='line41' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line42")'> 42: cpdef rvec(vv,param):</pre>
<pre id='line42' class='code' style='background-color: #FFFF2b'>
/* "optneuosc.pyx":42
 *     return neu
 * 
 * cpdef rvec(vv,param):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i
 *     neu = np.zeros([2*param.numneu],float)
 */

static PyObject *__pyx_pf_9optneuosc_1rvec(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_rvec(PyObject *__pyx_v_vv, PyObject *__pyx_v_param, int __pyx_skip_dispatch) {
  int __pyx_v_i;
  PyObject *__pyx_v_neu;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("rvec");
  __pyx_v_neu = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":42
 *     return neu
 * 
 * cpdef rvec(vv,param):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i
 *     neu = np.zeros([2*param.numneu],float)
 */

static PyObject *__pyx_pf_9optneuosc_1rvec(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_9optneuosc_1rvec(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vv = 0;
  PyObject *__pyx_v_param = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__vv,&__pyx_n_s__param,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("rvec");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__vv);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__param);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rvec", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "rvec") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_vv = values[0];
    __pyx_v_param = values[1];
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_vv = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    __pyx_v_param = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rvec", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.rvec");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_vv;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_f_9optneuosc_rvec(__pyx_t_1, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.rvec");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line43")'> 43:     cdef int i</pre>
<pre id='line43' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line44")'> 44:     neu = np.zeros([2*param.numneu],float)</pre>
<pre id='line44' class='code' style='background-color: #FFFF32'>
  /* "optneuosc.pyx":44
 * cpdef rvec(vv,param):
 *     cdef int i
 *     neu = np.zeros([2*param.numneu],float)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     for i in np.arange(0,2*param.numneu,2):
 *         neu[i] = vv[i/2,0].real
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)(&PyFloat_Type))));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)((PyObject*)(&PyFloat_Type))));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)(&PyFloat_Type))));
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neu);
  __pyx_v_neu = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line45")'> 45:     for i in np.arange(0,2*param.numneu,2):</pre>
<pre id='line45' class='code' style='background-color: #FFFF19'>
  /* "optneuosc.pyx":45
 *     cdef int i
 *     neu = np.zeros([2*param.numneu],float)
 *     for i in np.arange(0,2*param.numneu,2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         neu[i] = vv[i/2,0].real
 *         neu[i+1] = vv[i/2,0].imag
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_4 = 0; __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++;
    } else if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) {
      if (__pyx_t_4 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++;
    } else {
      __pyx_t_2 = <span class='py_c_api'>PyIter_Next</span>(__pyx_t_1);
      if (!__pyx_t_2) {
        if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>()))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    }
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_i = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line46")'> 46:         neu[i] = vv[i/2,0].real</pre>
<pre id='line46' class='code' style='background-color: #FFFF43'>
    /* "optneuosc.pyx":46
 *     neu = np.zeros([2*param.numneu],float)
 *     for i in np.arange(0,2*param.numneu,2):
 *         neu[i] = vv[i/2,0].real             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         neu[i+1] = vv[i/2,0].imag
 *     return neu
 */
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__Pyx_div_long(__pyx_v_i, 2));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_0);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vv, ((PyObject *)__pyx_t_3));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__real);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_neu, __pyx_v_i, __pyx_t_3, sizeof(int), PyInt_FromLong) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 46; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line47")'> 47:         neu[i+1] = vv[i/2,0].imag</pre>
<pre id='line47' class='code' style='background-color: #FFFF41'>
    /* "optneuosc.pyx":47
 *     for i in np.arange(0,2*param.numneu,2):
 *         neu[i] = vv[i/2,0].real
 *         neu[i+1] = vv[i/2,0].imag             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return neu
 * 
 */
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__Pyx_div_long(__pyx_v_i, 2));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_0);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vv, ((PyObject *)__pyx_t_2));<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__imag);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = (__pyx_v_i + 1);
    if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_neu, __pyx_t_6, __pyx_t_2, sizeof(long), PyInt_FromLong) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line48")'> 48:     return neu</pre>
<pre id='line48' class='code' style='background-color: #FFFF7f'>
  /* "optneuosc.pyx":48
 *         neu[i] = vv[i/2,0].real
 *         neu[i+1] = vv[i/2,0].imag
 *     return neu             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef OscProb(cvec,param):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_neu);
  __pyx_r = __pyx_v_neu;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.rvec");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neu);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line49")'> 49: </pre>
<pre id='line49' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2b' onclick='toggleDiv("line50")'> 50: cpdef OscProb(cvec,param):</pre>
<pre id='line50' class='code' style='background-color: #FFFF2b'>
/* "optneuosc.pyx":50
 *     return neu
 * 
 * cpdef OscProb(cvec,param):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """ Calculates probability from a complex state vector.
 * 
 */

static PyObject *__pyx_pf_9optneuosc_2OscProb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_OscProb(PyObject *__pyx_v_cvec, PyObject *__pyx_v_param, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_p;
  PyObject *__pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("OscProb");
  __pyx_v_p = ((PyObject*)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_i = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":50
 *     return neu
 * 
 * cpdef OscProb(cvec,param):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """ Calculates probability from a complex state vector.
 * 
 */

static PyObject *__pyx_pf_9optneuosc_2OscProb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9optneuosc_2OscProb[] = " Calculates probability from a complex state vector.\n    \n    Note : param.numneu sets the vector size.    \n    \n    @type   cvec    :   List\n    @param  cvec    :   complex vector.\n    @type   param   :   PhysicsConstants\n    @param  param   :   set of physical parameters to be used.\n\n    @rtype          :   List\n    @return         :   real probability vector.\n    ";
static PyObject *__pyx_pf_9optneuosc_2OscProb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_cvec = 0;
  PyObject *__pyx_v_param = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__cvec,&__pyx_n_s__param,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("OscProb");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[2] = {0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__cvec);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__param);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("OscProb", 1, 2, 2, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "OscProb") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_cvec = values[0];
    __pyx_v_param = values[1];
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_cvec = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    __pyx_v_param = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("OscProb", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.OscProb");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_cvec;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_f_9optneuosc_OscProb(__pyx_t_1, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.OscProb");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line51")'> 51:     """ Calculates probability from a complex state vector.</pre>
<pre id='line51' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line52")'> 52: </pre>
<pre id='line52' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line53")'> 53:     Note : param.numneu sets the vector size.</pre>
<pre id='line53' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line54")'> 54: </pre>
<pre id='line54' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line55")'> 55:     @type   cvec    :   List</pre>
<pre id='line55' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line56")'> 56:     @param  cvec    :   complex vector.</pre>
<pre id='line56' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line57")'> 57:     @type   param   :   PhysicsConstants</pre>
<pre id='line57' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line58")'> 58:     @param  param   :   set of physical parameters to be used.</pre>
<pre id='line58' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line59")'> 59: </pre>
<pre id='line59' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line60")'> 60:     @rtype          :   List</pre>
<pre id='line60' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line61")'> 61:     @return         :   real probability vector.</pre>
<pre id='line61' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line62")'> 62:     """</pre>
<pre id='line62' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF14' onclick='toggleDiv("line63")'> 63:     p = [ cvec[i].real**2+cvec[i].imag**2 for i in range(param.numneu)]</pre>
<pre id='line63' class='code' style='background-color: #FFFF14'>
  /* "optneuosc.pyx":63
 *     @return         :   real probability vector.
 *     """
 *     p = [ cvec[i].real**2+cvec[i].imag**2 for i in range(param.numneu)]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return p
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_2 = 0; __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;
    } else if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++;
    } else {
      __pyx_t_3 = <span class='py_c_api'>PyIter_Next</span>(__pyx_t_4);
      if (!__pyx_t_3) {
        if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>()))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_cvec, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__real);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_5, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_cvec, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_5, __pyx_n_s__imag);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_6, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(<span class='py_c_api'>PyList_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_6)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 63; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_p));
  __pyx_v_p = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line64")'> 64:     return p</pre>
<pre id='line64' class='code' style='background-color: #FFFF6e'>
  /* "optneuosc.pyx":64
 *     """
 *     p = [ cvec[i].real**2+cvec[i].imag**2 for i in range(param.numneu)]
 *     return p             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef flavorAcc(param,E,body,track):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_p));
  __pyx_r = ((PyObject *)__pyx_v_p);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.OscProb");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_p);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line65")'> 65: </pre>
<pre id='line65' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1e' onclick='toggleDiv("line66")'> 66: cpdef flavorAcc(param,E,body,track):</pre>
<pre id='line66' class='code' style='background-color: #FFFF1e'>
/* "optneuosc.pyx":66
 *     return p
 * 
 * cpdef flavorAcc(param,E,body,track):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # Charge-current potential
 *     # E : neutrino energy
 */

static PyObject *__pyx_pf_9optneuosc_3flavorAcc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_flavorAcc(PyObject *__pyx_v_param, PyObject *__pyx_v_E, PyObject *__pyx_v_body, PyObject *__pyx_v_track, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_Acc;
  PyObject *__pyx_v_ye;
  PyObject *__pyx_v_CC;
  PyObject *__pyx_v_NC;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("flavorAcc");
  __pyx_v_Acc = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_ye = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_CC = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_NC = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":66
 *     return p
 * 
 * cpdef flavorAcc(param,E,body,track):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # Charge-current potential
 *     # E : neutrino energy
 */

static PyObject *__pyx_pf_9optneuosc_3flavorAcc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_9optneuosc_3flavorAcc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_param = 0;
  PyObject *__pyx_v_E = 0;
  PyObject *__pyx_v_body = 0;
  PyObject *__pyx_v_track = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__param,&__pyx_n_s__E,&__pyx_n_s__body,&__pyx_n_s__track,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("flavorAcc");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[4] = {0,0,0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__param);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flavorAcc", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  2:
      values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__body);
      if (likely(values[2])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flavorAcc", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  3:
      values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__track);
      if (likely(values[3])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flavorAcc", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "flavorAcc") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_param = values[0];
    __pyx_v_E = values[1];
    __pyx_v_body = values[2];
    __pyx_v_track = values[3];
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_param = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    __pyx_v_E = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    __pyx_v_body = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    __pyx_v_track = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flavorAcc", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.flavorAcc");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_E;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_v_body;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_v_track;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  __pyx_t_5 = __pyx_f_9optneuosc_flavorAcc(__pyx_t_1, __pyx_t_2, __pyx_t_3, __pyx_t_4, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.flavorAcc");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line67")'> 67:     # Charge-current potential</pre>
<pre id='line67' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line68")'> 68:     # E : neutrino energy</pre>
<pre id='line68' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line69")'> 69:     # body : body where the neutrino propagetes</pre>
<pre id='line69' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line70")'> 70:     # track : trayectory</pre>
<pre id='line70' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line71")'> 71:     Acc = zeros([param.numneu,param.numneu],complex)</pre>
<pre id='line71' class='code' style='background-color: #FFFF38'>
  /* "optneuosc.pyx":71
 *     # body : body where the neutrino propagetes
 *     # track : trayectory
 *     Acc = zeros([param.numneu,param.numneu],complex)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     ye = body.ye(track)
 *     CC = param.sqr2*param.GF*param.Na*param.cm**-3*body.density(track)*ye
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_4));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_4));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)(&PyComplex_Type))));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)((PyObject*)(&PyComplex_Type))));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)(&PyComplex_Type))));
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_Acc);
  __pyx_v_Acc = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line72")'> 72:     ye = body.ye(track)</pre>
<pre id='line72' class='code' style='background-color: #FFFF55'>
  /* "optneuosc.pyx":72
 *     # track : trayectory
 *     Acc = zeros([param.numneu,param.numneu],complex)
 *     ye = body.ye(track)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     CC = param.sqr2*param.GF*param.Na*param.cm**-3*body.density(track)*ye
 *     #NC = CC*body.RNC(track)
 */
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_body, __pyx_n_s__ye);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_track);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_track);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_track);
  __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_ye);
  __pyx_v_ye = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line73")'> 73:     CC = param.sqr2*param.GF*param.Na*param.cm**-3*body.density(track)*ye</pre>
<pre id='line73' class='code' style='background-color: #FFFF1c'>
  /* "optneuosc.pyx":73
 *     Acc = zeros([param.numneu,param.numneu],complex)
 *     ye = body.ye(track)
 *     CC = param.sqr2*param.GF*param.Na*param.cm**-3*body.density(track)*ye             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     #NC = CC*body.RNC(track)
 *     NC = CC*(-0.5*(1.0-ye)/ye)
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__sqr2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__GF);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__Na);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__cm);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_3, __pyx_int_neg_3, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_body, __pyx_n_s__density);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_track);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_track);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_track);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_ye);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_CC);
  __pyx_v_CC = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line74")'> 74:     #NC = CC*body.RNC(track)</pre>
<pre id='line74' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line75")'> 75:     NC = CC*(-0.5*(1.0-ye)/ye)</pre>
<pre id='line75' class='code' style='background-color: #FFFF37'>
  /* "optneuosc.pyx":75
 *     CC = param.sqr2*param.GF*param.Na*param.cm**-3*body.density(track)*ye
 *     #NC = CC*body.RNC(track)
 *     NC = CC*(-0.5*(1.0-ye)/ye)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     Acc[0,0] = complex(CC+NC,0.0)
 *     Acc[1,1] = complex(NC,0.0)
 */
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(-0.5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_v_ye);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_1, __pyx_v_ye);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_CC, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_NC);
  __pyx_v_NC = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line76")'> 76:     Acc[0,0] = complex(CC+NC,0.0)</pre>
<pre id='line76' class='code' style='background-color: #FFFF35'>
  /* "optneuosc.pyx":76
 *     #NC = CC*body.RNC(track)
 *     NC = CC*(-0.5*(1.0-ye)/ye)
 *     Acc[0,0] = complex(CC+NC,0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     Acc[1,1] = complex(NC,0.0)
 *     Acc[2,2] = complex(NC,0.0)
 */
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_CC, __pyx_v_NC);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyComplex_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_Acc, ((PyObject *)__pyx_k_tuple_1), __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  /* "optneuosc.pyx":76
 *     #NC = CC*body.RNC(track)
 *     NC = CC*(-0.5*(1.0-ye)/ye)
 *     Acc[0,0] = complex(CC+NC,0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     Acc[1,1] = complex(NC,0.0)
 *     Acc[2,2] = complex(NC,0.0)
 */
  __pyx_k_tuple_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_k_tuple_1));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_1, 1, __pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_1));
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line77")'> 77:     Acc[1,1] = complex(NC,0.0)</pre>
<pre id='line77' class='code' style='background-color: #FFFF39'>
  /* "optneuosc.pyx":77
 *     NC = CC*(-0.5*(1.0-ye)/ye)
 *     Acc[0,0] = complex(CC+NC,0.0)
 *     Acc[1,1] = complex(NC,0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     Acc[2,2] = complex(NC,0.0)
 *     if param.neutype == "neutrino":
 */
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_NC);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_NC);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_NC);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyComplex_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_Acc, ((PyObject *)__pyx_k_tuple_2), __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  /* "optneuosc.pyx":77
 *     NC = CC*(-0.5*(1.0-ye)/ye)
 *     Acc[0,0] = complex(CC+NC,0.0)
 *     Acc[1,1] = complex(NC,0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     Acc[2,2] = complex(NC,0.0)
 *     if param.neutype == "neutrino":
 */
  __pyx_k_tuple_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_k_tuple_2));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_2, 0, __pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_2, 1, __pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_2));
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line78")'> 78:     Acc[2,2] = complex(NC,0.0)</pre>
<pre id='line78' class='code' style='background-color: #FFFF39'>
  /* "optneuosc.pyx":78
 *     Acc[0,0] = complex(CC+NC,0.0)
 *     Acc[1,1] = complex(NC,0.0)
 *     Acc[2,2] = complex(NC,0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if param.neutype == "neutrino":
 *         return Acc
 */
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_NC);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_NC);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_NC);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyComplex_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_Acc, ((PyObject *)__pyx_k_tuple_3), __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;

  /* "optneuosc.pyx":78
 *     Acc[0,0] = complex(CC+NC,0.0)
 *     Acc[1,1] = complex(NC,0.0)
 *     Acc[2,2] = complex(NC,0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     if param.neutype == "neutrino":
 *         return Acc
 */
  __pyx_k_tuple_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_k_tuple_3));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_3, 0, __pyx_int_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_3, 1, __pyx_int_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_3));
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line79")'> 79:     if param.neutype == "neutrino":</pre>
<pre id='line79' class='code' style='background-color: #FFFF5e'>
  /* "optneuosc.pyx":79
 *     Acc[1,1] = complex(NC,0.0)
 *     Acc[2,2] = complex(NC,0.0)
 *     if param.neutype == "neutrino":             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return Acc
 *     elif param.neutype == "antineutrino":
 */
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__neutype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__neutrino), Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line80")'> 80:         return Acc</pre>
<pre id='line80' class='code' style='background-color: #FFFFd4'>
    /* "optneuosc.pyx":80
 *     Acc[2,2] = complex(NC,0.0)
 *     if param.neutype == "neutrino":
 *         return Acc             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     elif param.neutype == "antineutrino":
 *         return -Acc
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Acc);
    __pyx_r = __pyx_v_Acc;
    goto __pyx_L0;
    goto __pyx_L3;
  }
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line81")'> 81:     elif param.neutype == "antineutrino":</pre>
<pre id='line81' class='code' style='background-color: #FFFF5e'>
  /* "optneuosc.pyx":81
 *     if param.neutype == "neutrino":
 *         return Acc
 *     elif param.neutype == "antineutrino":             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         return -Acc
 *     else :
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__neutype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__antineutrino), Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line82")'> 82:         return -Acc</pre>
<pre id='line82' class='code' style='background-color: #FFFF9f'>
    /* "optneuosc.pyx":82
 *         return Acc
 *     elif param.neutype == "antineutrino":
 *         return -Acc             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     else :
 *         print "Wrong neutrino type."
 */
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_v_Acc);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line83")'> 83:     else :</pre>
<pre id='line83' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line84")'> 84:         print "Wrong neutrino type."</pre>
<pre id='line84' class='code' style='background-color: #FFFFd4'>
    /* "optneuosc.pyx":84
 *         return -Acc
 *     else :
 *         print "Wrong neutrino type."             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         quit()
 * 
 */
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, ((PyObject *)__pyx_kp_s_4)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line85")'> 85:         quit()</pre>
<pre id='line85' class='code' style='background-color: #FFFF5b'>
    /* "optneuosc.pyx":85
 *     else :
 *         print "Wrong neutrino type."
 *         quit()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef flavorH(track,param,flavorM2,body,E):
 */
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_quit, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_L3:;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.flavorAcc");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_Acc);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_ye);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_CC);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_NC);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line86")'> 86: </pre>
<pre id='line86' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1b' onclick='toggleDiv("line87")'> 87: cpdef flavorH(track,param,flavorM2,body,E):</pre>
<pre id='line87' class='code' style='background-color: #FFFF1b'>
/* "optneuosc.pyx":87
 *         quit()
 * 
 * cpdef flavorH(track,param,flavorM2,body,E):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # Flavor Hamiltonian WARNING FACTOR II in front
 *     # rhs of the Mikheev-Smirnov-Wolfenstein (MSW) eq.
 */

static PyObject *__pyx_pf_9optneuosc_4flavorH(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_flavorH(PyObject *__pyx_v_track, PyObject *__pyx_v_param, PyObject *__pyx_v_flavorM2, PyObject *__pyx_v_body, PyObject *__pyx_v_E, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_ii;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("flavorH");
  __pyx_v_ii = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":87
 *         quit()
 * 
 * cpdef flavorH(track,param,flavorM2,body,E):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # Flavor Hamiltonian WARNING FACTOR II in front
 *     # rhs of the Mikheev-Smirnov-Wolfenstein (MSW) eq.
 */

static PyObject *__pyx_pf_9optneuosc_4flavorH(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_9optneuosc_4flavorH(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_track = 0;
  PyObject *__pyx_v_param = 0;
  PyObject *__pyx_v_flavorM2 = 0;
  PyObject *__pyx_v_body = 0;
  PyObject *__pyx_v_E = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__track,&__pyx_n_s__param,&__pyx_n_s__flavorM2,&__pyx_n_s__body,&__pyx_n_s__E,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("flavorH");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[5] = {0,0,0,0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__track);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__param);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flavorH", 1, 5, 5, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  2:
      values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__flavorM2);
      if (likely(values[2])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flavorH", 1, 5, 5, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  3:
      values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__body);
      if (likely(values[3])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flavorH", 1, 5, 5, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  4:
      values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E);
      if (likely(values[4])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flavorH", 1, 5, 5, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "flavorH") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_track = values[0];
    __pyx_v_param = values[1];
    __pyx_v_flavorM2 = values[2];
    __pyx_v_body = values[3];
    __pyx_v_E = values[4];
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_track = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    __pyx_v_param = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    __pyx_v_flavorM2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    __pyx_v_body = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    __pyx_v_E = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flavorH", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.flavorH");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_track;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_v_flavorM2;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_v_body;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  __pyx_t_5 = __pyx_v_E;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
  __pyx_t_6 = __pyx_f_9optneuosc_flavorH(__pyx_t_1, __pyx_t_2, __pyx_t_3, __pyx_t_4, __pyx_t_5, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.flavorH");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line88")'> 88:     # Flavor Hamiltonian WARNING FACTOR II in front</pre>
<pre id='line88' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line89")'> 89:     # rhs of the Mikheev-Smirnov-Wolfenstein (MSW) eq.</pre>
<pre id='line89' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line90")'> 90:     ii = complex(0.0,-1.0)</pre>
<pre id='line90' class='code' style='background-color: #FFFF4b'>
  /* "optneuosc.pyx":90
 *     # Flavor Hamiltonian WARNING FACTOR II in front
 *     # rhs of the Mikheev-Smirnov-Wolfenstein (MSW) eq.
 *     ii = complex(0.0,-1.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     #return (ii/(2.0*E))*(flavorM2+flavorAcc(param,E,body,track))
 *     return (ii)*(flavorM2/(2.0*E)+flavorAcc(param,E,body,track))
 */
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(-1.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyComplex_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_ii);
  __pyx_v_ii = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line91")'> 91:     #return (ii/(2.0*E))*(flavorM2+flavorAcc(param,E,body,track))</pre>
<pre id='line91' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line92")'> 92:     return (ii)*(flavorM2/(2.0*E)+flavorAcc(param,E,body,track))</pre>
<pre id='line92' class='code' style='background-color: #FFFF2a'>
  /* "optneuosc.pyx":92
 *     ii = complex(0.0,-1.0)
 *     #return (ii/(2.0*E))*(flavorM2+flavorAcc(param,E,body,track))
 *     return (ii)*(flavorM2/(2.0*E)+flavorAcc(param,E,body,track))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef RHS(neuvec,double x,track,param,flavorM2,body,double E):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(2.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_flavorM2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_1 = __pyx_v_E;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_4 = __pyx_v_body;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  __pyx_t_5 = __pyx_v_track;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
  __pyx_t_6 = __pyx_f_9optneuosc_flavorAcc(__pyx_t_3, __pyx_t_1, __pyx_t_4, __pyx_t_5, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_ii, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.flavorH");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_ii);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line93")'> 93: </pre>
<pre id='line93' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF10' onclick='toggleDiv("line94")'> 94: cpdef RHS(neuvec,double x,track,param,flavorM2,body,double E):</pre>
<pre id='line94' class='code' style='background-color: #FFFF10'>
/* "optneuosc.pyx":94
 *     return (ii)*(flavorM2/(2.0*E)+flavorAcc(param,E,body,track))
 * 
 * cpdef RHS(neuvec,double x,track,param,flavorM2,body,double E):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # Right hand side in Schrodinger's equations
 *     track.x = x
 */

static PyObject *__pyx_pf_9optneuosc_5RHS(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_RHS(PyObject *__pyx_v_neuvec, double __pyx_v_x, PyObject *__pyx_v_track, PyObject *__pyx_v_param, PyObject *__pyx_v_flavorM2, PyObject *__pyx_v_body, double __pyx_v_E, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_rhs;
  PyObject *__pyx_v_tmprhs;
  PyObject *__pyx_v_val;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("RHS");
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_neuvec);
  __pyx_v_rhs = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_tmprhs = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_val = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":94
 *     return (ii)*(flavorM2/(2.0*E)+flavorAcc(param,E,body,track))
 * 
 * cpdef RHS(neuvec,double x,track,param,flavorM2,body,double E):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # Right hand side in Schrodinger's equations
 *     track.x = x
 */

static PyObject *__pyx_pf_9optneuosc_5RHS(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_9optneuosc_5RHS(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_neuvec = 0;
  double __pyx_v_x;
  PyObject *__pyx_v_track = 0;
  PyObject *__pyx_v_param = 0;
  PyObject *__pyx_v_flavorM2 = 0;
  PyObject *__pyx_v_body = 0;
  double __pyx_v_E;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__neuvec,&__pyx_n_s__x,&__pyx_n_s__track,&__pyx_n_s__param,&__pyx_n_s__flavorM2,&__pyx_n_s__body,&__pyx_n_s__E,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("RHS");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[7] = {0,0,0,0,0,0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__neuvec);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__x);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS", 1, 7, 7, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  2:
      values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__track);
      if (likely(values[2])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS", 1, 7, 7, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  3:
      values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__param);
      if (likely(values[3])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS", 1, 7, 7, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  4:
      values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__flavorM2);
      if (likely(values[4])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS", 1, 7, 7, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  5:
      values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__body);
      if (likely(values[5])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS", 1, 7, 7, 5);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  6:
      values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E);
      if (likely(values[6])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS", 1, 7, 7, 6);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "RHS") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_neuvec = values[0];
    __pyx_v_x = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_x == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_track = values[2];
    __pyx_v_param = values[3];
    __pyx_v_flavorM2 = values[4];
    __pyx_v_body = values[5];
    __pyx_v_E = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_E == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_neuvec = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    __pyx_v_x = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1));<span class='error_goto'> if (unlikely((__pyx_v_x == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_track = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    __pyx_v_param = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    __pyx_v_flavorM2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    __pyx_v_body = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    __pyx_v_E = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6));<span class='error_goto'> if (unlikely((__pyx_v_E == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.RHS");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_neuvec;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_x;
  __pyx_t_3 = __pyx_v_track;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  __pyx_t_5 = __pyx_v_flavorM2;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
  __pyx_t_6 = __pyx_v_body;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
  __pyx_t_7 = __pyx_f_9optneuosc_RHS(__pyx_t_1, __pyx_t_2, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_v_E, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.RHS");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line95")'> 95:     # Right hand side in Schrodinger's equations</pre>
<pre id='line95' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line96")'> 96:     track.x = x</pre>
<pre id='line96' class='code' style='background-color: #FFFF79'>
  /* "optneuosc.pyx":96
 * cpdef RHS(neuvec,double x,track,param,flavorM2,body,double E):
 *     # Right hand side in Schrodinger's equations
 *     track.x = x             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     ## this should be done in complex plane -- TMP
 *     neuvec = cvec(neuvec,param)
 */
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_v_track, __pyx_n_s__x, __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line97")'> 97:     ## this should be done in complex plane -- TMP</pre>
<pre id='line97' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line98")'> 98:     neuvec = cvec(neuvec,param)</pre>
<pre id='line98' class='code' style='background-color: #FFFFaa'>
  /* "optneuosc.pyx":98
 *     track.x = x
 *     ## this should be done in complex plane -- TMP
 *     neuvec = cvec(neuvec,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     rhs = dot(flavorH(track,param,flavorM2,body,E),neuvec)
 *     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()
 */
  __pyx_t_1 = __pyx_v_neuvec;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_f_9optneuosc_cvec(__pyx_t_1, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neuvec);
  __pyx_v_neuvec = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line99")'> 99:     rhs = dot(flavorH(track,param,flavorM2,body,E),neuvec)</pre>
<pre id='line99' class='code' style='background-color: #FFFF3c'>
  /* "optneuosc.pyx":99
 *     ## this should be done in complex plane -- TMP
 *     neuvec = cvec(neuvec,param)
 *     rhs = dot(flavorH(track,param,flavorM2,body,E),neuvec)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()
 *     return tmprhs
 */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__dot);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = __pyx_v_track;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_1 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_4 = __pyx_v_flavorM2;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  __pyx_t_5 = __pyx_v_body;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_7 = __pyx_f_9optneuosc_flavorH(__pyx_t_2, __pyx_t_1, __pyx_t_4, __pyx_t_5, __pyx_t_6, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_6));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_neuvec);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_neuvec);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_neuvec);
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_rhs);
  __pyx_v_rhs = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFF15' onclick='toggleDiv("line100")'> 100:     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()</pre>
<pre id='line100' class='code' style='background-color: #FFFF15'>
  /* "optneuosc.pyx":100
 *     neuvec = cvec(neuvec,param)
 *     rhs = dot(flavorH(track,param,flavorM2,body,E),neuvec)
 *     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return tmprhs
 * 
 */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_6));
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_rhs) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_rhs)) {
    __pyx_t_8 = 0; __pyx_t_3 = __pyx_v_rhs; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  } else {
    __pyx_t_8 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_rhs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  }
  for (;;) {
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
      if (__pyx_t_8 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_8++;
    } else if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) {
      if (__pyx_t_8 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_8++;
    } else {
      __pyx_t_5 = <span class='py_c_api'>PyIter_Next</span>(__pyx_t_3);
      if (!__pyx_t_5) {
        if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>()))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_val);
    __pyx_v_val = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_val, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_5, __pyx_n_s__real);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_val, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_5, __pyx_n_s__imag);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_5));
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_4 = 0;
    __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyList_Append</span>(__pyx_t_6, (PyObject*)__pyx_t_5)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_t_6));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_6));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_6));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_7, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_6, __pyx_n_s__flatten);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_tmprhs);
  __pyx_v_tmprhs = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line101")'> 101:     return tmprhs</pre>
<pre id='line101' class='code' style='background-color: #FFFF5e'>
  /* "optneuosc.pyx":101
 *     rhs = dot(flavorH(track,param,flavorM2,body,E),neuvec)
 *     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()
 *     return tmprhs             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef RHS_GSL(double x,neuvec,params):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tmprhs);
  __pyx_r = __pyx_v_tmprhs;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.RHS");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_rhs);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_tmprhs);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_val);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neuvec);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line102")'> 102: </pre>
<pre id='line102' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line103")'> 103: cpdef RHS_GSL(double x,neuvec,params):</pre>
<pre id='line103' class='code' style='background-color: #FFFF1a'>
/* "optneuosc.pyx":103
 *     return tmprhs
 * 
 * cpdef RHS_GSL(double x,neuvec,params):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     track,param,flavorM2,body,E = params.track, params.param,params.flavorM2,params.body,params.E
 *     # Right hand side in Schrodinger's equations
 */

static PyObject *__pyx_pf_9optneuosc_6RHS_GSL(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_RHS_GSL(double __pyx_v_x, PyObject *__pyx_v_neuvec, PyObject *__pyx_v_params, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_track;
  PyObject *__pyx_v_param;
  PyObject *__pyx_v_flavorM2;
  PyObject *__pyx_v_body;
  PyObject *__pyx_v_E;
  PyObject *__pyx_v_rhs;
  PyObject *__pyx_v_tmprhs;
  PyObject *__pyx_v_val;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("RHS_GSL");
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_neuvec);
  __pyx_v_track = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_param = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_flavorM2 = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_body = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_E = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_rhs = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_tmprhs = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_val = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":103
 *     return tmprhs
 * 
 * cpdef RHS_GSL(double x,neuvec,params):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     track,param,flavorM2,body,E = params.track, params.param,params.flavorM2,params.body,params.E
 *     # Right hand side in Schrodinger's equations
 */

static PyObject *__pyx_pf_9optneuosc_6RHS_GSL(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_9optneuosc_6RHS_GSL(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_x;
  PyObject *__pyx_v_neuvec = 0;
  PyObject *__pyx_v_params = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__neuvec,&__pyx_n_s__params,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("RHS_GSL");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[3] = {0,0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__x);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__neuvec);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS_GSL", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  2:
      values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__params);
      if (likely(values[2])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS_GSL", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "RHS_GSL") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_x = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_x == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_neuvec = values[1];
    __pyx_v_params = values[2];
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_x = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0));<span class='error_goto'> if (unlikely((__pyx_v_x == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_neuvec = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    __pyx_v_params = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS_GSL", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.RHS_GSL");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_x;
  __pyx_t_2 = __pyx_v_neuvec;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_v_params;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_f_9optneuosc_RHS_GSL(__pyx_t_1, __pyx_t_2, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.RHS_GSL");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line104")'> 104:     track,param,flavorM2,body,E = params.track, params.param,params.flavorM2,params.body,params.E</pre>
<pre id='line104' class='code' style='background-color: #FFFF3f'>
  /* "optneuosc.pyx":104
 * 
 * cpdef RHS_GSL(double x,neuvec,params):
 *     track,param,flavorM2,body,E = params.track, params.param,params.flavorM2,params.body,params.E             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # Right hand side in Schrodinger's equations
 *     track.x = x
 */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__track);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__param);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__flavorM2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__body);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__E);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_track);
  __pyx_v_track = __pyx_t_1;
  __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_param);
  __pyx_v_param = __pyx_t_2;
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_flavorM2);
  __pyx_v_flavorM2 = __pyx_t_3;
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_body);
  __pyx_v_body = __pyx_t_4;
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_E);
  __pyx_v_E = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line105")'> 105:     # Right hand side in Schrodinger's equations</pre>
<pre id='line105' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line106")'> 106:     track.x = x</pre>
<pre id='line106' class='code' style='background-color: #FFFF79'>
  /* "optneuosc.pyx":106
 *     track,param,flavorM2,body,E = params.track, params.param,params.flavorM2,params.body,params.E
 *     # Right hand side in Schrodinger's equations
 *     track.x = x             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     ## this should be done in complex plane -- TMP
 *     neuvec = cvec(neuvec,param)
 */
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_v_track, __pyx_n_s__x, __pyx_t_5) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line107")'> 107:     ## this should be done in complex plane -- TMP</pre>
<pre id='line107' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line108")'> 108:     neuvec = cvec(neuvec,param)</pre>
<pre id='line108' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":108
 *     track.x = x
 *     ## this should be done in complex plane -- TMP
 *     neuvec = cvec(neuvec,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     rhs = dot(flavorH(track,param,flavorM2,body,E),neuvec)
 *     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()
 */
  __pyx_t_5 = __pyx_v_neuvec;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
  __pyx_t_4 = __pyx_f_9optneuosc_cvec(__pyx_t_5, __pyx_v_param, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neuvec);
  __pyx_v_neuvec = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line109")'> 109:     rhs = dot(flavorH(track,param,flavorM2,body,E),neuvec)</pre>
<pre id='line109' class='code' style='background-color: #FFFF5b'>
  /* "optneuosc.pyx":109
 *     ## this should be done in complex plane -- TMP
 *     neuvec = cvec(neuvec,param)
 *     rhs = dot(flavorH(track,param,flavorM2,body,E),neuvec)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()
 *     return tmprhs
 */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__dot);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = __pyx_f_9optneuosc_flavorH(__pyx_v_track, __pyx_v_param, __pyx_v_flavorM2, __pyx_v_body, __pyx_v_E, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_neuvec);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_neuvec);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_neuvec);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_rhs);
  __pyx_v_rhs = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF15' onclick='toggleDiv("line110")'> 110:     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()</pre>
<pre id='line110' class='code' style='background-color: #FFFF15'>
  /* "optneuosc.pyx":110
 *     neuvec = cvec(neuvec,param)
 *     rhs = dot(flavorH(track,param,flavorM2,body,E),neuvec)
 *     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return tmprhs
 * 
 */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_rhs) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_rhs)) {
    __pyx_t_6 = 0; __pyx_t_4 = __pyx_v_rhs; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  } else {
    __pyx_t_6 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_rhs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  }
  for (;;) {
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
      if (__pyx_t_6 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++;
    } else if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) {
      if (__pyx_t_6 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++;
    } else {
      __pyx_t_2 = <span class='py_c_api'>PyIter_Next</span>(__pyx_t_4);
      if (!__pyx_t_2) {
        if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>()))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_val);
    __pyx_v_val = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_val, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__real);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_val, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__imag);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_7);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
    __pyx_t_1 = 0;
    __pyx_t_7 = 0;
    if (unlikely(<span class='py_c_api'>PyList_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_2)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__flatten);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_tmprhs);
  __pyx_v_tmprhs = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line111")'> 111:     return tmprhs</pre>
<pre id='line111' class='code' style='background-color: #FFFF52'>
  /* "optneuosc.pyx":111
 *     rhs = dot(flavorH(track,param,flavorM2,body,E),neuvec)
 *     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()
 *     return tmprhs             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef R(int i, int j,int cp,param):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tmprhs);
  __pyx_r = __pyx_v_tmprhs;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.RHS_GSL");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_track);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_param);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_flavorM2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_body);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_E);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_rhs);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_tmprhs);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_val);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neuvec);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line112")'> 112: </pre>
<pre id='line112' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF13' onclick='toggleDiv("line113")'> 113: cpdef R(int i, int j,int cp,param):</pre>
<pre id='line113' class='code' style='background-color: #FFFF13'>
/* "optneuosc.pyx":113
 *     return tmprhs
 * 
 * cpdef R(int i, int j,int cp,param):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int k
 *     cdef double sd,cd
 */

static PyObject *__pyx_pf_9optneuosc_7R(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_R(int __pyx_v_i, int __pyx_v_j, int __pyx_v_cp, PyObject *__pyx_v_param, int __pyx_skip_dispatch) {
  int __pyx_v_k;
  double __pyx_v_sd;
  double __pyx_v_cd;
  __pyx_t_double_complex __pyx_v_faseCP;
  PyObject *__pyx_v_R;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("R");
  __pyx_v_R = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":113
 *     return tmprhs
 * 
 * cpdef R(int i, int j,int cp,param):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int k
 *     cdef double sd,cd
 */

static PyObject *__pyx_pf_9optneuosc_7R(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_9optneuosc_7R(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_cp;
  PyObject *__pyx_v_param = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__i,&__pyx_n_s__j,&__pyx_n_s__cp,&__pyx_n_s__param,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("R");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[4] = {0,0,0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__i);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__j);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("R", 1, 4, 4, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  2:
      values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__cp);
      if (likely(values[2])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("R", 1, 4, 4, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  3:
      values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__param);
      if (likely(values[3])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("R", 1, 4, 4, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "R") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_i = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_i == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_j = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_j == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_cp = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_cp == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_param = values[3];
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_i = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0));<span class='error_goto'> if (unlikely((__pyx_v_i == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_j = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1));<span class='error_goto'> if (unlikely((__pyx_v_j == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_cp = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2));<span class='error_goto'> if (unlikely((__pyx_v_cp == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_param = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("R", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.R");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_i;
  __pyx_t_2 = __pyx_v_j;
  __pyx_t_3 = __pyx_v_cp;
  __pyx_t_4 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  __pyx_t_5 = __pyx_f_9optneuosc_R(__pyx_t_1, __pyx_t_2, __pyx_t_3, __pyx_t_4, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.R");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line114")'> 114:     cdef int k</pre>
<pre id='line114' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line115")'> 115:     cdef double sd,cd</pre>
<pre id='line115' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line116")'> 116:     cdef complex faseCP</pre>
<pre id='line116' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line117")'> 117: </pre>
<pre id='line117' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line118")'> 118:     # rotation matrix generator</pre>
<pre id='line118' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line119")'> 119:     R = zeros([param.numneu,param.numneu],complex)</pre>
<pre id='line119' class='code' style='background-color: #FFFF38'>
  /* "optneuosc.pyx":119
 * 
 *     # rotation matrix generator
 *     R = zeros([param.numneu,param.numneu],complex)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # diagonal terms
 *     for k in range(param.numneu):
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_4));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_4));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)(&PyComplex_Type))));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)((PyObject*)(&PyComplex_Type))));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)(&PyComplex_Type))));
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_R);
  __pyx_v_R = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line120")'> 120:     # diagonal terms</pre>
<pre id='line120' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line121")'> 121:     for k in range(param.numneu):</pre>
<pre id='line121' class='code' style='background-color: #FFFF62'>
  /* "optneuosc.pyx":121
 *     R = zeros([param.numneu,param.numneu],complex)
 *     # diagonal terms
 *     for k in range(param.numneu):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if(k != i-1 and k != j-1):
 *             R[k,k] = 1.0
 */
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_k = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line122")'> 122:         if(k != i-1 and k != j-1):</pre>
<pre id='line122' class='code' style='background-color: #FFFFff'>
    /* "optneuosc.pyx":122
 *     # diagonal terms
 *     for k in range(param.numneu):
 *         if(k != i-1 and k != j-1):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             R[k,k] = 1.0
 *         else :
 */
    __pyx_t_7 = (__pyx_v_k != (__pyx_v_i - 1));
    if (__pyx_t_7) {
      __pyx_t_8 = (__pyx_v_k != (__pyx_v_j - 1));
      __pyx_t_9 = __pyx_t_8;
    } else {
      __pyx_t_9 = __pyx_t_7;
    }
    if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line123")'> 123:             R[k,k] = 1.0</pre>
<pre id='line123' class='code' style='background-color: #FFFF41'>
      /* "optneuosc.pyx":123
 *     for k in range(param.numneu):
 *         if(k != i-1 and k != j-1):
 *             R[k,k] = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else :
 *             R[k,k] = param.c[i,j]
 */
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_3 = 0;
      __pyx_t_1 = 0;
      if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_R, ((PyObject *)__pyx_t_2), __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line124")'> 124:         else :</pre>
<pre id='line124' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF28' onclick='toggleDiv("line125")'> 125:             R[k,k] = param.c[i,j]</pre>
<pre id='line125' class='code' style='background-color: #FFFF28'>
      /* "optneuosc.pyx":125
 *             R[k,k] = 1.0
 *         else :
 *             R[k,k] = param.c[i,j]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # non-diagonal terms
 *     if(cp != 0):
 */
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__c);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_4, ((PyObject *)__pyx_t_3));<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_4);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
      __pyx_t_3 = 0;
      __pyx_t_4 = 0;
      if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_R, ((PyObject *)__pyx_t_2), __pyx_t_1) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_L5:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line126")'> 126:     # non-diagonal terms</pre>
<pre id='line126' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line127")'> 127:     if(cp != 0):</pre>
<pre id='line127' class='code' style='background-color: #FFFFff'>
  /* "optneuosc.pyx":127
 *             R[k,k] = param.c[i,j]
 *     # non-diagonal terms
 *     if(cp != 0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         sd = sin(param.dcp[cp])
 *         cd = cos(param.dcp[cp])
 */
  __pyx_t_9 = (__pyx_v_cp != 0);
  if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line128")'> 128:         sd = sin(param.dcp[cp])</pre>
<pre id='line128' class='code' style='background-color: #FFFF57'>
    /* "optneuosc.pyx":128
 *     # non-diagonal terms
 *     if(cp != 0):
 *         sd = sin(param.dcp[cp])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cd = cos(param.dcp[cp])
 *         faseCP = complex(cd,sd)
 */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__dcp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_cp, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_10 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_10 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_sd = sin(__pyx_t_10);
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line129")'> 129:         cd = cos(param.dcp[cp])</pre>
<pre id='line129' class='code' style='background-color: #FFFF57'>
    /* "optneuosc.pyx":129
 *     if(cp != 0):
 *         sd = sin(param.dcp[cp])
 *         cd = cos(param.dcp[cp])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         faseCP = complex(cd,sd)
 *     else:
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__dcp);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, __pyx_v_cp, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_10 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_10 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_cd = cos(__pyx_t_10);
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line130")'> 130:         faseCP = complex(cd,sd)</pre>
<pre id='line130' class='code' style='background-color: #FFFF39'>
    /* "optneuosc.pyx":130
 *         sd = sin(param.dcp[cp])
 *         cd = cos(param.dcp[cp])
 *         faseCP = complex(cd,sd)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     else:
 *         faseCP = complex(1.0,0.0)
 */
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_cd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyComplex_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_11 = __Pyx_<span class='py_c_api'>PyComplex_As___pyx_t_double_complex</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_faseCP = __pyx_t_11;
    goto __pyx_L6;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line131")'> 131:     else:</pre>
<pre id='line131' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line132")'> 132:         faseCP = complex(1.0,0.0)</pre>
<pre id='line132' class='code' style='background-color: #FFFF39'>
    /* "optneuosc.pyx":132
 *         faseCP = complex(cd,sd)
 *     else:
 *         faseCP = complex(1.0,0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     R[i-1,j-1] = param.s[i,j]*faseCP.conjugate()
 */
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    __pyx_t_2 = 0;
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyComplex_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_11 = __Pyx_<span class='py_c_api'>PyComplex_As___pyx_t_double_complex</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_faseCP = __pyx_t_11;
  }
  __pyx_L6:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line133")'> 133: </pre>
<pre id='line133' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line134")'> 134:     R[i-1,j-1] = param.s[i,j]*faseCP.conjugate()</pre>
<pre id='line134' class='code' style='background-color: #FFFF22'>
  /* "optneuosc.pyx":134
 *         faseCP = complex(1.0,0.0)
 * 
 *     R[i-1,j-1] = param.s[i,j]*faseCP.conjugate()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     R[j-1,i-1] = -param.s[i,j]*faseCP
 *     return R
 */
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_4, ((PyObject *)__pyx_t_3));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__Pyx_c_conj(__pyx_v_faseCP));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_i - 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_j - 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_3 = 0;
  __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_R, ((PyObject *)__pyx_t_1), __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line135")'> 135:     R[j-1,i-1] = -param.s[i,j]*faseCP</pre>
<pre id='line135' class='code' style='background-color: #FFFF1f'>
  /* "optneuosc.pyx":135
 * 
 *     R[i-1,j-1] = param.s[i,j]*faseCP.conjugate()
 *     R[j-1,i-1] = -param.s[i,j]*faseCP             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return R
 * 
 */
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_4, ((PyObject *)__pyx_t_3));<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_faseCP);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_j - 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_i - 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_R, ((PyObject *)__pyx_t_1), __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line136")'> 136:     return R</pre>
<pre id='line136' class='code' style='background-color: #FFFF79'>
  /* "optneuosc.pyx":136
 *     R[i-1,j-1] = param.s[i,j]*faseCP.conjugate()
 *     R[j-1,i-1] = -param.s[i,j]*faseCP
 *     return R             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef Ropt(int i,int j,int nn,int cp,double s[4][4],double c[4][4],double dcp[4]):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_R);
  __pyx_r = __pyx_v_R;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.R");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_R);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line137")'> 137: </pre>
<pre id='line137' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line138")'> 138: cdef Ropt(int i,int j,int nn,int cp,double s[4][4],double c[4][4],double dcp[4]):</pre>
<pre id='line138' class='code' style='background-color: #FFFFd4'>
/* "optneuosc.pyx":138
 *     return R
 * 
 * cdef Ropt(int i,int j,int nn,int cp,double s[4][4],double c[4][4],double dcp[4]):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int k
 *     cdef double sd,cd
 */

static  PyObject *__pyx_f_9optneuosc_Ropt(int __pyx_v_i, int __pyx_v_j, int __pyx_v_nn, int __pyx_v_cp, double (*__pyx_v_s)[4], double (*__pyx_v_c)[4], double *__pyx_v_dcp) {
  int __pyx_v_k;
  double __pyx_v_sd;
  double __pyx_v_cd;
  __pyx_t_double_complex __pyx_v_faseCP;
  PyObject *__pyx_v_R;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("Ropt");
  __pyx_v_R = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line139")'> 139:     cdef int k</pre>
<pre id='line139' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line140")'> 140:     cdef double sd,cd</pre>
<pre id='line140' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line141")'> 141:     cdef complex faseCP</pre>
<pre id='line141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line142")'> 142: </pre>
<pre id='line142' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line143")'> 143:     # rotation matrix generator</pre>
<pre id='line143' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line144")'> 144:     R = zeros([nn,nn],complex)</pre>
<pre id='line144' class='code' style='background-color: #FFFF38'>
  /* "optneuosc.pyx":144
 * 
 *     # rotation matrix generator
 *     R = zeros([nn,nn],complex)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # diagonal terms
 *     for k in range(nn):
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_nn);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_nn);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_t_4));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_4));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)(&PyComplex_Type))));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)((PyObject*)(&PyComplex_Type))));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)(&PyComplex_Type))));
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_R);
  __pyx_v_R = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line145")'> 145:     # diagonal terms</pre>
<pre id='line145' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line146")'> 146:     for k in range(nn):</pre>
<pre id='line146' class='code' style='background-color: #FFFFff'>
  /* "optneuosc.pyx":146
 *     R = zeros([nn,nn],complex)
 *     # diagonal terms
 *     for k in range(nn):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if(k != i-1 and k != j-1):
 *             R[k,k] = 1.0
 */
  __pyx_t_5 = __pyx_v_nn;
  for (__pyx_t_6 = 0; __pyx_t_6 <code><</code> __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_k = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line147")'> 147:         if(k != i-1 and k != j-1):</pre>
<pre id='line147' class='code' style='background-color: #FFFFff'>
    /* "optneuosc.pyx":147
 *     # diagonal terms
 *     for k in range(nn):
 *         if(k != i-1 and k != j-1):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             R[k,k] = 1.0
 *         else :
 */
    __pyx_t_7 = (__pyx_v_k != (__pyx_v_i - 1));
    if (__pyx_t_7) {
      __pyx_t_8 = (__pyx_v_k != (__pyx_v_j - 1));
      __pyx_t_9 = __pyx_t_8;
    } else {
      __pyx_t_9 = __pyx_t_7;
    }
    if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line148")'> 148:             R[k,k] = 1.0</pre>
<pre id='line148' class='code' style='background-color: #FFFF41'>
      /* "optneuosc.pyx":148
 *     for k in range(nn):
 *         if(k != i-1 and k != j-1):
 *             R[k,k] = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else :
 *             R[k,k] = c[i][j]
 */
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_3 = 0;
      __pyx_t_1 = 0;
      if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_R, ((PyObject *)__pyx_t_2), __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line149")'> 149:         else :</pre>
<pre id='line149' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line150")'> 150:             R[k,k] = c[i][j]</pre>
<pre id='line150' class='code' style='background-color: #FFFF41'>
      /* "optneuosc.pyx":150
 *             R[k,k] = 1.0
 *         else :
 *             R[k,k] = c[i][j]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # non-diagonal terms
 *     if(cp != 0):
 */
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_c[__pyx_v_i])[__pyx_v_j]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
      if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_R, ((PyObject *)__pyx_t_3), __pyx_t_4) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_L5:;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line151")'> 151:     # non-diagonal terms</pre>
<pre id='line151' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line152")'> 152:     if(cp != 0):</pre>
<pre id='line152' class='code' style='background-color: #FFFFff'>
  /* "optneuosc.pyx":152
 *             R[k,k] = c[i][j]
 *     # non-diagonal terms
 *     if(cp != 0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         sd = sin(dcp[cp])
 *         cd = cos(dcp[cp])
 */
  __pyx_t_9 = (__pyx_v_cp != 0);
  if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line153")'> 153:         sd = sin(dcp[cp])</pre>
<pre id='line153' class='code' style='background-color: #FFFFff'>
    /* "optneuosc.pyx":153
 *     # non-diagonal terms
 *     if(cp != 0):
 *         sd = sin(dcp[cp])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         cd = cos(dcp[cp])
 *         faseCP = complex(cd,sd)
 */
    __pyx_v_sd = sin((__pyx_v_dcp[__pyx_v_cp]));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line154")'> 154:         cd = cos(dcp[cp])</pre>
<pre id='line154' class='code' style='background-color: #FFFFff'>
    /* "optneuosc.pyx":154
 *     if(cp != 0):
 *         sd = sin(dcp[cp])
 *         cd = cos(dcp[cp])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         faseCP = complex(cd,sd)
 *     else:
 */
    __pyx_v_cd = cos((__pyx_v_dcp[__pyx_v_cp]));
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line155")'> 155:         faseCP = complex(cd,sd)</pre>
<pre id='line155' class='code' style='background-color: #FFFF39'>
    /* "optneuosc.pyx":155
 *         sd = sin(dcp[cp])
 *         cd = cos(dcp[cp])
 *         faseCP = complex(cd,sd)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     else:
 *         faseCP = complex(1.0,0.0)
 */
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_cd);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_4 = 0;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyComplex_Type))), ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_10 = __Pyx_<span class='py_c_api'>PyComplex_As___pyx_t_double_complex</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_faseCP = __pyx_t_10;
    goto __pyx_L6;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line156")'> 156:     else:</pre>
<pre id='line156' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line157")'> 157:         faseCP = complex(1.0,0.0)</pre>
<pre id='line157' class='code' style='background-color: #FFFF39'>
    /* "optneuosc.pyx":157
 *         faseCP = complex(cd,sd)
 *     else:
 *         faseCP = complex(1.0,0.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     R[i-1,j-1]  == s[i][j]*faseCP.conjugate()
 */
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_4));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
    __pyx_t_3 = 0;
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyComplex_Type))), ((PyObject *)__pyx_t_4), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_10 = __Pyx_<span class='py_c_api'>PyComplex_As___pyx_t_double_complex</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_faseCP = __pyx_t_10;
  }
  __pyx_L6:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line158")'> 158: </pre>
<pre id='line158' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line159")'> 159:     R[i-1,j-1]  == s[i][j]*faseCP.conjugate()</pre>
<pre id='line159' class='code' style='background-color: #FFFF37'>
  /* "optneuosc.pyx":159
 *         faseCP = complex(1.0,0.0)
 * 
 *     R[i-1,j-1]  == s[i][j]*faseCP.conjugate()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     R[j-1,i-1] = -s[i][j]*faseCP
 *     return R
 */
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_i - 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_j - 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_R, ((PyObject *)__pyx_t_3));<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__Pyx_c_prod(__pyx_t_double_complex_from_parts(((__pyx_v_s[__pyx_v_i])[__pyx_v_j]), 0), __Pyx_c_conj(__pyx_v_faseCP)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, ((PyObject *)__pyx_t_3), Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line160")'> 160:     R[j-1,i-1] = -s[i][j]*faseCP</pre>
<pre id='line160' class='code' style='background-color: #FFFF41'>
  /* "optneuosc.pyx":160
 * 
 *     R[i-1,j-1]  == s[i][j]*faseCP.conjugate()
 *     R[j-1,i-1] = -s[i][j]*faseCP             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return R
 * 
 */
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__Pyx_c_prod(__pyx_t_double_complex_from_parts((-((__pyx_v_s[__pyx_v_i])[__pyx_v_j])), 0), __pyx_v_faseCP));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_j - 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromLong</span>((__pyx_v_i - 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_4);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_4);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_R, ((PyObject *)__pyx_t_2), ((PyObject *)__pyx_t_1)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line161")'> 161:     return R</pre>
<pre id='line161' class='code' style='background-color: #FFFF79'>
  /* "optneuosc.pyx":161
 *     R[i-1,j-1]  == s[i][j]*faseCP.conjugate()
 *     R[j-1,i-1] = -s[i][j]*faseCP
 *     return R             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef CompleteDecoherenceOscProb(fneu_flavor,PMNS,param):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_R);
  __pyx_r = __pyx_v_R;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.Ropt");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_R);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line162")'> 162: </pre>
<pre id='line162' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line163")'> 163: cpdef CompleteDecoherenceOscProb(fneu_flavor,PMNS,param):</pre>
<pre id='line163' class='code' style='background-color: #FFFF22'>
/* "optneuosc.pyx":163
 *     return R
 * 
 * cpdef CompleteDecoherenceOscProb(fneu_flavor,PMNS,param):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int flv
 *     fneu_mass = dot(PMNS.UCT,fneu_flavor)
 */

static PyObject *__pyx_pf_9optneuosc_8CompleteDecoherenceOscProb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_CompleteDecoherenceOscProb(PyObject *__pyx_v_fneu_flavor, PyObject *__pyx_v_PMNS, PyObject *__pyx_v_param, int __pyx_skip_dispatch) {
  int __pyx_v_flv;
  PyObject *__pyx_v_fneu_mass;
  PyObject *__pyx_v_prob_flv;
  PyObject *__pyx_v_vfinal;
  PyObject *__pyx_v_prob;
  PyObject *__pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("CompleteDecoherenceOscProb");
  __pyx_v_fneu_mass = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_prob_flv = ((PyObject*)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_vfinal = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_prob = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_i = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":163
 *     return R
 * 
 * cpdef CompleteDecoherenceOscProb(fneu_flavor,PMNS,param):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int flv
 *     fneu_mass = dot(PMNS.UCT,fneu_flavor)
 */

static PyObject *__pyx_pf_9optneuosc_8CompleteDecoherenceOscProb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_9optneuosc_8CompleteDecoherenceOscProb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_fneu_flavor = 0;
  PyObject *__pyx_v_PMNS = 0;
  PyObject *__pyx_v_param = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__fneu_flavor,&__pyx_n_s__PMNS,&__pyx_n_s__param,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("CompleteDecoherenceOscProb");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[3] = {0,0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__fneu_flavor);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__PMNS);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CompleteDecoherenceOscProb", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  2:
      values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__param);
      if (likely(values[2])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CompleteDecoherenceOscProb", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "CompleteDecoherenceOscProb") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_fneu_flavor = values[0];
    __pyx_v_PMNS = values[1];
    __pyx_v_param = values[2];
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_fneu_flavor = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    __pyx_v_PMNS = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    __pyx_v_param = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CompleteDecoherenceOscProb", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.CompleteDecoherenceOscProb");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_fneu_flavor;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_PMNS;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_f_9optneuosc_CompleteDecoherenceOscProb(__pyx_t_1, __pyx_t_2, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.CompleteDecoherenceOscProb");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line164")'> 164:     cdef int flv</pre>
<pre id='line164' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line165")'> 165:     fneu_mass = dot(PMNS.UCT,fneu_flavor)</pre>
<pre id='line165' class='code' style='background-color: #FFFF4d'>
  /* "optneuosc.pyx":165
 * cpdef CompleteDecoherenceOscProb(fneu_flavor,PMNS,param):
 *     cdef int flv
 *     fneu_mass = dot(PMNS.UCT,fneu_flavor)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     prob_flv = []
 *     for flv in range(param.numneu):
 */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__dot);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_PMNS, __pyx_n_s__UCT);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fneu_flavor);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_fneu_flavor);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_fneu_flavor);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_fneu_mass);
  __pyx_v_fneu_mass = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line166")'> 166:     prob_flv = []</pre>
<pre id='line166' class='code' style='background-color: #FFFF9f'>
  /* "optneuosc.pyx":166
 *     cdef int flv
 *     fneu_mass = dot(PMNS.UCT,fneu_flavor)
 *     prob_flv = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     for flv in range(param.numneu):
 *         vfinal = PMNS.U[flv,:]
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_prob_flv));
  __pyx_v_prob_flv = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line167")'> 167:     for flv in range(param.numneu):</pre>
<pre id='line167' class='code' style='background-color: #FFFF62'>
  /* "optneuosc.pyx":167
 *     fneu_mass = dot(PMNS.UCT,fneu_flavor)
 *     prob_flv = []
 *     for flv in range(param.numneu):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         vfinal = PMNS.U[flv,:]
 *         prob = 0.0
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyInt_AsLong</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_4 == (long)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (__pyx_t_5 = 0; __pyx_t_5 <code><</code> __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_flv = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line168")'> 168:         vfinal = PMNS.U[flv,:]</pre>
<pre id='line168' class='code' style='background-color: #FFFF3e'>
    /* "optneuosc.pyx":168
 *     prob_flv = []
 *     for flv in range(param.numneu):
 *         vfinal = PMNS.U[flv,:]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         prob = 0.0
 *         for i in range(param.numneu):
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_PMNS, __pyx_n_s__U);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_flv);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_k_slice_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_k_slice_5);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_5);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_2, ((PyObject *)__pyx_t_1));<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_vfinal);
    __pyx_v_vfinal = __pyx_t_3;
    __pyx_t_3 = 0;

  /* "optneuosc.pyx":168
 *     prob_flv = []
 *     for flv in range(param.numneu):
 *         vfinal = PMNS.U[flv,:]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         prob = 0.0
 *         for i in range(param.numneu):
 */
  __pyx_k_slice_5 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_k_slice_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_k_slice_5);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_k_slice_5);
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line169")'> 169:         prob = 0.0</pre>
<pre id='line169' class='code' style='background-color: #FFFF9f'>
    /* "optneuosc.pyx":169
 *     for flv in range(param.numneu):
 *         vfinal = PMNS.U[flv,:]
 *         prob = 0.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         for i in range(param.numneu):
 *             prob = prob + gt.norm(fneu_mass[i])**2*gt.norm(vfinal[i])**2
 */
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_prob);
    __pyx_v_prob = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line170")'> 170:         for i in range(param.numneu):</pre>
<pre id='line170' class='code' style='background-color: #FFFF23'>
    /* "optneuosc.pyx":170
 *         vfinal = PMNS.U[flv,:]
 *         prob = 0.0
 *         for i in range(param.numneu):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             prob = prob + gt.norm(fneu_mass[i])**2*gt.norm(vfinal[i])**2
 *         prob_flv.append(prob[0])
 */
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      __pyx_t_6 = 0; __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    } else {
      __pyx_t_6 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    for (;;) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_6 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_6++;
      } else if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_6 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_6++;
      } else {
        __pyx_t_3 = <span class='py_c_api'>PyIter_Next</span>(__pyx_t_1);
        if (!__pyx_t_3) {
          if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>()))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          break;
        }
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_i);
      __pyx_v_i = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line171")'> 171:             prob = prob + gt.norm(fneu_mass[i])**2*gt.norm(vfinal[i])**2</pre>
<pre id='line171' class='code' style='background-color: #FFFF1c'>
      /* "optneuosc.pyx":171
 *         prob = 0.0
 *         for i in range(param.numneu):
 *             prob = prob + gt.norm(fneu_mass[i])**2*gt.norm(vfinal[i])**2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         prob_flv.append(prob[0])
 *     return prob_flv
 */
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__gt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__norm);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fneu_mass, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_3, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__gt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__norm);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vfinal, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_3, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_prob, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_prob);
      __pyx_v_prob = __pyx_t_8;
      __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line172")'> 172:         prob_flv.append(prob[0])</pre>
<pre id='line172' class='code' style='background-color: #FFFF6e'>
    /* "optneuosc.pyx":172
 *         for i in range(param.numneu):
 *             prob = prob + gt.norm(fneu_mass[i])**2*gt.norm(vfinal[i])**2
 *         prob_flv.append(prob[0])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return prob_flv
 * 
 */
    if (unlikely(__pyx_v_prob_flv == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError, "'NoneType' object has no attribute 'append'");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> 
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_prob, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_9 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_prob_flv, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line173")'> 173:     return prob_flv</pre>
<pre id='line173' class='code' style='background-color: #FFFF62'>
  /* "optneuosc.pyx":173
 *             prob = prob + gt.norm(fneu_mass[i])**2*gt.norm(vfinal[i])**2
 *         prob_flv.append(prob[0])
 *     return prob_flv             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_prob_flv));
  __pyx_r = ((PyObject *)__pyx_v_prob_flv);
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.CompleteDecoherenceOscProb");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_fneu_mass);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_prob_flv);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_vfinal);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_prob);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line174")'> 174: </pre>
<pre id='line174' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line175")'> 175: </pre>
<pre id='line175' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line176")'> 176: #===============================================================================</pre>
<pre id='line176' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line177")'> 177: # FAST DATA COUNTING</pre>
<pre id='line177' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line178")'> 178: #===============================================================================</pre>
<pre id='line178' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line179")'> 179: </pre>
<pre id='line179' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF09' onclick='toggleDiv("line180")'> 180: cpdef DMEvtProcessv2(E_nu_bin,E_anu_bin,E_nu_list,E_bin_width,events,DM_pdf_table,double E_nu_list_0,double log_E_bin_ratio,double DMm_GeV, double E_in_GeV,int ini,fam_num,ineu):</pre>
<pre id='line180' class='code' style='background-color: #FFFF09'>
/* "optneuosc.pyx":180
 * #===============================================================================
 * 
 * cpdef DMEvtProcessv2(E_nu_bin,E_anu_bin,E_nu_list,E_bin_width,events,DM_pdf_table,double E_nu_list_0,double log_E_bin_ratio,double DMm_GeV, double E_in_GeV,int ini,fam_num,ineu):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i,ii,jj,iineu,ineutype,family
 *     cdef double E_nu_in,E_nu_out
 */

static PyObject *__pyx_pf_9optneuosc_9DMEvtProcessv2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_DMEvtProcessv2(PyObject *__pyx_v_E_nu_bin, PyObject *__pyx_v_E_anu_bin, PyObject *__pyx_v_E_nu_list, PyObject *__pyx_v_E_bin_width, PyObject *__pyx_v_events, PyObject *__pyx_v_DM_pdf_table, double __pyx_v_E_nu_list_0, double __pyx_v_log_E_bin_ratio, double __pyx_v_DMm_GeV, double __pyx_v_E_in_GeV, int __pyx_v_ini, PyObject *__pyx_v_fam_num, PyObject *__pyx_v_ineu, int __pyx_skip_dispatch) {
  int __pyx_v_i;
  int __pyx_v_ii;
  int __pyx_v_iineu;
  int __pyx_v_ineutype;
  int __pyx_v_family;
  double __pyx_v_E_nu_in;
  double __pyx_v_E_nu_out;
  double __pyx_v_eps;
  PyObject *__pyx_v_e;
  PyObject *__pyx_v_fam_factor;
  double __pyx_v_ini_evt_energy;
  PyObject *__pyx_v_DM_pdf_array;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("DMEvtProcessv2");
  __pyx_v_e = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_fam_factor = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_DM_pdf_array = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":180
 * #===============================================================================
 * 
 * cpdef DMEvtProcessv2(E_nu_bin,E_anu_bin,E_nu_list,E_bin_width,events,DM_pdf_table,double E_nu_list_0,double log_E_bin_ratio,double DMm_GeV, double E_in_GeV,int ini,fam_num,ineu):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i,ii,jj,iineu,ineutype,family
 *     cdef double E_nu_in,E_nu_out
 */

static PyObject *__pyx_pf_9optneuosc_9DMEvtProcessv2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_9optneuosc_9DMEvtProcessv2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_E_nu_bin = 0;
  PyObject *__pyx_v_E_anu_bin = 0;
  PyObject *__pyx_v_E_nu_list = 0;
  PyObject *__pyx_v_E_bin_width = 0;
  PyObject *__pyx_v_events = 0;
  PyObject *__pyx_v_DM_pdf_table = 0;
  double __pyx_v_E_nu_list_0;
  double __pyx_v_log_E_bin_ratio;
  double __pyx_v_DMm_GeV;
  double __pyx_v_E_in_GeV;
  int __pyx_v_ini;
  PyObject *__pyx_v_fam_num = 0;
  PyObject *__pyx_v_ineu = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__E_nu_bin,&__pyx_n_s__E_anu_bin,&__pyx_n_s__E_nu_list,&__pyx_n_s__E_bin_width,&__pyx_n_s__events,&__pyx_n_s__DM_pdf_table,&__pyx_n_s__E_nu_list_0,&__pyx_n_s__log_E_bin_ratio,&__pyx_n_s__DMm_GeV,&__pyx_n_s__E_in_GeV,&__pyx_n_s__ini,&__pyx_n_s__fam_num,&__pyx_n_s__ineu,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("DMEvtProcessv2");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[13] = {0,0,0,0,0,0,0,0,0,0,0,0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
      case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
      case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_nu_bin);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_anu_bin);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  2:
      values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_nu_list);
      if (likely(values[2])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  3:
      values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_bin_width);
      if (likely(values[3])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  4:
      values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__events);
      if (likely(values[4])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  5:
      values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__DM_pdf_table);
      if (likely(values[5])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 5);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  6:
      values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_nu_list_0);
      if (likely(values[6])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 6);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  7:
      values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__log_E_bin_ratio);
      if (likely(values[7])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 7);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  8:
      values[8] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__DMm_GeV);
      if (likely(values[8])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 8);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  9:
      values[9] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_in_GeV);
      if (likely(values[9])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 9);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case 10:
      values[10] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ini);
      if (likely(values[10])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 10);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case 11:
      values[11] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__fam_num);
      if (likely(values[11])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 11);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case 12:
      values[12] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ineu);
      if (likely(values[12])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, 12);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "DMEvtProcessv2") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_E_nu_bin = values[0];
    __pyx_v_E_anu_bin = values[1];
    __pyx_v_E_nu_list = values[2];
    __pyx_v_E_bin_width = values[3];
    __pyx_v_events = values[4];
    __pyx_v_DM_pdf_table = values[5];
    __pyx_v_E_nu_list_0 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_E_nu_list_0 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_log_E_bin_ratio = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[7]);<span class='error_goto'> if (unlikely((__pyx_v_log_E_bin_ratio == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_DMm_GeV = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[8]);<span class='error_goto'> if (unlikely((__pyx_v_DMm_GeV == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_E_in_GeV = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[9]);<span class='error_goto'> if (unlikely((__pyx_v_E_in_GeV == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_ini = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(values[10]);<span class='error_goto'> if (unlikely((__pyx_v_ini == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_fam_num = values[11];
    __pyx_v_ineu = values[12];
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 13) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_E_nu_bin = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    __pyx_v_E_anu_bin = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    __pyx_v_E_nu_list = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    __pyx_v_E_bin_width = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    __pyx_v_events = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    __pyx_v_DM_pdf_table = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    __pyx_v_E_nu_list_0 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6));<span class='error_goto'> if (unlikely((__pyx_v_E_nu_list_0 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_log_E_bin_ratio = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7));<span class='error_goto'> if (unlikely((__pyx_v_log_E_bin_ratio == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_DMm_GeV = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8));<span class='error_goto'> if (unlikely((__pyx_v_DMm_GeV == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_E_in_GeV = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9));<span class='error_goto'> if (unlikely((__pyx_v_E_in_GeV == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_ini = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10));<span class='error_goto'> if (unlikely((__pyx_v_ini == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_fam_num = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
    __pyx_v_ineu = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcessv2", 1, 13, 13, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.DMEvtProcessv2");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_E_nu_bin;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_E_anu_bin;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_v_E_nu_list;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_v_E_bin_width;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  __pyx_t_5 = __pyx_v_events;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
  __pyx_t_6 = __pyx_v_DM_pdf_table;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
  __pyx_t_7 = __pyx_v_E_nu_list_0;
  __pyx_t_8 = __pyx_v_log_E_bin_ratio;
  __pyx_t_9 = __pyx_v_DMm_GeV;
  __pyx_t_10 = __pyx_v_E_in_GeV;
  __pyx_t_11 = __pyx_v_ini;
  __pyx_t_12 = __pyx_v_fam_num;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
  __pyx_t_13 = __pyx_v_ineu;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
  __pyx_t_14 = __pyx_f_9optneuosc_DMEvtProcessv2(__pyx_t_1, __pyx_t_2, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12, __pyx_t_13, 0);<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_r = __pyx_t_14;
  __pyx_t_14 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.DMEvtProcessv2");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line181")'> 181:     cdef int i,ii,jj,iineu,ineutype,family</pre>
<pre id='line181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line182")'> 182:     cdef double E_nu_in,E_nu_out</pre>
<pre id='line182' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line183")'> 183: </pre>
<pre id='line183' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line184")'> 184:     cdef double eps</pre>
<pre id='line184' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line185")'> 185: </pre>
<pre id='line185' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line186")'> 186:     eps = 1.0e-4</pre>
<pre id='line186' class='code' style='background-color: #FFFFff'>
  /* "optneuosc.pyx":186
 *     cdef double eps
 * 
 *     eps = 1.0e-4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for i,e in enumerate(events):
 */
  __pyx_v_eps = 1.0e-4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line187")'> 187: </pre>
<pre id='line187' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line188")'> 188:     for i,e in enumerate(events):</pre>
<pre id='line188' class='code' style='background-color: #FFFF30'>
  /* "optneuosc.pyx":188
 *     eps = 1.0e-4
 * 
 *     for i,e in enumerate(events):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if len(e) > 5:
 */
  __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_events) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_events)) {
    __pyx_t_2 = 0; __pyx_t_3 = __pyx_v_events; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_events);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  }
  for (;;) {
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;
    } else if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;
    } else {
      __pyx_t_4 = <span class='py_c_api'>PyIter_Next</span>(__pyx_t_3);
      if (!__pyx_t_4) {
        if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>()))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e);
    __pyx_v_e = __pyx_t_4;
    __pyx_t_4 = 0;
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = (__pyx_t_1 + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line189")'> 189: </pre>
<pre id='line189' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line190")'> 190:         if len(e) &gt; 5:</pre>
<pre id='line190' class='code' style='background-color: #FFFFaa'>
    /* "optneuosc.pyx":190
 *     for i,e in enumerate(events):
 * 
 *         if len(e) > 5:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             family = e[0]
 *             iineu  = e[1]
 */
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_e);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = (__pyx_t_5 > 5);
    if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line191")'> 191:             family = e[0]</pre>
<pre id='line191' class='code' style='background-color: #FFFF6e'>
      /* "optneuosc.pyx":191
 * 
 *         if len(e) > 5:
 *             family = e[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             iineu  = e[1]
 *             ineutype = e[2]
 */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_family = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line192")'> 192:             iineu  = e[1]</pre>
<pre id='line192' class='code' style='background-color: #FFFF6e'>
      /* "optneuosc.pyx":192
 *         if len(e) > 5:
 *             family = e[0]
 *             iineu  = e[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ineutype = e[2]
 *             E_nu_in  = e[3]
 */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 1, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_iineu = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line193")'> 193:             ineutype = e[2]</pre>
<pre id='line193' class='code' style='background-color: #FFFF6e'>
      /* "optneuosc.pyx":193
 *             family = e[0]
 *             iineu  = e[1]
 *             ineutype = e[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             E_nu_in  = e[3]
 *             E_nu_out = e[4]
 */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_ineutype = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line194")'> 194:             E_nu_in  = e[3]</pre>
<pre id='line194' class='code' style='background-color: #FFFF6e'>
      /* "optneuosc.pyx":194
 *             iineu  = e[1]
 *             ineutype = e[2]
 *             E_nu_in  = e[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             E_nu_out = e[4]
 * 
 */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 3, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_E_nu_in = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line195")'> 195:             E_nu_out = e[4]</pre>
<pre id='line195' class='code' style='background-color: #FFFF6e'>
      /* "optneuosc.pyx":195
 *             ineutype = e[2]
 *             E_nu_in  = e[3]
 *             E_nu_out = e[4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             fam_factor = fam_num[family-1]
 */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 4, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_E_nu_out = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line196")'> 196: </pre>
<pre id='line196' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line197")'> 197:             fam_factor = fam_num[family-1]</pre>
<pre id='line197' class='code' style='background-color: #FFFFc4'>
      /* "optneuosc.pyx":197
 *             E_nu_out = e[4]
 * 
 *             fam_factor = fam_num[family-1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             ini_evt_energy = E_in_GeV
 */
      __pyx_t_9 = (__pyx_v_family - 1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_fam_num, __pyx_t_9, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_fam_factor);
      __pyx_v_fam_factor = __pyx_t_4;
      __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line198")'> 198: </pre>
<pre id='line198' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line199")'> 199:             ini_evt_energy = E_in_GeV</pre>
<pre id='line199' class='code' style='background-color: #FFFFff'>
      /* "optneuosc.pyx":199
 *             fam_factor = fam_num[family-1]
 * 
 *             ini_evt_energy = E_in_GeV             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             ii = int(log(E_nu_out/E_nu_list_0)/log_E_bin_ratio+eps)
 */
      __pyx_v_ini_evt_energy = __pyx_v_E_in_GeV;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line200")'> 200: </pre>
<pre id='line200' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line201")'> 201:             ii = int(log(E_nu_out/E_nu_list_0)/log_E_bin_ratio+eps)</pre>
<pre id='line201' class='code' style='background-color: #FFFF7f'>
      /* "optneuosc.pyx":201
 *             ini_evt_energy = E_in_GeV
 * 
 *             ii = int(log(E_nu_out/E_nu_list_0)/log_E_bin_ratio+eps)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             #if E_nu_out != E_in_GeV :
 */
      if (unlikely(__pyx_v_E_nu_list_0 == 0)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_8 = log((__pyx_v_E_nu_out / __pyx_v_E_nu_list_0));
      if (unlikely(__pyx_v_log_E_bin_ratio == 0)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_ii = ((int)((__pyx_t_8 / __pyx_v_log_E_bin_ratio) + __pyx_v_eps));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line202")'> 202: </pre>
<pre id='line202' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line203")'> 203:             #if E_nu_out != E_in_GeV :</pre>
<pre id='line203' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line204")'> 204:             #    print e</pre>
<pre id='line204' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line205")'> 205:             #    print E_nu_out, e[6], ii</pre>
<pre id='line205' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line206")'> 206:             #    raw_input("Wait ...")</pre>
<pre id='line206' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line207")'> 207:             #ini = int(log(ini_evt_energy/E_nu_list_0)/log_E_bin_ratio+eps)</pre>
<pre id='line207' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line208")'> 208: </pre>
<pre id='line208' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line209")'> 209:             iineu = ineu</pre>
<pre id='line209' class='code' style='background-color: #FFFF7f'>
      /* "optneuosc.pyx":209
 *             #ini = int(log(ini_evt_energy/E_nu_list_0)/log_E_bin_ratio+eps)
 * 
 *             iineu = ineu             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             if ineutype == 0:
 */
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_ineu);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_v_iineu = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line210")'> 210: </pre>
<pre id='line210' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line211")'> 211:             if ineutype == 0:</pre>
<pre id='line211' class='code' style='background-color: #FFFFff'>
        /* "optneuosc.pyx":211
 *             iineu = ineu
 * 
 *             if ineutype == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 DM_pdf_array = DM_pdf_table[iineu*2]
 *                 if E_nu_in + E_bin_width[ini] > DMm_GeV:
 */
        case 0:
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line212")'> 212:                 DM_pdf_array = DM_pdf_table[iineu*2]</pre>
<pre id='line212' class='code' style='background-color: #FFFFc4'>
        /* "optneuosc.pyx":212
 * 
 *             if ineutype == 0:
 *                 DM_pdf_array = DM_pdf_table[iineu*2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if E_nu_in + E_bin_width[ini] > DMm_GeV:
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])*(DMm_GeV-E_nu_list[ini])/fam_factor
 */
        __pyx_t_9 = (__pyx_v_iineu * 2);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_DM_pdf_table, __pyx_t_9, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_DM_pdf_array);
        __pyx_v_DM_pdf_array = __pyx_t_4;
        __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line213")'> 213:                 if E_nu_in + E_bin_width[ini] &gt; DMm_GeV:</pre>
<pre id='line213' class='code' style='background-color: #FFFF3c'>
        /* "optneuosc.pyx":213
 *             if ineutype == 0:
 *                 DM_pdf_array = DM_pdf_table[iineu*2]
 *                 if E_nu_in + E_bin_width[ini] > DMm_GeV:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])*(DMm_GeV-E_nu_list[ini])/fam_factor
 *                 else:
 */
        __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_nu_in);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_bin_width, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_DMm_GeV);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_11, __pyx_t_10, Py_GT);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_6 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line214")'> 214:                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])*(DMm_GeV-E_nu_list[ini])/fam_factor</pre>
<pre id='line214' class='code' style='background-color: #FFFF2a'>
          /* "optneuosc.pyx":214
 *                 DM_pdf_array = DM_pdf_table[iineu*2]
 *                 if E_nu_in + E_bin_width[ini] > DMm_GeV:
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])*(DMm_GeV-E_nu_list[ini])/fam_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])*E_bin_width[ini]/fam_factor
 */
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_nu_bin, __pyx_v_ii, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 6, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_DM_pdf_array, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
          __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_10, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_DMm_GeV);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_nu_list, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          __pyx_t_13 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_11, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_t_10 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          __pyx_t_13 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_10, __pyx_v_fam_factor);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_E_nu_bin, __pyx_v_ii, __pyx_t_10, sizeof(int), PyInt_FromLong) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          goto __pyx_L6;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line215")'> 215:                 else:</pre>
<pre id='line215' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line216")'> 216:                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])*E_bin_width[ini]/fam_factor</pre>
<pre id='line216' class='code' style='background-color: #FFFF35'>
          /* "optneuosc.pyx":216
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])*(DMm_GeV-E_nu_list[ini])/fam_factor
 *                 else:
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])*E_bin_width[ini]/fam_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             elif ineutype == 1 :
 *                 DM_pdf_array = DM_pdf_table[iineu*2+1]
 */
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_nu_bin, __pyx_v_ii, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 6, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_DM_pdf_array, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_13, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_bin_width, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_13, __pyx_v_fam_factor);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_E_nu_bin, __pyx_v_ii, __pyx_t_13, sizeof(int), PyInt_FromLong) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        }
        __pyx_L6:;
        break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line217")'> 217:             elif ineutype == 1 :</pre>
<pre id='line217' class='code' style='background-color: #FFFFff'>
      /* "optneuosc.pyx":217
 *                 else:
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])*E_bin_width[ini]/fam_factor
 *             elif ineutype == 1 :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 DM_pdf_array = DM_pdf_table[iineu*2+1]
 *                 if E_nu_in + E_bin_width[ini] > DMm_GeV :
 */
      switch (__pyx_v_ineutype) {

        /* "optneuosc.pyx":217
 *                 else:
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])*E_bin_width[ini]/fam_factor
 *             elif ineutype == 1 :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 DM_pdf_array = DM_pdf_table[iineu*2+1]
 *                 if E_nu_in + E_bin_width[ini] > DMm_GeV :
 */
        case 1:
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line218")'> 218:                 DM_pdf_array = DM_pdf_table[iineu*2+1]</pre>
<pre id='line218' class='code' style='background-color: #FFFFc4'>
        /* "optneuosc.pyx":218
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])*E_bin_width[ini]/fam_factor
 *             elif ineutype == 1 :
 *                 DM_pdf_array = DM_pdf_table[iineu*2+1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if E_nu_in + E_bin_width[ini] > DMm_GeV :
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])*(DMm_GeV-E_nu_list[ini])/fam_factor
 */
        __pyx_t_9 = ((__pyx_v_iineu * 2) + 1);
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_DM_pdf_table, __pyx_t_9, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_DM_pdf_array);
        __pyx_v_DM_pdf_array = __pyx_t_13;
        __pyx_t_13 = 0;
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line219")'> 219:                 if E_nu_in + E_bin_width[ini] &gt; DMm_GeV :</pre>
<pre id='line219' class='code' style='background-color: #FFFF3c'>
        /* "optneuosc.pyx":219
 *             elif ineutype == 1 :
 *                 DM_pdf_array = DM_pdf_table[iineu*2+1]
 *                 if E_nu_in + E_bin_width[ini] > DMm_GeV :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])*(DMm_GeV-E_nu_list[ini])/fam_factor
 *                 else :
 */
        __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_nu_in);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_bin_width, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_13, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_DMm_GeV);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
        __pyx_t_13 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_10, __pyx_t_4, Py_GT);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_6 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_13);<span class='error_goto'> if (unlikely(__pyx_t_6 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line220")'> 220:                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])*(DMm_GeV-E_nu_list[ini])/fam_factor</pre>
<pre id='line220' class='code' style='background-color: #FFFF2a'>
          /* "optneuosc.pyx":220
 *                 DM_pdf_array = DM_pdf_table[iineu*2+1]
 *                 if E_nu_in + E_bin_width[ini] > DMm_GeV :
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])*(DMm_GeV-E_nu_list[ini])/fam_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else :
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])*E_bin_width[ini]/fam_factor
 */
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_anu_bin, __pyx_v_ii, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 6, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_DM_pdf_array, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_DMm_GeV);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_nu_list, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          __pyx_t_11 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_10, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          __pyx_t_11 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_4, __pyx_v_fam_factor);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_13, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_E_anu_bin, __pyx_v_ii, __pyx_t_4, sizeof(int), PyInt_FromLong) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          goto __pyx_L7;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line221")'> 221:                 else :</pre>
<pre id='line221' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line222")'> 222:                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])*E_bin_width[ini]/fam_factor</pre>
<pre id='line222' class='code' style='background-color: #FFFF34'>
          /* "optneuosc.pyx":222
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])*(DMm_GeV-E_nu_list[ini])/fam_factor
 *                 else :
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])*E_bin_width[ini]/fam_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return [E_nu_bin,E_anu_bin]
 */
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_anu_bin, __pyx_v_ii, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 6, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_DM_pdf_array, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_11, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_bin_width, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          __pyx_t_13 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_11, __pyx_v_fam_factor);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_E_anu_bin, __pyx_v_ii, __pyx_t_11, sizeof(int), PyInt_FromLong) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        }
        __pyx_L7:;
        break;
      }
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line223")'> 223: </pre>
<pre id='line223' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line224")'> 224:     return [E_nu_bin,E_anu_bin]</pre>
<pre id='line224' class='code' style='background-color: #FFFF4d'>
  /* "optneuosc.pyx":224
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])*E_bin_width[ini]/fam_factor
 * 
 *     return [E_nu_bin,E_anu_bin]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef DMEvtProcess_Fluxv2(E_nu_bin,E_anu_bin,E_nu_list,E_bin_width,events,DM_pdf_table,double E_nu_list_0,double log_E_bin_ratio,double DMm_GeV,E_in_GeV,fam_num,ineu):
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_nu_bin);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_E_nu_bin);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_nu_bin);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_anu_bin);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_E_anu_bin);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_anu_bin);
  __pyx_r = ((PyObject *)__pyx_t_3);
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.DMEvtProcessv2");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_fam_factor);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_DM_pdf_array);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line225")'> 225: </pre>
<pre id='line225' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF0a' onclick='toggleDiv("line226")'> 226: cpdef DMEvtProcess_Fluxv2(E_nu_bin,E_anu_bin,E_nu_list,E_bin_width,events,DM_pdf_table,double E_nu_list_0,double log_E_bin_ratio,double DMm_GeV,E_in_GeV,fam_num,ineu):</pre>
<pre id='line226' class='code' style='background-color: #FFFF0a'>
/* "optneuosc.pyx":226
 *     return [E_nu_bin,E_anu_bin]
 * 
 * cpdef DMEvtProcess_Fluxv2(E_nu_bin,E_anu_bin,E_nu_list,E_bin_width,events,DM_pdf_table,double E_nu_list_0,double log_E_bin_ratio,double DMm_GeV,E_in_GeV,fam_num,ineu):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i,ii,jj,ini,iineu,ineutype,family
 *     cdef double E_nu_in,E_nu_out
 */

static PyObject *__pyx_pf_9optneuosc_10DMEvtProcess_Fluxv2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_DMEvtProcess_Fluxv2(PyObject *__pyx_v_E_nu_bin, PyObject *__pyx_v_E_anu_bin, PyObject *__pyx_v_E_nu_list, PyObject *__pyx_v_E_bin_width, PyObject *__pyx_v_events, PyObject *__pyx_v_DM_pdf_table, double __pyx_v_E_nu_list_0, double __pyx_v_log_E_bin_ratio, double __pyx_v_DMm_GeV, PyObject *__pyx_v_E_in_GeV, PyObject *__pyx_v_fam_num, PyObject *__pyx_v_ineu, int __pyx_skip_dispatch) {
  int __pyx_v_i;
  int __pyx_v_ii;
  int __pyx_v_ini;
  int __pyx_v_iineu;
  int __pyx_v_ineutype;
  int __pyx_v_family;
  double __pyx_v_E_nu_in;
  double __pyx_v_E_nu_out;
  double __pyx_v_eps;
  PyObject *__pyx_v_e;
  PyObject *__pyx_v_fam_factor;
  PyObject *__pyx_v_ini_evt_energy;
  PyObject *__pyx_v_DM_pdf_array;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("DMEvtProcess_Fluxv2");
  __pyx_v_e = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_fam_factor = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_ini_evt_energy = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_DM_pdf_array = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":226
 *     return [E_nu_bin,E_anu_bin]
 * 
 * cpdef DMEvtProcess_Fluxv2(E_nu_bin,E_anu_bin,E_nu_list,E_bin_width,events,DM_pdf_table,double E_nu_list_0,double log_E_bin_ratio,double DMm_GeV,E_in_GeV,fam_num,ineu):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef int i,ii,jj,ini,iineu,ineutype,family
 *     cdef double E_nu_in,E_nu_out
 */

static PyObject *__pyx_pf_9optneuosc_10DMEvtProcess_Fluxv2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_9optneuosc_10DMEvtProcess_Fluxv2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_E_nu_bin = 0;
  PyObject *__pyx_v_E_anu_bin = 0;
  PyObject *__pyx_v_E_nu_list = 0;
  PyObject *__pyx_v_E_bin_width = 0;
  PyObject *__pyx_v_events = 0;
  PyObject *__pyx_v_DM_pdf_table = 0;
  double __pyx_v_E_nu_list_0;
  double __pyx_v_log_E_bin_ratio;
  double __pyx_v_DMm_GeV;
  PyObject *__pyx_v_E_in_GeV = 0;
  PyObject *__pyx_v_fam_num = 0;
  PyObject *__pyx_v_ineu = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__E_nu_bin,&__pyx_n_s__E_anu_bin,&__pyx_n_s__E_nu_list,&__pyx_n_s__E_bin_width,&__pyx_n_s__events,&__pyx_n_s__DM_pdf_table,&__pyx_n_s__E_nu_list_0,&__pyx_n_s__log_E_bin_ratio,&__pyx_n_s__DMm_GeV,&__pyx_n_s__E_in_GeV,&__pyx_n_s__fam_num,&__pyx_n_s__ineu,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("DMEvtProcess_Fluxv2");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
      case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_nu_bin);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_anu_bin);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  2:
      values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_nu_list);
      if (likely(values[2])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  3:
      values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_bin_width);
      if (likely(values[3])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  4:
      values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__events);
      if (likely(values[4])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  5:
      values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__DM_pdf_table);
      if (likely(values[5])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, 5);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  6:
      values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_nu_list_0);
      if (likely(values[6])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, 6);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  7:
      values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__log_E_bin_ratio);
      if (likely(values[7])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, 7);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  8:
      values[8] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__DMm_GeV);
      if (likely(values[8])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, 8);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  9:
      values[9] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_in_GeV);
      if (likely(values[9])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, 9);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case 10:
      values[10] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__fam_num);
      if (likely(values[10])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, 10);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case 11:
      values[11] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ineu);
      if (likely(values[11])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, 11);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "DMEvtProcess_Fluxv2") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_E_nu_bin = values[0];
    __pyx_v_E_anu_bin = values[1];
    __pyx_v_E_nu_list = values[2];
    __pyx_v_E_bin_width = values[3];
    __pyx_v_events = values[4];
    __pyx_v_DM_pdf_table = values[5];
    __pyx_v_E_nu_list_0 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]);<span class='error_goto'> if (unlikely((__pyx_v_E_nu_list_0 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_log_E_bin_ratio = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[7]);<span class='error_goto'> if (unlikely((__pyx_v_log_E_bin_ratio == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_DMm_GeV = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[8]);<span class='error_goto'> if (unlikely((__pyx_v_DMm_GeV == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_E_in_GeV = values[9];
    __pyx_v_fam_num = values[10];
    __pyx_v_ineu = values[11];
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 12) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_E_nu_bin = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    __pyx_v_E_anu_bin = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    __pyx_v_E_nu_list = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    __pyx_v_E_bin_width = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    __pyx_v_events = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    __pyx_v_DM_pdf_table = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    __pyx_v_E_nu_list_0 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6));<span class='error_goto'> if (unlikely((__pyx_v_E_nu_list_0 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_log_E_bin_ratio = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7));<span class='error_goto'> if (unlikely((__pyx_v_log_E_bin_ratio == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_DMm_GeV = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8));<span class='error_goto'> if (unlikely((__pyx_v_DMm_GeV == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_E_in_GeV = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
    __pyx_v_fam_num = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
    __pyx_v_ineu = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("DMEvtProcess_Fluxv2", 1, 12, 12, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.DMEvtProcess_Fluxv2");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_E_nu_bin;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_E_anu_bin;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_v_E_nu_list;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_v_E_bin_width;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  __pyx_t_5 = __pyx_v_events;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
  __pyx_t_6 = __pyx_v_DM_pdf_table;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
  __pyx_t_7 = __pyx_v_E_nu_list_0;
  __pyx_t_8 = __pyx_v_log_E_bin_ratio;
  __pyx_t_9 = __pyx_v_DMm_GeV;
  __pyx_t_10 = __pyx_v_E_in_GeV;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
  __pyx_t_11 = __pyx_v_fam_num;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
  __pyx_t_12 = __pyx_v_ineu;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
  __pyx_t_13 = __pyx_f_9optneuosc_DMEvtProcess_Fluxv2(__pyx_t_1, __pyx_t_2, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12, 0);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_r = __pyx_t_13;
  __pyx_t_13 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.DMEvtProcess_Fluxv2");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line227")'> 227:     cdef int i,ii,jj,ini,iineu,ineutype,family</pre>
<pre id='line227' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line228")'> 228:     cdef double E_nu_in,E_nu_out</pre>
<pre id='line228' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line229")'> 229: </pre>
<pre id='line229' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line230")'> 230:     cdef double eps</pre>
<pre id='line230' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line231")'> 231: </pre>
<pre id='line231' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line232")'> 232:     eps = 1.0e-4</pre>
<pre id='line232' class='code' style='background-color: #FFFFff'>
  /* "optneuosc.pyx":232
 *     cdef double eps
 * 
 *     eps = 1.0e-4             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     for i,e in enumerate(events):
 */
  __pyx_v_eps = 1.0e-4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line233")'> 233: </pre>
<pre id='line233' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF30' onclick='toggleDiv("line234")'> 234:     for i,e in enumerate(events):</pre>
<pre id='line234' class='code' style='background-color: #FFFF30'>
  /* "optneuosc.pyx":234
 *     eps = 1.0e-4
 * 
 *     for i,e in enumerate(events):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if len(e) > 5:
 */
  __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_events) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_events)) {
    __pyx_t_2 = 0; __pyx_t_3 = __pyx_v_events; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_events);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  }
  for (;;) {
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;
    } else if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) {
      if (__pyx_t_2 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;
    } else {
      __pyx_t_4 = <span class='py_c_api'>PyIter_Next</span>(__pyx_t_3);
      if (!__pyx_t_4) {
        if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>()))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e);
    __pyx_v_e = __pyx_t_4;
    __pyx_t_4 = 0;
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = (__pyx_t_1 + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line235")'> 235: </pre>
<pre id='line235' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line236")'> 236:         if len(e) &gt; 5:</pre>
<pre id='line236' class='code' style='background-color: #FFFFaa'>
    /* "optneuosc.pyx":236
 *     for i,e in enumerate(events):
 * 
 *         if len(e) > 5:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             family = e[0]
 *             iineu = e[1]
 */
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_e);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = (__pyx_t_5 > 5);
    if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line237")'> 237:             family = e[0]</pre>
<pre id='line237' class='code' style='background-color: #FFFF6e'>
      /* "optneuosc.pyx":237
 * 
 *         if len(e) > 5:
 *             family = e[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             iineu = e[1]
 *             ineutype = e[2]
 */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_family = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line238")'> 238:             iineu = e[1]</pre>
<pre id='line238' class='code' style='background-color: #FFFF6e'>
      /* "optneuosc.pyx":238
 *         if len(e) > 5:
 *             family = e[0]
 *             iineu = e[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ineutype = e[2]
 *             E_nu_in  = e[3]
 */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 1, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_iineu = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line239")'> 239:             ineutype = e[2]</pre>
<pre id='line239' class='code' style='background-color: #FFFF6e'>
      /* "optneuosc.pyx":239
 *             family = e[0]
 *             iineu = e[1]
 *             ineutype = e[2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             E_nu_in  = e[3]
 *             E_nu_out = e[4]
 */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_ineutype = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line240")'> 240:             E_nu_in  = e[3]</pre>
<pre id='line240' class='code' style='background-color: #FFFF6e'>
      /* "optneuosc.pyx":240
 *             iineu = e[1]
 *             ineutype = e[2]
 *             E_nu_in  = e[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             E_nu_out = e[4]
 * 
 */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 3, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_E_nu_in = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line241")'> 241:             E_nu_out = e[4]</pre>
<pre id='line241' class='code' style='background-color: #FFFF6e'>
      /* "optneuosc.pyx":241
 *             ineutype = e[2]
 *             E_nu_in  = e[3]
 *             E_nu_out = e[4]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * 
 */
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 4, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_E_nu_out = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line242")'> 242: </pre>
<pre id='line242' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line243")'> 243: </pre>
<pre id='line243' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line244")'> 244:             fam_factor = fam_num[family-1]</pre>
<pre id='line244' class='code' style='background-color: #FFFFc4'>
      /* "optneuosc.pyx":244
 * 
 * 
 *             fam_factor = fam_num[family-1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ini_evt_energy = E_in_GeV
 * 
 */
      __pyx_t_9 = (__pyx_v_family - 1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_fam_num, __pyx_t_9, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_fam_factor);
      __pyx_v_fam_factor = __pyx_t_4;
      __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line245")'> 245:             ini_evt_energy = E_in_GeV</pre>
<pre id='line245' class='code' style='background-color: #FFFFd4'>
      /* "optneuosc.pyx":245
 * 
 *             fam_factor = fam_num[family-1]
 *             ini_evt_energy = E_in_GeV             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             iineu = ineu
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_in_GeV);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_ini_evt_energy);
      __pyx_v_ini_evt_energy = __pyx_v_E_in_GeV;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line246")'> 246: </pre>
<pre id='line246' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line247")'> 247:             iineu = ineu</pre>
<pre id='line247' class='code' style='background-color: #FFFF7f'>
      /* "optneuosc.pyx":247
 *             ini_evt_energy = E_in_GeV
 * 
 *             iineu = ineu             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             ii = int(log(E_nu_out/E_nu_list_0)/log_E_bin_ratio+eps)
 */
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_v_ineu);<span class='error_goto'> if (unlikely((__pyx_t_7 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_v_iineu = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line248")'> 248: </pre>
<pre id='line248' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line249")'> 249:             ii = int(log(E_nu_out/E_nu_list_0)/log_E_bin_ratio+eps)</pre>
<pre id='line249' class='code' style='background-color: #FFFF7f'>
      /* "optneuosc.pyx":249
 *             iineu = ineu
 * 
 *             ii = int(log(E_nu_out/E_nu_list_0)/log_E_bin_ratio+eps)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             ini = int(log(ini_evt_energy/E_nu_list_0)/log_E_bin_ratio+eps)
 * 
 */
      if (unlikely(__pyx_v_E_nu_list_0 == 0)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_8 = log((__pyx_v_E_nu_out / __pyx_v_E_nu_list_0));
      if (unlikely(__pyx_v_log_E_bin_ratio == 0)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_ii = ((int)((__pyx_t_8 / __pyx_v_log_E_bin_ratio) + __pyx_v_eps));
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line250")'> 250:             ini = int(log(ini_evt_energy/E_nu_list_0)/log_E_bin_ratio+eps)</pre>
<pre id='line250' class='code' style='background-color: #FFFF44'>
      /* "optneuosc.pyx":250
 * 
 *             ii = int(log(E_nu_out/E_nu_list_0)/log_E_bin_ratio+eps)
 *             ini = int(log(ini_evt_energy/E_nu_list_0)/log_E_bin_ratio+eps)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             if ini != ii :
 */
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_nu_list_0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
      __pyx_t_10 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_ini_evt_energy, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_10);<span class='error_goto'> if (unlikely((__pyx_t_8 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_11 = log(__pyx_t_8);
      if (unlikely(__pyx_v_log_E_bin_ratio == 0)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_ZeroDivisionError, "float division");
       <span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_ini = ((int)((__pyx_t_11 / __pyx_v_log_E_bin_ratio) + __pyx_v_eps));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line251")'> 251: </pre>
<pre id='line251' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line252")'> 252:             if ini != ii :</pre>
<pre id='line252' class='code' style='background-color: #FFFFff'>
      /* "optneuosc.pyx":252
 *             ini = int(log(ini_evt_energy/E_nu_list_0)/log_E_bin_ratio+eps)
 * 
 *             if ini != ii :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 ii = ini
 *                 if ineutype == 0:
 */
      __pyx_t_6 = (__pyx_v_ini != __pyx_v_ii);
      if (__pyx_t_6) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line253")'> 253:                 ii = ini</pre>
<pre id='line253' class='code' style='background-color: #FFFFff'>
        /* "optneuosc.pyx":253
 * 
 *             if ini != ii :
 *                 ii = ini             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if ineutype == 0:
 *                     DM_pdf_array = DM_pdf_table[iineu*2]
 */
        __pyx_v_ii = __pyx_v_ini;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line254")'> 254:                 if ineutype == 0:</pre>
<pre id='line254' class='code' style='background-color: #FFFFff'>
          /* "optneuosc.pyx":254
 *             if ini != ii :
 *                 ii = ini
 *                 if ineutype == 0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     DM_pdf_array = DM_pdf_table[iineu*2]
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])/fam_factor
 */
          case 0:
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line255")'> 255:                     DM_pdf_array = DM_pdf_table[iineu*2]</pre>
<pre id='line255' class='code' style='background-color: #FFFFc4'>
          /* "optneuosc.pyx":255
 *                 ii = ini
 *                 if ineutype == 0:
 *                     DM_pdf_array = DM_pdf_table[iineu*2]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])/fam_factor
 *                 elif ineutype == 1 :
 */
          __pyx_t_9 = (__pyx_v_iineu * 2);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_DM_pdf_table, __pyx_t_9, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_DM_pdf_array);
          __pyx_v_DM_pdf_array = __pyx_t_10;
          __pyx_t_10 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line256")'> 256:                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])/fam_factor</pre>
<pre id='line256' class='code' style='background-color: #FFFF41'>
          /* "optneuosc.pyx":256
 *                 if ineutype == 0:
 *                     DM_pdf_array = DM_pdf_table[iineu*2]
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])/fam_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 elif ineutype == 1 :
 *                     DM_pdf_array = DM_pdf_table[iineu*2+1]
 */
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_nu_bin, __pyx_v_ii, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 6, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_DM_pdf_array, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_12 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_13, __pyx_v_fam_factor);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_E_nu_bin, __pyx_v_ii, __pyx_t_13, sizeof(int), PyInt_FromLong) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line257")'> 257:                 elif ineutype == 1 :</pre>
<pre id='line257' class='code' style='background-color: #FFFFff'>
        /* "optneuosc.pyx":257
 *                     DM_pdf_array = DM_pdf_table[iineu*2]
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])/fam_factor
 *                 elif ineutype == 1 :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     DM_pdf_array = DM_pdf_table[iineu*2+1]
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])/fam_factor
 */
        switch (__pyx_v_ineutype) {

          /* "optneuosc.pyx":257
 *                     DM_pdf_array = DM_pdf_table[iineu*2]
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])/fam_factor
 *                 elif ineutype == 1 :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     DM_pdf_array = DM_pdf_table[iineu*2+1]
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])/fam_factor
 */
          case 1:
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line258")'> 258:                     DM_pdf_array = DM_pdf_table[iineu*2+1]</pre>
<pre id='line258' class='code' style='background-color: #FFFFc4'>
          /* "optneuosc.pyx":258
 *                     E_nu_bin[ii]  = E_nu_bin[ii]  + e[6]*(DM_pdf_array[ini])/fam_factor
 *                 elif ineutype == 1 :
 *                     DM_pdf_array = DM_pdf_table[iineu*2+1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])/fam_factor
 * 
 */
          __pyx_t_9 = ((__pyx_v_iineu * 2) + 1);
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_DM_pdf_table, __pyx_t_9, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_DM_pdf_array);
          __pyx_v_DM_pdf_array = __pyx_t_13;
          __pyx_t_13 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line259")'> 259:                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])/fam_factor</pre>
<pre id='line259' class='code' style='background-color: #FFFF3f'>
          /* "optneuosc.pyx":259
 *                 elif ineutype == 1 :
 *                     DM_pdf_array = DM_pdf_table[iineu*2+1]
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])/fam_factor             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     return [E_nu_bin,E_anu_bin]
 */
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_E_anu_bin, __pyx_v_ii, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_13);
          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_e, 6, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_12);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_DM_pdf_array, __pyx_v_ini, sizeof(int), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_t_10 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_4, __pyx_v_fam_factor);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_13, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          if (<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_E_anu_bin, __pyx_v_ii, __pyx_t_4, sizeof(int), PyInt_FromLong) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          break;
        }
        goto __pyx_L6;
      }
      __pyx_L6:;
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line260")'> 260: </pre>
<pre id='line260' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line261")'> 261:     return [E_nu_bin,E_anu_bin]</pre>
<pre id='line261' class='code' style='background-color: #FFFF4d'>
  /* "optneuosc.pyx":261
 *                     E_anu_bin[ii] = E_anu_bin[ii] + e[6]*(DM_pdf_array[ini])/fam_factor
 * 
 *     return [E_nu_bin,E_anu_bin]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * #===============================================================================
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_nu_bin);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_E_nu_bin);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_nu_bin);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_anu_bin);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_E_anu_bin);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_anu_bin);
  __pyx_r = ((PyObject *)__pyx_t_3);
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.DMEvtProcess_Fluxv2");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_fam_factor);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_ini_evt_energy);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_DM_pdf_array);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line262")'> 262: </pre>
<pre id='line262' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line263")'> 263: #===============================================================================</pre>
<pre id='line263' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line264")'> 264: # Neu Osc Rediagonalizing Calculation - Cython</pre>
<pre id='line264' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line265")'> 265: #===============================================================================</pre>
<pre id='line265' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line266")'> 266: </pre>
<pre id='line266' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line267")'> 267: cpdef RHS_INT_GSL(double x,neuvec,params):</pre>
<pre id='line267' class='code' style='background-color: #FFFF19'>
/* "optneuosc.pyx":267
 * #===============================================================================
 * 
 * cpdef RHS_INT_GSL(double x,neuvec,params):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef complex ii
 *     ii = complex(0.0,1.0)
 */

static PyObject *__pyx_pf_9optneuosc_11RHS_INT_GSL(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_RHS_INT_GSL(double __pyx_v_x, PyObject *__pyx_v_neuvec, PyObject *__pyx_v_params, int __pyx_skip_dispatch) {
  __pyx_t_double_complex __pyx_v_ii;
  PyObject *__pyx_v_track;
  PyObject *__pyx_v_param;
  PyObject *__pyx_v_flavorM2;
  PyObject *__pyx_v_body;
  PyObject *__pyx_v_E;
  PyObject *__pyx_v_H0;
  PyObject *__pyx_v_x_prev;
  double __pyx_v_x_current;
  PyObject *__pyx_v_H_current;
  PyObject *__pyx_v_H1;
  PyObject *__pyx_v_S;
  PyObject *__pyx_v_interaction_H;
  PyObject *__pyx_v_rhs_int;
  PyObject *__pyx_v_rhs;
  PyObject *__pyx_v_tmprhs;
  PyObject *__pyx_v_val;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("RHS_INT_GSL");
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_neuvec);
  __pyx_v_track = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_param = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_flavorM2 = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_body = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_E = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_H0 = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_x_prev = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_H_current = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_H1 = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_S = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_interaction_H = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_rhs_int = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_rhs = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_tmprhs = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_val = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":267
 * #===============================================================================
 * 
 * cpdef RHS_INT_GSL(double x,neuvec,params):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     cdef complex ii
 *     ii = complex(0.0,1.0)
 */

static PyObject *__pyx_pf_9optneuosc_11RHS_INT_GSL(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_9optneuosc_11RHS_INT_GSL(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_x;
  PyObject *__pyx_v_neuvec = 0;
  PyObject *__pyx_v_params = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__neuvec,&__pyx_n_s__params,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("RHS_INT_GSL");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[3] = {0,0,0};
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__x);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__neuvec);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS_INT_GSL", 1, 3, 3, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  2:
      values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__params);
      if (likely(values[2])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS_INT_GSL", 1, 3, 3, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "RHS_INT_GSL") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_x = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_x == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_neuvec = values[1];
    __pyx_v_params = values[2];
  } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_x = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0));<span class='error_goto'> if (unlikely((__pyx_v_x == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_neuvec = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    __pyx_v_params = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("RHS_INT_GSL", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.RHS_INT_GSL");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_x;
  __pyx_t_2 = __pyx_v_neuvec;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_v_params;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_f_9optneuosc_RHS_INT_GSL(__pyx_t_1, __pyx_t_2, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.RHS_INT_GSL");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line268")'> 268:     cdef complex ii</pre>
<pre id='line268' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line269")'> 269:     ii = complex(0.0,1.0)</pre>
<pre id='line269' class='code' style='background-color: #FFFF39'>
  /* "optneuosc.pyx":269
 * cpdef RHS_INT_GSL(double x,neuvec,params):
 *     cdef complex ii
 *     ii = complex(0.0,1.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     track,param,flavorM2,body,E,H0 = params.track,params.param,params.flavorM2,params.body,params.E,params.H0
 * 
 */
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyComplex_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyComplex_As___pyx_t_double_complex</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ii = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line270")'> 270:     track,param,flavorM2,body,E,H0 = params.track,params.param,params.flavorM2,params.body,params.E,params.H0</pre>
<pre id='line270' class='code' style='background-color: #FFFF37'>
  /* "optneuosc.pyx":270
 *     cdef complex ii
 *     ii = complex(0.0,1.0)
 *     track,param,flavorM2,body,E,H0 = params.track,params.param,params.flavorM2,params.body,params.E,params.H0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # Right hand side in Schrodinger's equations in the interaction basis
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__track);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__param);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__flavorM2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__body);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__E);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__H0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_track);
  __pyx_v_track = __pyx_t_2;
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_param);
  __pyx_v_param = __pyx_t_3;
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_flavorM2);
  __pyx_v_flavorM2 = __pyx_t_1;
  __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_body);
  __pyx_v_body = __pyx_t_5;
  __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_E);
  __pyx_v_E = __pyx_t_6;
  __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_H0);
  __pyx_v_H0 = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line271")'> 271: </pre>
<pre id='line271' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line272")'> 272:     # Right hand side in Schrodinger's equations in the interaction basis</pre>
<pre id='line272' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line273")'> 273: </pre>
<pre id='line273' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line274")'> 274:     # moving around</pre>
<pre id='line274' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line275")'> 275:     x_prev      = params.rpos</pre>
<pre id='line275' class='code' style='background-color: #FFFF9f'>
  /* "optneuosc.pyx":275
 * 
 *     # moving around
 *     x_prev      = params.rpos             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     x_current   = x
 *     track.x = x_current
 */
  __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_params, __pyx_n_s__rpos);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_x_prev);
  __pyx_v_x_prev = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line276")'> 276:     x_current   = x</pre>
<pre id='line276' class='code' style='background-color: #FFFFff'>
  /* "optneuosc.pyx":276
 *     # moving around
 *     x_prev      = params.rpos
 *     x_current   = x             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     track.x = x_current
 * 
 */
  __pyx_v_x_current = __pyx_v_x;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line277")'> 277:     track.x = x_current</pre>
<pre id='line277' class='code' style='background-color: #FFFF79'>
  /* "optneuosc.pyx":277
 *     x_prev      = params.rpos
 *     x_current   = x
 *     track.x = x_current             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     ## this should be done in complex plane -- TMP
 */
  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_x_current);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_v_track, __pyx_n_s__x, __pyx_t_7) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line278")'> 278: </pre>
<pre id='line278' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line279")'> 279:     ## this should be done in complex plane -- TMP</pre>
<pre id='line279' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line280")'> 280:     neuvec = cvec(neuvec,param)</pre>
<pre id='line280' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":280
 * 
 *     ## this should be done in complex plane -- TMP
 *     neuvec = cvec(neuvec,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # Decompose the Hamiltonian H = H0 + H1
 */
  __pyx_t_7 = __pyx_v_neuvec;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
  __pyx_t_6 = __pyx_f_9optneuosc_cvec(__pyx_t_7, __pyx_v_param, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neuvec);
  __pyx_v_neuvec = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line281")'> 281: </pre>
<pre id='line281' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line282")'> 282:     # Decompose the Hamiltonian H = H0 + H1</pre>
<pre id='line282' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line283")'> 283:     # where :</pre>
<pre id='line283' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line284")'> 284:     #       H0 = H_(r_i)</pre>
<pre id='line284' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line285")'> 285:     #       H1 = H_(r_i+1) - H_(r_i)</pre>
<pre id='line285' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line286")'> 286: </pre>
<pre id='line286' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line287")'> 287:     H_current = ii*flavorH(track,param,flavorM2,body,E)</pre>
<pre id='line287' class='code' style='background-color: #FFFF6e'>
  /* "optneuosc.pyx":287
 *     #       H1 = H_(r_i+1) - H_(r_i)
 * 
 *     H_current = ii*flavorH(track,param,flavorM2,body,E)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     H1 = H_current - H0
 * 
 */
  __pyx_t_6 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_ii);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_6));
  __pyx_t_7 = __pyx_f_9optneuosc_flavorH(__pyx_v_track, __pyx_v_param, __pyx_v_flavorM2, __pyx_v_body, __pyx_v_E, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_t_6), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_H_current);
  __pyx_v_H_current = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line288")'> 288:     H1 = H_current - H0</pre>
<pre id='line288' class='code' style='background-color: #FFFF9f'>
  /* "optneuosc.pyx":288
 * 
 *     H_current = ii*flavorH(track,param,flavorM2,body,E)
 *     H1 = H_current - H0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # opt -> store S
 */
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_H_current, __pyx_v_H0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_H1);
  __pyx_v_H1 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line289")'> 289: </pre>
<pre id='line289' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line290")'> 290:     # opt -&gt; store S</pre>
<pre id='line290' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line291")'> 291:     #S = S#expm2(-ii*H0*(x_current - x_prev))</pre>
<pre id='line291' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line292")'> 292:     S = expm2(-ii*H0*(x_current - x_prev))</pre>
<pre id='line292' class='code' style='background-color: #FFFF2e'>
  /* "optneuosc.pyx":292
 *     # opt -> store S
 *     #S = S#expm2(-ii*H0*(x_current - x_prev))
 *     S = expm2(-ii*H0*(x_current - x_prev))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     interaction_H = dot(S,dot(H1,S.conjugate().T))
 */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__expm2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_7 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__Pyx_c_neg(__pyx_v_ii));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_t_7), __pyx_v_H0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_x_current);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_7, __pyx_v_x_prev);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_t_1), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_S);
  __pyx_v_S = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line293")'> 293: </pre>
<pre id='line293' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line294")'> 294:     interaction_H = dot(S,dot(H1,S.conjugate().T))</pre>
<pre id='line294' class='code' style='background-color: #FFFF29'>
  /* "optneuosc.pyx":294
 *     S = expm2(-ii*H0*(x_current - x_prev))
 * 
 *     interaction_H = dot(S,dot(H1,S.conjugate().T))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     rhs_int = (-ii)*interaction_H
 */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__dot);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__dot);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_S, __pyx_n_s__conjugate);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_5, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_6, __pyx_n_s__T);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_6));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_H1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_H1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_H1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_6));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_S);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_S);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_7, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_interaction_H);
  __pyx_v_interaction_H = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line295")'> 295: </pre>
<pre id='line295' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line296")'> 296:     rhs_int = (-ii)*interaction_H</pre>
<pre id='line296' class='code' style='background-color: #FFFF73'>
  /* "optneuosc.pyx":296
 *     interaction_H = dot(S,dot(H1,S.conjugate().T))
 * 
 *     rhs_int = (-ii)*interaction_H             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     rhs = dot(rhs_int,neuvec)
 */
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__Pyx_c_neg(__pyx_v_ii));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_5));
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_t_5), __pyx_v_interaction_H);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_rhs_int);
  __pyx_v_rhs_int = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line297")'> 297: </pre>
<pre id='line297' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line298")'> 298:     rhs = dot(rhs_int,neuvec)</pre>
<pre id='line298' class='code' style='background-color: #FFFF57'>
  /* "optneuosc.pyx":298
 *     rhs_int = (-ii)*interaction_H
 * 
 *     rhs = dot(rhs_int,neuvec)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()
 * 
 */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__dot);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_5));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rhs_int);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_rhs_int);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_rhs_int);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_neuvec);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_neuvec);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_neuvec);
  __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_t_5), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_rhs);
  __pyx_v_rhs = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFF15' onclick='toggleDiv("line299")'> 299:     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()</pre>
<pre id='line299' class='code' style='background-color: #FFFF15'>
  /* "optneuosc.pyx":299
 * 
 *     rhs = dot(rhs_int,neuvec)
 *     tmprhs = (array([[val[0].real,val[0].imag] for val in rhs])).flatten()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     #storing stuff
 */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__array);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_5));
  if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_rhs) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_rhs)) {
    __pyx_t_8 = 0; __pyx_t_6 = __pyx_v_rhs; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
  } else {
    __pyx_t_8 = -1; __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_rhs);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  }
  for (;;) {
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6))) {
      if (__pyx_t_8 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_6)) break;
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_6, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8++;
    } else if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_6))) {
      if (__pyx_t_8 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_6)) break;
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_6, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8++;
    } else {
      __pyx_t_1 = <span class='py_c_api'>PyIter_Next</span>(__pyx_t_6);
      if (!__pyx_t_1) {
        if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>()))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        break;
      }
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_val);
    __pyx_v_val = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_val, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__real);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_val, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_1, __pyx_n_s__imag);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_1));
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    __pyx_t_3 = 0;
    __pyx_t_2 = 0;
    if (unlikely(<span class='py_c_api'>PyList_Append</span>(__pyx_t_5, (PyObject*)__pyx_t_1)))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_6));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_t_5));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, ((PyObject *)__pyx_t_5));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_t_5));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_7, ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_5, __pyx_n_s__flatten);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_6, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_tmprhs);
  __pyx_v_tmprhs = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line300")'> 300: </pre>
<pre id='line300' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line301")'> 301:     #storing stuff</pre>
<pre id='line301' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line302")'> 302:     params.cH = H_current</pre>
<pre id='line302' class='code' style='background-color: #FFFFaa'>
  /* "optneuosc.pyx":302
 * 
 *     #storing stuff
 *     params.cH = H_current             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     params.cS = S
 *     return tmprhs
 */
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_v_params, __pyx_n_s__cH, __pyx_v_H_current) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line303")'> 303:     params.cS = S</pre>
<pre id='line303' class='code' style='background-color: #FFFFaa'>
  /* "optneuosc.pyx":303
 *     #storing stuff
 *     params.cH = H_current
 *     params.cS = S             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     return tmprhs
 * 
 */
  if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_v_params, __pyx_n_s__cS, __pyx_v_S) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line304")'> 304:     return tmprhs</pre>
<pre id='line304' class='code' style='background-color: #FFFF43'>
  /* "optneuosc.pyx":304
 *     params.cH = H_current
 *     params.cS = S
 *     return tmprhs             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cdef class ParamsContainer:
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tmprhs);
  __pyx_r = __pyx_v_tmprhs;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.RHS_INT_GSL");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_track);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_param);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_flavorM2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_body);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_E);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_H0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_x_prev);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_H_current);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_H1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_S);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_interaction_H);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_rhs_int);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_rhs);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_tmprhs);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_val);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neuvec);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line305")'> 305: </pre>
<pre id='line305' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line306")'> 306: cdef class ParamsContainer:</pre>
<pre id='line306' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line307")'> 307:     cdef object track,param,flavorM2,body,E,H0,S,rpos,cH,cS</pre>
<pre id='line307' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line308")'> 308: </pre>
<pre id='line308' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line309")'> 309:     property track:</pre>
<pre id='line309' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line310")'> 310:         def __get__(self):</pre>
<pre id='line310' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":310
 * 
 *     property track:
 *         def __get__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return self.track
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_5track___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_5track___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__get__");
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line311")'> 311:             return self.track</pre>
<pre id='line311' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":311
 *     property track:
 *         def __get__(self):
 *             return self.track             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __set__(self,value):
 *             self.track = value
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->track);
  __pyx_r = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->track;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line312")'> 312:         def __set__(self,value):</pre>
<pre id='line312' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":312
 *         def __get__(self):
 *             return self.track
 *         def __set__(self,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.track = value
 *         def __del__(self):
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_5track_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_5track_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__set__");
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line313")'> 313:             self.track = value</pre>
<pre id='line313' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":313
 *             return self.track
 *         def __set__(self,value):
 *             self.track = value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __del__(self):
 *             track = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->track);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->track);
  ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->track = __pyx_v_value;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line314")'> 314:         def __del__(self):</pre>
<pre id='line314' class='code' style='background-color: #FFFFd4'>
/* "optneuosc.pyx":314
 *         def __set__(self,value):
 *             self.track = value
 *         def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             track = None
 * 
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_5track_2__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_5track_2__del__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_track;
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__");
  __pyx_v_track = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line315")'> 315:             track = None</pre>
<pre id='line315' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":315
 *             self.track = value
 *         def __del__(self):
 *             track = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     property param:
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_track);
  __pyx_v_track = Py_None;

  __pyx_r = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_track);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line316")'> 316: </pre>
<pre id='line316' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line317")'> 317:     property param:</pre>
<pre id='line317' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line318")'> 318:         def __get__(self):</pre>
<pre id='line318' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":318
 * 
 *     property param:
 *         def __get__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return self.param
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_5param___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_5param___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__get__");
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line319")'> 319:             return self.param</pre>
<pre id='line319' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":319
 *     property param:
 *         def __get__(self):
 *             return self.param             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __set__(self,value):
 *             self.param = value
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->param);
  __pyx_r = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->param;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line320")'> 320:         def __set__(self,value):</pre>
<pre id='line320' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":320
 *         def __get__(self):
 *             return self.param
 *         def __set__(self,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.param = value
 *         def __del__(self):
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_5param_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_5param_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__set__");
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line321")'> 321:             self.param = value</pre>
<pre id='line321' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":321
 *             return self.param
 *         def __set__(self,value):
 *             self.param = value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __del__(self):
 *             param = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->param);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->param);
  ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->param = __pyx_v_value;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line322")'> 322:         def __del__(self):</pre>
<pre id='line322' class='code' style='background-color: #FFFFd4'>
/* "optneuosc.pyx":322
 *         def __set__(self,value):
 *             self.param = value
 *         def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             param = None
 * 
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_5param_2__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_5param_2__del__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_param;
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__");
  __pyx_v_param = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line323")'> 323:             param = None</pre>
<pre id='line323' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":323
 *             self.param = value
 *         def __del__(self):
 *             param = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     property flavorM2:
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_param);
  __pyx_v_param = Py_None;

  __pyx_r = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_param);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line324")'> 324: </pre>
<pre id='line324' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line325")'> 325:     property flavorM2:</pre>
<pre id='line325' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line326")'> 326:         def __get__(self):</pre>
<pre id='line326' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":326
 * 
 *     property flavorM2:
 *         def __get__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return self.flavorM2
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_8flavorM2___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_8flavorM2___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__get__");
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line327")'> 327:             return self.flavorM2</pre>
<pre id='line327' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":327
 *     property flavorM2:
 *         def __get__(self):
 *             return self.flavorM2             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __set__(self,value):
 *             self.flavorM2 = value
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->flavorM2);
  __pyx_r = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->flavorM2;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line328")'> 328:         def __set__(self,value):</pre>
<pre id='line328' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":328
 *         def __get__(self):
 *             return self.flavorM2
 *         def __set__(self,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.flavorM2 = value
 *         def __del__(self):
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_8flavorM2_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_8flavorM2_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__set__");
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line329")'> 329:             self.flavorM2 = value</pre>
<pre id='line329' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":329
 *             return self.flavorM2
 *         def __set__(self,value):
 *             self.flavorM2 = value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __del__(self):
 *             flavorM2 = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->flavorM2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->flavorM2);
  ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->flavorM2 = __pyx_v_value;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line330")'> 330:         def __del__(self):</pre>
<pre id='line330' class='code' style='background-color: #FFFFd4'>
/* "optneuosc.pyx":330
 *         def __set__(self,value):
 *             self.flavorM2 = value
 *         def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             flavorM2 = None
 * 
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_8flavorM2_2__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_8flavorM2_2__del__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_flavorM2;
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__");
  __pyx_v_flavorM2 = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line331")'> 331:             flavorM2 = None</pre>
<pre id='line331' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":331
 *             self.flavorM2 = value
 *         def __del__(self):
 *             flavorM2 = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     property body:
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_flavorM2);
  __pyx_v_flavorM2 = Py_None;

  __pyx_r = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_flavorM2);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line332")'> 332: </pre>
<pre id='line332' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line333")'> 333:     property body:</pre>
<pre id='line333' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line334")'> 334:         def __get__(self):</pre>
<pre id='line334' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":334
 * 
 *     property body:
 *         def __get__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return self.body
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_4body___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_4body___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__get__");
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line335")'> 335:             return self.body</pre>
<pre id='line335' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":335
 *     property body:
 *         def __get__(self):
 *             return self.body             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __set__(self,value):
 *             self.body = value
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->body);
  __pyx_r = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->body;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line336")'> 336:         def __set__(self,value):</pre>
<pre id='line336' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":336
 *         def __get__(self):
 *             return self.body
 *         def __set__(self,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.body = value
 *         def __del__(self):
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_4body_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_4body_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__set__");
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line337")'> 337:             self.body = value</pre>
<pre id='line337' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":337
 *             return self.body
 *         def __set__(self,value):
 *             self.body = value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __del__(self):
 *             body = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->body);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->body);
  ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->body = __pyx_v_value;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line338")'> 338:         def __del__(self):</pre>
<pre id='line338' class='code' style='background-color: #FFFFd4'>
/* "optneuosc.pyx":338
 *         def __set__(self,value):
 *             self.body = value
 *         def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             body = None
 * 
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_4body_2__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_4body_2__del__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_body;
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__");
  __pyx_v_body = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line339")'> 339:             body = None</pre>
<pre id='line339' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":339
 *             self.body = value
 *         def __del__(self):
 *             body = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     property E:
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_body);
  __pyx_v_body = Py_None;

  __pyx_r = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_body);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line340")'> 340: </pre>
<pre id='line340' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line341")'> 341:     property E:</pre>
<pre id='line341' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line342")'> 342:         def __get__(self):</pre>
<pre id='line342' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":342
 * 
 *     property E:
 *         def __get__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return self.E
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_1E___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_1E___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__get__");
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line343")'> 343:             return self.E</pre>
<pre id='line343' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":343
 *     property E:
 *         def __get__(self):
 *             return self.E             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __set__(self,value):
 *             self.E = value
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->E);
  __pyx_r = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->E;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line344")'> 344:         def __set__(self,value):</pre>
<pre id='line344' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":344
 *         def __get__(self):
 *             return self.E
 *         def __set__(self,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.E = value
 *         def __del__(self):
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_1E_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_1E_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__set__");
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line345")'> 345:             self.E = value</pre>
<pre id='line345' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":345
 *             return self.E
 *         def __set__(self,value):
 *             self.E = value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __del__(self):
 *             E = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->E);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->E);
  ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->E = __pyx_v_value;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line346")'> 346:         def __del__(self):</pre>
<pre id='line346' class='code' style='background-color: #FFFFd4'>
/* "optneuosc.pyx":346
 *         def __set__(self,value):
 *             self.E = value
 *         def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             E = None
 * 
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_1E_2__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_1E_2__del__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_E;
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__");
  __pyx_v_E = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line347")'> 347:             E = None</pre>
<pre id='line347' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":347
 *             self.E = value
 *         def __del__(self):
 *             E = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     property H0:
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_E);
  __pyx_v_E = Py_None;

  __pyx_r = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_E);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line348")'> 348: </pre>
<pre id='line348' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line349")'> 349:     property H0:</pre>
<pre id='line349' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line350")'> 350:         def __get__(self):</pre>
<pre id='line350' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":350
 * 
 *     property H0:
 *         def __get__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return self.H0
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_2H0___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_2H0___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__get__");
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line351")'> 351:             return self.H0</pre>
<pre id='line351' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":351
 *     property H0:
 *         def __get__(self):
 *             return self.H0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __set__(self,value):
 *             self.H0 = value
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->H0);
  __pyx_r = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->H0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line352")'> 352:         def __set__(self,value):</pre>
<pre id='line352' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":352
 *         def __get__(self):
 *             return self.H0
 *         def __set__(self,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.H0 = value
 *         def __del__(self):
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_2H0_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_2H0_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__set__");
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line353")'> 353:             self.H0 = value</pre>
<pre id='line353' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":353
 *             return self.H0
 *         def __set__(self,value):
 *             self.H0 = value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __del__(self):
 *             H0 = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->H0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->H0);
  ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->H0 = __pyx_v_value;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line354")'> 354:         def __del__(self):</pre>
<pre id='line354' class='code' style='background-color: #FFFFd4'>
/* "optneuosc.pyx":354
 *         def __set__(self,value):
 *             self.H0 = value
 *         def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             H0 = None
 * 
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_2H0_2__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_2H0_2__del__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_H0;
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__");
  __pyx_v_H0 = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line355")'> 355:             H0 = None</pre>
<pre id='line355' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":355
 *             self.H0 = value
 *         def __del__(self):
 *             H0 = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     property S:
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_H0);
  __pyx_v_H0 = Py_None;

  __pyx_r = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_H0);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line356")'> 356: </pre>
<pre id='line356' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line357")'> 357:     property S:</pre>
<pre id='line357' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line358")'> 358:         def __get__(self):</pre>
<pre id='line358' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":358
 * 
 *     property S:
 *         def __get__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return self.S
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_1S___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_1S___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__get__");
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line359")'> 359:             return self.S</pre>
<pre id='line359' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":359
 *     property S:
 *         def __get__(self):
 *             return self.S             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __set__(self,value):
 *             self.S = value
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->S);
  __pyx_r = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->S;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line360")'> 360:         def __set__(self,value):</pre>
<pre id='line360' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":360
 *         def __get__(self):
 *             return self.S
 *         def __set__(self,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.S = value
 *         def __del__(self):
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_1S_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_1S_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__set__");
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line361")'> 361:             self.S = value</pre>
<pre id='line361' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":361
 *             return self.S
 *         def __set__(self,value):
 *             self.S = value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __del__(self):
 *             S = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->S);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->S);
  ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->S = __pyx_v_value;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line362")'> 362:         def __del__(self):</pre>
<pre id='line362' class='code' style='background-color: #FFFFd4'>
/* "optneuosc.pyx":362
 *         def __set__(self,value):
 *             self.S = value
 *         def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             S = None
 * 
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_1S_2__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_1S_2__del__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_S;
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__");
  __pyx_v_S = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line363")'> 363:             S = None</pre>
<pre id='line363' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":363
 *             self.S = value
 *         def __del__(self):
 *             S = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     property rpos:
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_S);
  __pyx_v_S = Py_None;

  __pyx_r = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_S);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line364")'> 364: </pre>
<pre id='line364' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line365")'> 365:     property rpos:</pre>
<pre id='line365' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line366")'> 366:         def __get__(self):</pre>
<pre id='line366' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":366
 * 
 *     property rpos:
 *         def __get__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return self.rpos
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_4rpos___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_4rpos___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__get__");
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line367")'> 367:             return self.rpos</pre>
<pre id='line367' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":367
 *     property rpos:
 *         def __get__(self):
 *             return self.rpos             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __set__(self,value):
 *             self.rpos = value
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->rpos);
  __pyx_r = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->rpos;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line368")'> 368:         def __set__(self,value):</pre>
<pre id='line368' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":368
 *         def __get__(self):
 *             return self.rpos
 *         def __set__(self,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.rpos = value
 *         def __del__(self):
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_4rpos_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_4rpos_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__set__");
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line369")'> 369:             self.rpos = value</pre>
<pre id='line369' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":369
 *             return self.rpos
 *         def __set__(self,value):
 *             self.rpos = value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __del__(self):
 *             rpos = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->rpos);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->rpos);
  ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->rpos = __pyx_v_value;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line370")'> 370:         def __del__(self):</pre>
<pre id='line370' class='code' style='background-color: #FFFFd4'>
/* "optneuosc.pyx":370
 *         def __set__(self,value):
 *             self.rpos = value
 *         def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             rpos = None
 * 
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_4rpos_2__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_4rpos_2__del__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_rpos;
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__");
  __pyx_v_rpos = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line371")'> 371:             rpos = None</pre>
<pre id='line371' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":371
 *             self.rpos = value
 *         def __del__(self):
 *             rpos = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     property cH:
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_rpos);
  __pyx_v_rpos = Py_None;

  __pyx_r = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_rpos);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line372")'> 372: </pre>
<pre id='line372' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line373")'> 373:     property cH:</pre>
<pre id='line373' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line374")'> 374:         def __get__(self):</pre>
<pre id='line374' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":374
 * 
 *     property cH:
 *         def __get__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return self.cH
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_2cH___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_2cH___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__get__");
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line375")'> 375:             return self.cH</pre>
<pre id='line375' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":375
 *     property cH:
 *         def __get__(self):
 *             return self.cH             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __set__(self,value):
 *             self.cH = value
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->cH);
  __pyx_r = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->cH;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line376")'> 376:         def __set__(self,value):</pre>
<pre id='line376' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":376
 *         def __get__(self):
 *             return self.cH
 *         def __set__(self,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.cH = value
 *         def __del__(self):
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_2cH_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_2cH_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__set__");
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line377")'> 377:             self.cH = value</pre>
<pre id='line377' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":377
 *             return self.cH
 *         def __set__(self,value):
 *             self.cH = value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __del__(self):
 *             cH = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->cH);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->cH);
  ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->cH = __pyx_v_value;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line378")'> 378:         def __del__(self):</pre>
<pre id='line378' class='code' style='background-color: #FFFFd4'>
/* "optneuosc.pyx":378
 *         def __set__(self,value):
 *             self.cH = value
 *         def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             cH = None
 * 
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_2cH_2__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_2cH_2__del__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_cH;
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__");
  __pyx_v_cH = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line379")'> 379:             cH = None</pre>
<pre id='line379' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":379
 *             self.cH = value
 *         def __del__(self):
 *             cH = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     property cS:
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_cH);
  __pyx_v_cH = Py_None;

  __pyx_r = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_cH);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line380")'> 380: </pre>
<pre id='line380' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line381")'> 381:     property cS:</pre>
<pre id='line381' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line382")'> 382:         def __get__(self):</pre>
<pre id='line382' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":382
 * 
 *     property cS:
 *         def __get__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return self.cS
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_2cS___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_9optneuosc_15ParamsContainer_2cS___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__get__");
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line383")'> 383:             return self.cS</pre>
<pre id='line383' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":383
 *     property cS:
 *         def __get__(self):
 *             return self.cS             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __set__(self,value):
 *             self.cS = value
 */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->cS);
  __pyx_r = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->cS;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFe7' onclick='toggleDiv("line384")'> 384:         def __set__(self,value):</pre>
<pre id='line384' class='code' style='background-color: #FFFFe7'>
/* "optneuosc.pyx":384
 *         def __get__(self):
 *             return self.cS
 *         def __set__(self,value):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             self.cS = value
 *         def __del__(self):
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_2cS_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_2cS_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__set__");
</pre><pre class='line' style='background-color: #FFFFc4' onclick='toggleDiv("line385")'> 385:             self.cS = value</pre>
<pre id='line385' class='code' style='background-color: #FFFFc4'>
  /* "optneuosc.pyx":385
 *             return self.cS
 *         def __set__(self,value):
 *             self.cS = value             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         def __del__(self):
 *             cS = None
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_value);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->cS);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->cS);
  ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_v_self)->cS = __pyx_v_value;

  __pyx_r = 0;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line386")'> 386:         def __del__(self):</pre>
<pre id='line386' class='code' style='background-color: #FFFFd4'>
/* "optneuosc.pyx":386
 *         def __set__(self,value):
 *             self.cS = value
 *         def __del__(self):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             cS = None
 * 
 */

static int __pyx_pf_9optneuosc_15ParamsContainer_2cS_2__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pf_9optneuosc_15ParamsContainer_2cS_2__del__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_cS;
  int __pyx_r;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("__del__");
  __pyx_v_cS = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
</pre><pre class='line' style='background-color: #FFFFb6' onclick='toggleDiv("line387")'> 387:             cS = None</pre>
<pre id='line387' class='code' style='background-color: #FFFFb6'>
  /* "optneuosc.pyx":387
 *             self.cS = value
 *         def __del__(self):
 *             cS = None             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 * cpdef CalNeuOscGSL(ineu,E,track,body,flavorM2,param,file = None,family = 0,NCCC_int = False,complete_decoherence = False,survival_prob = False,E_threshold = 1.0,optimization = True,only_osc_prob = True,abs_error = 1.0e-7, rel_error = 1.0e-6):
 */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_cS);
  __pyx_v_cS = Py_None;

  __pyx_r = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_cS);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line388")'> 388: </pre>
<pre id='line388' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF09' onclick='toggleDiv("line389")'> 389: cpdef CalNeuOscGSL(ineu,E,track,body,flavorM2,param,file = None,family = 0,NCCC_int = False,complete_decoherence = False,survival_prob = False,E_threshold = 1.0,optimization = True,only_osc_prob = True,abs_error = 1.0e-7, rel_error = 1.0e-6):</pre>
<pre id='line389' class='code' style='background-color: #FFFF09'>
/* "optneuosc.pyx":389
 *             cS = None
 * 
 * cpdef CalNeuOscGSL(ineu,E,track,body,flavorM2,param,file = None,family = 0,NCCC_int = False,complete_decoherence = False,survival_prob = False,E_threshold = 1.0,optimization = True,only_osc_prob = True,abs_error = 1.0e-7, rel_error = 1.0e-6):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """ Calculates the probability vector [P_ie,P_imu,P_itau,P_is,...] where i is
 *     the neutrino flavor specified by ineu. Also returns the survival probability.
 */

static PyObject *__pyx_pf_9optneuosc_12CalNeuOscGSL(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static  PyObject *__pyx_f_9optneuosc_CalNeuOscGSL(PyObject *__pyx_v_ineu, PyObject *__pyx_v_E, PyObject *__pyx_v_track, PyObject *__pyx_v_body, PyObject *__pyx_v_flavorM2, PyObject *__pyx_v_param, int __pyx_skip_dispatch, struct __pyx_opt_args_9optneuosc_CalNeuOscGSL *__pyx_optional_args) {
  PyObject *__pyx_v_file = ((PyObject *)Py_None);
  PyObject *__pyx_v_family = ((PyObject *)__pyx_int_0);
  PyObject *__pyx_v_NCCC_int = __pyx_k_6;
  PyObject *__pyx_v_complete_decoherence = __pyx_k_7;
  PyObject *__pyx_v_survival_prob = __pyx_k_8;
  PyObject *__pyx_v_E_threshold = __pyx_k_9;
  PyObject *__pyx_v_optimization = __pyx_k_10;
  PyObject *__pyx_v_only_osc_prob = __pyx_k_11;
  PyObject *__pyx_v_abs_error = __pyx_k_12;
  PyObject *__pyx_v_rel_error = __pyx_k_13;
  __pyx_t_double_complex __pyx_v_ii;
  int __pyx_v_dim;
  int __pyx_v_m;
  int __pyx_v_n;
  int __pyx_v_k;
  double __pyx_v_h;
  double __pyx_v_r;
  double __pyx_v_E_in;
  double __pyx_v_p_survival;
  double __pyx_v_r_old;
  double __pyx_v_r_new;
  double __pyx_v_E_MC;
  double __pyx_v_p_MC;
  long __pyx_v_neu;
  struct __pyx_obj_9optneuosc_ParamsContainer *__pyx_v_params;
  PyObject *__pyx_v_stepper;
  PyObject *__pyx_v_step;
  PyObject *__pyx_v_control;
  PyObject *__pyx_v_evolve;
  PyObject *__pyx_v_neu_state;
  PyObject *__pyx_v_survival_prob_list;
  double __pyx_v_r_adv;
  PyObject *__pyx_v_S;
  PyObject *__pyx_v_E_GeV;
  PyObject *__pyx_v_pfac;
  PyObject *__pyx_v_pe;
  PyObject *__pyx_v_pm;
  PyObject *__pyx_v_pt;
  PyObject *__pyx_v_p_active;
  PyObject *__pyx_v_dsde_NC;
  PyObject *__pyx_v_dsde_CC_e;
  PyObject *__pyx_v_dsde_CC_m;
  PyObject *__pyx_v_dsde_CC_t;
  PyObject *__pyx_v_sig_NC;
  PyObject *__pyx_v_sig_CC_e;
  PyObject *__pyx_v_sig_CC_m;
  PyObject *__pyx_v_sig_CC_t;
  PyObject *__pyx_v_sig_total_active;
  PyObject *__pyx_v_result;
  PyObject *__pyx_v_neutrino_energies;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_PMNS;
  PyObject *__pyx_r = NULL;
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("CalNeuOscGSL");
  if (__pyx_optional_args) {
    if (__pyx_optional_args->__pyx_n > 0) {
      __pyx_v_file = __pyx_optional_args->file;
      if (__pyx_optional_args->__pyx_n > 1) {
        __pyx_v_family = __pyx_optional_args->family;
        if (__pyx_optional_args->__pyx_n > 2) {
          __pyx_v_NCCC_int = __pyx_optional_args->NCCC_int;
          if (__pyx_optional_args->__pyx_n > 3) {
            __pyx_v_complete_decoherence = __pyx_optional_args->complete_decoherence;
            if (__pyx_optional_args->__pyx_n > 4) {
              __pyx_v_survival_prob = __pyx_optional_args->survival_prob;
              if (__pyx_optional_args->__pyx_n > 5) {
                __pyx_v_E_threshold = __pyx_optional_args->E_threshold;
                if (__pyx_optional_args->__pyx_n > 6) {
                  __pyx_v_optimization = __pyx_optional_args->optimization;
                  if (__pyx_optional_args->__pyx_n > 7) {
                    __pyx_v_only_osc_prob = __pyx_optional_args->only_osc_prob;
                    if (__pyx_optional_args->__pyx_n > 8) {
                      __pyx_v_abs_error = __pyx_optional_args->abs_error;
                      if (__pyx_optional_args->__pyx_n > 9) {
                        __pyx_v_rel_error = __pyx_optional_args->rel_error;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  __pyx_v_params = ((struct __pyx_obj_9optneuosc_ParamsContainer *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_stepper = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_step = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_control = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_evolve = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_neu_state = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_survival_prob_list = ((PyObject*)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_S = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_E_GeV = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_pfac = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_pe = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_pm = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_pt = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_p_active = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_dsde_NC = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_dsde_CC_e = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_dsde_CC_m = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_dsde_CC_t = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_sig_NC = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_sig_CC_e = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_sig_CC_m = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_sig_CC_t = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_sig_total_active = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_result = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_neutrino_energies = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_i = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_PMNS = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);

/* "optneuosc.pyx":389
 *             cS = None
 * 
 * cpdef CalNeuOscGSL(ineu,E,track,body,flavorM2,param,file = None,family = 0,NCCC_int = False,complete_decoherence = False,survival_prob = False,E_threshold = 1.0,optimization = True,only_osc_prob = True,abs_error = 1.0e-7, rel_error = 1.0e-6):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """ Calculates the probability vector [P_ie,P_imu,P_itau,P_is,...] where i is
 *     the neutrino flavor specified by ineu. Also returns the survival probability.
 */

static PyObject *__pyx_pf_9optneuosc_12CalNeuOscGSL(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9optneuosc_12CalNeuOscGSL[] = " Calculates the probability vector [P_ie,P_imu,P_itau,P_is,...] where i is \n    the neutrino flavor specified by ineu. Also returns the survival probability.\n    \n    Calculates the probabilities using the RK algorithm from the GSL library. When\n    the optimization flag is True it uses rediagonalization at each step in order\n    to increase speed. This technique is documented on C.A.Arguelles,J.Kopp (arXiv:1202.3431).\n    \n    When the NCCC_int flag is True neutrino interactions with matter will be considered,\n    in such a way that if the neutrino experiences a NC-interaction its energy will\n    be shifted accordingly, and if the neutrino experiences a CC-interaction in the\n    electron or muon flavor state the event will be discarted. On the other hand, if\n    the neutrino experiences a CC-interaction in the tau flavor tau regeneration is \n    implemented by calling this routine recursively.\n    \n    NC and CC interactions are implemented using the differential cross section \n    provided by NUSIGMA, here implemented by the nudsde nusigma-interface. Futhermore\n    tau regeneration is implemented using TAUOLA via the taudecay tauola-interface.\n    \n    When called by the #L{GenerateMCEvents} this provides an easy way of generating\n    montecarlo events on the NCCC_int = True mode.\n    \n    UPDATED: \n    - Updated to also return the survival probabilities at each step when survival_prob = True.\n\n    @type   ineu    :   int\n    @param  ineu    :   initial neutrino state\n    @type   E       :   float\n    @param  E       :   neutrino energy [eV]\n    @type   track   :   track object\n    @param  track   :   asociated trayectory in body\n    @type   body    :   body\n    @param  body    :   body with the asociated density profile.\n    @type   flavorM2:   array\n    @param  flavorM2:   M^2 in flavor basis\n    @type   param   :   physicsconstants\n    @param  param   :   set of physical parameters to be used.\n    @type   file    :   file obj""ect\n    @param  file    :   open file where data will be printed, if None will return result.\n    @type   family  :   integer\n    @param  family  :   returns the same integer for all neutrinos in the same event.\n    @type   NCCC_int:   boolean\n    @param  NCCC_int:   toggle NC-CC interactions ON/OFF\n    @type   complete_decoherence:   boolean\n    @param  complete_decoherence:   toggle complete decoherence interactions ON/OFF    \n    @type   survival_prob:   boolean\n    @param  survival_prob:   save intermediate survival probabilities.\n    @type   E_threshold:   float\n    @param  E_threshold:   Lower neutrino energy threshold. [GeV]\n    @type   optimization:   boolean\n    @param  optimization:   toogle rediagonalization optimization ON/OFF.\n    @type   only_osc_prob:   boolean\n    @param  only_osc_prob:   will only print the oscillation probabilities.\n    @type   abs_error:   float\n    @param  abs_error:   set absolute error in the RK.\n    @type   rel_error:   float\n    @param  rel_error:   set relative error in the RK.\n    \n    @rtype          :   List\n    @return         :   oscillation probability list.    \n    ";
static PyObject *__pyx_pf_9optneuosc_12CalNeuOscGSL(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ineu = 0;
  PyObject *__pyx_v_E = 0;
  PyObject *__pyx_v_track = 0;
  PyObject *__pyx_v_body = 0;
  PyObject *__pyx_v_flavorM2 = 0;
  PyObject *__pyx_v_param = 0;
  PyObject *__pyx_v_file = 0;
  PyObject *__pyx_v_family = 0;
  PyObject *__pyx_v_NCCC_int = 0;
  PyObject *__pyx_v_complete_decoherence = 0;
  PyObject *__pyx_v_survival_prob = 0;
  PyObject *__pyx_v_E_threshold = 0;
  PyObject *__pyx_v_optimization = 0;
  PyObject *__pyx_v_only_osc_prob = 0;
  PyObject *__pyx_v_abs_error = 0;
  PyObject *__pyx_v_rel_error = 0;
  PyObject *__pyx_r = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__ineu,&__pyx_n_s__E,&__pyx_n_s__track,&__pyx_n_s__body,&__pyx_n_s__flavorM2,&__pyx_n_s__param,&__pyx_n_s__file,&__pyx_n_s__family,&__pyx_n_s__NCCC_int,&__pyx_n_s_18,&__pyx_n_s__survival_prob,&__pyx_n_s__E_threshold,&__pyx_n_s__optimization,&__pyx_n_s__only_osc_prob,&__pyx_n_s__abs_error,&__pyx_n_s__rel_error,0};
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannySetupContext</span></span>("CalNeuOscGSL");
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    Py_ssize_t kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
    PyObject* values[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    values[6] = ((PyObject *)Py_None);
    values[7] = ((PyObject *)__pyx_int_0);
    values[8] = __pyx_k_6;
    values[9] = __pyx_k_7;
    values[10] = __pyx_k_8;
    values[11] = __pyx_k_9;
    values[12] = __pyx_k_10;
    values[13] = __pyx_k_11;
    values[14] = __pyx_k_12;
    values[15] = __pyx_k_13;
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case 16: values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
      case 15: values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
      case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
      case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
      case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
      case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case  0:
      values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__ineu);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E);
      if (likely(values[1])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CalNeuOscGSL", 0, 6, 16, 1);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  2:
      values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__track);
      if (likely(values[2])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CalNeuOscGSL", 0, 6, 16, 2);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  3:
      values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__body);
      if (likely(values[3])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CalNeuOscGSL", 0, 6, 16, 3);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  4:
      values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__flavorM2);
      if (likely(values[4])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CalNeuOscGSL", 0, 6, 16, 4);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  5:
      values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__param);
      if (likely(values[5])) kw_args--;
      else {
        <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CalNeuOscGSL", 0, 6, 16, 5);<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
      case  6:
      if (kw_args > 0) {
        PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__file);
        if (value) { values[6] = value; kw_args--; }
      }
      case  7:
      if (kw_args > 0) {
        PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__family);
        if (value) { values[7] = value; kw_args--; }
      }
      case  8:
      if (kw_args > 0) {
        PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__NCCC_int);
        if (value) { values[8] = value; kw_args--; }
      }
      case  9:
      if (kw_args > 0) {
        PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_18);
        if (value) { values[9] = value; kw_args--; }
      }
      case 10:
      if (kw_args > 0) {
        PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__survival_prob);
        if (value) { values[10] = value; kw_args--; }
      }
      case 11:
      if (kw_args > 0) {
        PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__E_threshold);
        if (value) { values[11] = value; kw_args--; }
      }
      case 12:
      if (kw_args > 0) {
        PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__optimization);
        if (value) { values[12] = value; kw_args--; }
      }
      case 13:
      if (kw_args > 0) {
        PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__only_osc_prob);
        if (value) { values[13] = value; kw_args--; }
      }
      case 14:
      if (kw_args > 0) {
        PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__abs_error);
        if (value) { values[14] = value; kw_args--; }
      }
      case 15:
      if (kw_args > 0) {
        PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s__rel_error);
        if (value) { values[15] = value; kw_args--; }
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args), "CalNeuOscGSL") <code><</code> 0))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    }
    __pyx_v_ineu = values[0];
    __pyx_v_E = values[1];
    __pyx_v_track = values[2];
    __pyx_v_body = values[3];
    __pyx_v_flavorM2 = values[4];
    __pyx_v_param = values[5];
    __pyx_v_file = values[6];
    __pyx_v_family = values[7];
    __pyx_v_NCCC_int = values[8];
    __pyx_v_complete_decoherence = values[9];
    __pyx_v_survival_prob = values[10];
    __pyx_v_E_threshold = values[11];
    __pyx_v_optimization = values[12];
    __pyx_v_only_osc_prob = values[13];
    __pyx_v_abs_error = values[14];
    __pyx_v_rel_error = values[15];
  } else {
    __pyx_v_file = ((PyObject *)Py_None);
    __pyx_v_family = ((PyObject *)__pyx_int_0);
    __pyx_v_NCCC_int = __pyx_k_6;
    __pyx_v_complete_decoherence = __pyx_k_7;
    __pyx_v_survival_prob = __pyx_k_8;
    __pyx_v_E_threshold = __pyx_k_9;
    __pyx_v_optimization = __pyx_k_10;
    __pyx_v_only_osc_prob = __pyx_k_11;
    __pyx_v_abs_error = __pyx_k_12;
    __pyx_v_rel_error = __pyx_k_13;
    switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
      case 16:
      __pyx_v_rel_error = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
      case 15:
      __pyx_v_abs_error = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
      case 14:
      __pyx_v_only_osc_prob = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
      case 13:
      __pyx_v_optimization = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
      case 12:
      __pyx_v_E_threshold = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
      case 11:
      __pyx_v_survival_prob = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      case 10:
      __pyx_v_complete_decoherence = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      case  9:
      __pyx_v_NCCC_int = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      case  8:
      __pyx_v_family = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      case  7:
      __pyx_v_file = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      case  6:
      __pyx_v_param = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      __pyx_v_flavorM2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      __pyx_v_body = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      __pyx_v_track = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      __pyx_v_E = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      __pyx_v_ineu = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("CalNeuOscGSL", 0, 6, 16, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.CalNeuOscGSL");
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_ineu;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_E;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_v_track;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_v_body;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  __pyx_t_5 = __pyx_v_flavorM2;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
  __pyx_t_6 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
  __pyx_t_7 = __pyx_v_file;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
  __pyx_t_8 = __pyx_v_family;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
  __pyx_t_9 = __pyx_v_NCCC_int;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
  __pyx_t_10 = __pyx_v_complete_decoherence;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
  __pyx_t_11 = __pyx_v_survival_prob;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
  __pyx_t_12 = __pyx_v_E_threshold;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
  __pyx_t_13 = __pyx_v_optimization;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
  __pyx_t_14 = __pyx_v_only_osc_prob;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
  __pyx_t_15 = __pyx_v_abs_error;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
  __pyx_t_16 = __pyx_v_rel_error;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
  __pyx_t_18.__pyx_n = 10;
  __pyx_t_18.file = __pyx_t_7;
  __pyx_t_18.family = __pyx_t_8;
  __pyx_t_18.NCCC_int = __pyx_t_9;
  __pyx_t_18.complete_decoherence = __pyx_t_10;
  __pyx_t_18.survival_prob = __pyx_t_11;
  __pyx_t_18.E_threshold = __pyx_t_12;
  __pyx_t_18.optimization = __pyx_t_13;
  __pyx_t_18.only_osc_prob = __pyx_t_14;
  __pyx_t_18.abs_error = __pyx_t_15;
  __pyx_t_18.rel_error = __pyx_t_16;
  __pyx_t_17 = __pyx_f_9optneuosc_CalNeuOscGSL(__pyx_t_1, __pyx_t_2, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, 0, &__pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_r = __pyx_t_17;
  __pyx_t_17 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.CalNeuOscGSL");
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}

  /* "optneuosc.pyx":389
 *             cS = None
 * 
 * cpdef CalNeuOscGSL(ineu,E,track,body,flavorM2,param,file = None,family = 0,NCCC_int = False,complete_decoherence = False,survival_prob = False,E_threshold = 1.0,optimization = True,only_osc_prob = True,abs_error = 1.0e-7, rel_error = 1.0e-6):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """ Calculates the probability vector [P_ie,P_imu,P_itau,P_is,...] where i is
 *     the neutrino flavor specified by ineu. Also returns the survival probability.
 */
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_6 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_7 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_8 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_9 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_10 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_11 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0e-7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_12 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0e-6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_k_13 = __pyx_t_1;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  __pyx_t_1 = 0;

/* "optneuosc.pyx":389
 *             cS = None
 * 
 * cpdef CalNeuOscGSL(ineu,E,track,body,flavorM2,param,file = None,family = 0,NCCC_int = False,complete_decoherence = False,survival_prob = False,E_threshold = 1.0,optimization = True,only_osc_prob = True,abs_error = 1.0e-7, rel_error = 1.0e-6):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     """ Calculates the probability vector [P_ie,P_imu,P_itau,P_is,...] where i is
 *     the neutrino flavor specified by ineu. Also returns the survival probability.
 */

struct __pyx_opt_args_9optneuosc_CalNeuOscGSL {
  int __pyx_n;
  PyObject *file;
  PyObject *family;
  PyObject *NCCC_int;
  PyObject *complete_decoherence;
  PyObject *survival_prob;
  PyObject *E_threshold;
  PyObject *optimization;
  PyObject *only_osc_prob;
  PyObject *abs_error;
  PyObject *rel_error;
};
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line390")'> 390:     """ Calculates the probability vector [P_ie,P_imu,P_itau,P_is,...] where i is</pre>
<pre id='line390' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line391")'> 391:     the neutrino flavor specified by ineu. Also returns the survival probability.</pre>
<pre id='line391' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line392")'> 392: </pre>
<pre id='line392' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line393")'> 393:     Calculates the probabilities using the RK algorithm from the GSL library. When</pre>
<pre id='line393' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line394")'> 394:     the optimization flag is True it uses rediagonalization at each step in order</pre>
<pre id='line394' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line395")'> 395:     to increase speed. This technique is documented on C.A.Arguelles,J.Kopp (arXiv:1202.3431).</pre>
<pre id='line395' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line396")'> 396: </pre>
<pre id='line396' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line397")'> 397:     When the NCCC_int flag is True neutrino interactions with matter will be considered,</pre>
<pre id='line397' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line398")'> 398:     in such a way that if the neutrino experiences a NC-interaction its energy will</pre>
<pre id='line398' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line399")'> 399:     be shifted accordingly, and if the neutrino experiences a CC-interaction in the</pre>
<pre id='line399' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line400")'> 400:     electron or muon flavor state the event will be discarted. On the other hand, if</pre>
<pre id='line400' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line401")'> 401:     the neutrino experiences a CC-interaction in the tau flavor tau regeneration is</pre>
<pre id='line401' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line402")'> 402:     implemented by calling this routine recursively.</pre>
<pre id='line402' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line403")'> 403: </pre>
<pre id='line403' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line404")'> 404:     NC and CC interactions are implemented using the differential cross section</pre>
<pre id='line404' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line405")'> 405:     provided by NUSIGMA, here implemented by the nudsde nusigma-interface. Futhermore</pre>
<pre id='line405' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line406")'> 406:     tau regeneration is implemented using TAUOLA via the taudecay tauola-interface.</pre>
<pre id='line406' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line407")'> 407: </pre>
<pre id='line407' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line408")'> 408:     When called by the #L{GenerateMCEvents} this provides an easy way of generating</pre>
<pre id='line408' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line409")'> 409:     montecarlo events on the NCCC_int = True mode.</pre>
<pre id='line409' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line410")'> 410: </pre>
<pre id='line410' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line411")'> 411:     UPDATED:</pre>
<pre id='line411' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line412")'> 412:     - Updated to also return the survival probabilities at each step when survival_prob = True.</pre>
<pre id='line412' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line413")'> 413: </pre>
<pre id='line413' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line414")'> 414:     @type   ineu    :   int</pre>
<pre id='line414' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line415")'> 415:     @param  ineu    :   initial neutrino state</pre>
<pre id='line415' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line416")'> 416:     @type   E       :   float</pre>
<pre id='line416' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line417")'> 417:     @param  E       :   neutrino energy [eV]</pre>
<pre id='line417' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line418")'> 418:     @type   track   :   track object</pre>
<pre id='line418' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line419")'> 419:     @param  track   :   asociated trayectory in body</pre>
<pre id='line419' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line420")'> 420:     @type   body    :   body</pre>
<pre id='line420' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line421")'> 421:     @param  body    :   body with the asociated density profile.</pre>
<pre id='line421' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line422")'> 422:     @type   flavorM2:   array</pre>
<pre id='line422' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line423")'> 423:     @param  flavorM2:   M^2 in flavor basis</pre>
<pre id='line423' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line424")'> 424:     @type   param   :   physicsconstants</pre>
<pre id='line424' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line425")'> 425:     @param  param   :   set of physical parameters to be used.</pre>
<pre id='line425' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line426")'> 426:     @type   file    :   file object</pre>
<pre id='line426' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line427")'> 427:     @param  file    :   open file where data will be printed, if None will return result.</pre>
<pre id='line427' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line428")'> 428:     @type   family  :   integer</pre>
<pre id='line428' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line429")'> 429:     @param  family  :   returns the same integer for all neutrinos in the same event.</pre>
<pre id='line429' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line430")'> 430:     @type   NCCC_int:   boolean</pre>
<pre id='line430' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line431")'> 431:     @param  NCCC_int:   toggle NC-CC interactions ON/OFF</pre>
<pre id='line431' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line432")'> 432:     @type   complete_decoherence:   boolean</pre>
<pre id='line432' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line433")'> 433:     @param  complete_decoherence:   toggle complete decoherence interactions ON/OFF</pre>
<pre id='line433' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line434")'> 434:     @type   survival_prob:   boolean</pre>
<pre id='line434' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line435")'> 435:     @param  survival_prob:   save intermediate survival probabilities.</pre>
<pre id='line435' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line436")'> 436:     @type   E_threshold:   float</pre>
<pre id='line436' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line437")'> 437:     @param  E_threshold:   Lower neutrino energy threshold. [GeV]</pre>
<pre id='line437' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line438")'> 438:     @type   optimization:   boolean</pre>
<pre id='line438' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line439")'> 439:     @param  optimization:   toogle rediagonalization optimization ON/OFF.</pre>
<pre id='line439' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line440")'> 440:     @type   only_osc_prob:   boolean</pre>
<pre id='line440' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line441")'> 441:     @param  only_osc_prob:   will only print the oscillation probabilities.</pre>
<pre id='line441' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line442")'> 442:     @type   abs_error:   float</pre>
<pre id='line442' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line443")'> 443:     @param  abs_error:   set absolute error in the RK.</pre>
<pre id='line443' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line444")'> 444:     @type   rel_error:   float</pre>
<pre id='line444' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line445")'> 445:     @param  rel_error:   set relative error in the RK.</pre>
<pre id='line445' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line446")'> 446: </pre>
<pre id='line446' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line447")'> 447:     @rtype          :   List</pre>
<pre id='line447' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line448")'> 448:     @return         :   oscillation probability list.</pre>
<pre id='line448' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line449")'> 449:     """</pre>
<pre id='line449' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line450")'> 450:     cdef complex ii</pre>
<pre id='line450' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line451")'> 451:     cdef int dim,m,n,k</pre>
<pre id='line451' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line452")'> 452:     cdef double h,r,E_in,p_survival,r_old,r_new,E_MC,p_MC</pre>
<pre id='line452' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line453")'> 453: </pre>
<pre id='line453' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line454")'> 454:     # define complex i</pre>
<pre id='line454' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line455")'> 455:     ii = complex(0.0,1.0)</pre>
<pre id='line455' class='code' style='background-color: #FFFF39'>
  /* "optneuosc.pyx":455
 * 
 *     # define complex i
 *     ii = complex(0.0,1.0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # saving neutrino type
 */
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyComplex_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_<span class='py_c_api'>PyComplex_As___pyx_t_double_complex</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ii = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line456")'> 456: </pre>
<pre id='line456' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line457")'> 457:     # saving neutrino type</pre>
<pre id='line457' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line458")'> 458:     if param.neutype == "neutrino":</pre>
<pre id='line458' class='code' style='background-color: #FFFF5e'>
  /* "optneuosc.pyx":458
 * 
 *     # saving neutrino type
 *     if param.neutype == "neutrino":             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         neu = 0
 *     elif param.neutype == "antineutrino":
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__neutype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__neutrino), Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line459")'> 459:         neu = 0</pre>
<pre id='line459' class='code' style='background-color: #FFFFff'>
    /* "optneuosc.pyx":459
 *     # saving neutrino type
 *     if param.neutype == "neutrino":
 *         neu = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     elif param.neutype == "antineutrino":
 *         neu = 1
 */
    __pyx_v_neu = 0;
    goto __pyx_L3;
  }
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line460")'> 460:     elif param.neutype == "antineutrino":</pre>
<pre id='line460' class='code' style='background-color: #FFFF5e'>
  /* "optneuosc.pyx":460
 *     if param.neutype == "neutrino":
 *         neu = 0
 *     elif param.neutype == "antineutrino":             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         neu = 1
 * 
 */
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__neutype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, ((PyObject *)__pyx_n_s__antineutrino), Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line461")'> 461:         neu = 1</pre>
<pre id='line461' class='code' style='background-color: #FFFFff'>
    /* "optneuosc.pyx":461
 *         neu = 0
 *     elif param.neutype == "antineutrino":
 *         neu = 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # setup params aux. container
 */
    __pyx_v_neu = 1;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line462")'> 462: </pre>
<pre id='line462' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line463")'> 463:     # setup params aux. container</pre>
<pre id='line463' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line464")'> 464:     params = ParamsContainer()</pre>
<pre id='line464' class='code' style='background-color: #FFFF9f'>
  /* "optneuosc.pyx":464
 * 
 *     # setup params aux. container
 *     params = ParamsContainer()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     params.track, params.param,params.flavorM2,params.body,params.E = track,param,flavorM2,body,E
 *     params.H0 = ii*flavorH(track,param,flavorM2,body,E)
 */
  __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_9optneuosc_ParamsContainer)), ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_params));
  __pyx_v_params = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line465")'> 465:     params.track, params.param,params.flavorM2,params.body,params.E = track,param,flavorM2,body,E</pre>
<pre id='line465' class='code' style='background-color: #FFFF7f'>
  /* "optneuosc.pyx":465
 *     # setup params aux. container
 *     params = ParamsContainer()
 *     params.track, params.param,params.flavorM2,params.body,params.E = track,param,flavorM2,body,E             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     params.H0 = ii*flavorH(track,param,flavorM2,body,E)
 *     params.S  = np.identity(param.numneu, complex)
 */
  __pyx_t_2 = __pyx_v_track;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_1 = __pyx_v_flavorM2;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_6 = __pyx_v_body;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
  __pyx_t_7 = __pyx_v_E;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_params->track);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_params->track);
  __pyx_v_params->track = __pyx_t_2;
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_params->param);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_params->param);
  __pyx_v_params->param = __pyx_t_3;
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_params->flavorM2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_params->flavorM2);
  __pyx_v_params->flavorM2 = __pyx_t_1;
  __pyx_t_1 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_params->body);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_params->body);
  __pyx_v_params->body = __pyx_t_6;
  __pyx_t_6 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_params->E);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_params->E);
  __pyx_v_params->E = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line466")'> 466:     params.H0 = ii*flavorH(track,param,flavorM2,body,E)</pre>
<pre id='line466' class='code' style='background-color: #FFFF4d'>
  /* "optneuosc.pyx":466
 *     params = ParamsContainer()
 *     params.track, params.param,params.flavorM2,params.body,params.E = track,param,flavorM2,body,E
 *     params.H0 = ii*flavorH(track,param,flavorM2,body,E)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     params.S  = np.identity(param.numneu, complex)
 * 
 */
  __pyx_t_7 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__pyx_v_ii);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
  __pyx_t_6 = __pyx_v_track;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
  __pyx_t_1 = __pyx_v_param;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_v_flavorM2;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_2 = __pyx_v_body;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_8 = __pyx_v_E;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
  __pyx_t_9 = __pyx_f_9optneuosc_flavorH(__pyx_t_6, __pyx_t_1, __pyx_t_3, __pyx_t_2, __pyx_t_8, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_t_7), __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_params->H0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_params->H0);
  __pyx_v_params->H0 = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line467")'> 467:     params.S  = np.identity(param.numneu, complex)</pre>
<pre id='line467' class='code' style='background-color: #FFFF41'>
  /* "optneuosc.pyx":467
 *     params.track, params.param,params.flavorM2,params.body,params.E = track,param,flavorM2,body,E
 *     params.H0 = ii*flavorH(track,param,flavorM2,body,E)
 *     params.S  = np.identity(param.numneu, complex)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # setup GSL solver
 */
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_8, __pyx_n_s__identity);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_8);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)(&PyComplex_Type))));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, ((PyObject *)((PyObject*)(&PyComplex_Type))));
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)(&PyComplex_Type))));
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_9, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_params->S);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_params->S);
  __pyx_v_params->S = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line468")'> 468: </pre>
<pre id='line468' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line469")'> 469:     # setup GSL solver</pre>
<pre id='line469' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line470")'> 470:     dim     = int(2*param.numneu)</pre>
<pre id='line470' class='code' style='background-color: #FFFF39'>
  /* "optneuosc.pyx":470
 * 
 *     # setup GSL solver
 *     dim     = int(2*param.numneu)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     stepper = odeiv.step_rkf45
 *     step    = stepper(dim,RHS_INT_GSL,None,args = params)
 */
  __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_7);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
  __pyx_t_10 = __Pyx_<span class='py_c_api'>PyInt_AsInt</span>(__pyx_t_7);<span class='error_goto'> if (unlikely((__pyx_t_10 == (int)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_dim = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line471")'> 471:     stepper = odeiv.step_rkf45</pre>
<pre id='line471' class='code' style='background-color: #FFFF86'>
  /* "optneuosc.pyx":471
 *     # setup GSL solver
 *     dim     = int(2*param.numneu)
 *     stepper = odeiv.step_rkf45             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     step    = stepper(dim,RHS_INT_GSL,None,args = params)
 *     control = odeiv.control_y_new(step,abs_error,rel_error)
 */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__odeiv);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_7, __pyx_n_s__step_rkf45);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_stepper);
  __pyx_v_stepper = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF39' onclick='toggleDiv("line472")'> 472:     step    = stepper(dim,RHS_INT_GSL,None,args = params)</pre>
<pre id='line472' class='code' style='background-color: #FFFF39'>
  /* "optneuosc.pyx":472
 *     dim     = int(2*param.numneu)
 *     stepper = odeiv.step_rkf45
 *     step    = stepper(dim,RHS_INT_GSL,None,args = params)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     control = odeiv.control_y_new(step,abs_error,rel_error)
 *     evolve  = odeiv.evolve(step,control,dim)
 */
  __pyx_t_8 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_dim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__RHS_INT_GSL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_9));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_7);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, Py_None);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(Py_None);
  __pyx_t_8 = 0;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, ((PyObject *)__pyx_n_s__args), ((PyObject *)__pyx_v_params)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = <span class='py_c_api'>PyEval_CallObjectWithKeywords</span>(__pyx_v_stepper, ((PyObject *)__pyx_t_9), ((PyObject *)__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_step);
  __pyx_v_step = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line473")'> 473:     control = odeiv.control_y_new(step,abs_error,rel_error)</pre>
<pre id='line473' class='code' style='background-color: #FFFF44'>
  /* "optneuosc.pyx":473
 *     stepper = odeiv.step_rkf45
 *     step    = stepper(dim,RHS_INT_GSL,None,args = params)
 *     control = odeiv.control_y_new(step,abs_error,rel_error)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     evolve  = odeiv.evolve(step,control,dim)
 * 
 */
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__odeiv);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_8, __pyx_n_s__control_y_new);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_step);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_step);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_step);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_abs_error);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_abs_error);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_abs_error);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rel_error);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_v_rel_error);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_rel_error);
  __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_7, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_control);
  __pyx_v_control = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line474")'> 474:     evolve  = odeiv.evolve(step,control,dim)</pre>
<pre id='line474' class='code' style='background-color: #FFFF3e'>
  /* "optneuosc.pyx":474
 *     step    = stepper(dim,RHS_INT_GSL,None,args = params)
 *     control = odeiv.control_y_new(step,abs_error,rel_error)
 *     evolve  = odeiv.evolve(step,control,dim)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # initial parameters
 */
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__odeiv);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
  __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_9, __pyx_n_s__evolve);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_dim);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_step);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_step);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_step);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_control);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_control);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_control);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_t_9);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_evolve);
  __pyx_v_evolve = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line475")'> 475: </pre>
<pre id='line475' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line476")'> 476:     # initial parameters</pre>
<pre id='line476' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line477")'> 477:     neu_state           = [0.0]*dim</pre>
<pre id='line477' class='code' style='background-color: #FFFF4b'>
  /* "optneuosc.pyx":477
 * 
 *     # initial parameters
 *     neu_state           = [0.0]*dim             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     neu_state[ineu*2]   = 1.0             # initial state
 *     h = 10.0*param.km                     # initial step size
 */
  __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
  __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_9);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_dim);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_t_7), __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neu_state);
  __pyx_v_neu_state = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line478")'> 478:     neu_state[ineu*2]   = 1.0             # initial state</pre>
<pre id='line478' class='code' style='background-color: #FFFF5e'>
  /* "optneuosc.pyx":478
 *     # initial parameters
 *     neu_state           = [0.0]*dim
 *     neu_state[ineu*2]   = 1.0             # initial state             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     h = 10.0*param.km                     # initial step size
 *     r = track.xini
 */
  __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_ineu, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
  if (<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_neu_state, __pyx_t_9, __pyx_t_8) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line479")'> 479:     h = 10.0*param.km                     # initial step size</pre>
<pre id='line479' class='code' style='background-color: #FFFF43'>
  /* "optneuosc.pyx":479
 *     neu_state           = [0.0]*dim
 *     neu_state[ineu*2]   = 1.0             # initial state
 *     h = 10.0*param.km                     # initial step size             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     r = track.xini
 *     # survial array
 */
  __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(10.0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__km);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely((__pyx_t_11 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_h = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line480")'> 480:     r = track.xini</pre>
<pre id='line480' class='code' style='background-color: #FFFF62'>
  /* "optneuosc.pyx":480
 *     neu_state[ineu*2]   = 1.0             # initial state
 *     h = 10.0*param.km                     # initial step size
 *     r = track.xini             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     # survial array
 *     survival_prob_list = []
 */
  __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_track, __pyx_n_s__xini);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely((__pyx_t_11 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_r = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line481")'> 481:     # survial array</pre>
<pre id='line481' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line482")'> 482:     survival_prob_list = []</pre>
<pre id='line482' class='code' style='background-color: #FFFF9f'>
  /* "optneuosc.pyx":482
 *     r = track.xini
 *     # survial array
 *     survival_prob_list = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     E_in    = params.E/param.GeV
 */
  __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_survival_prob_list));
  __pyx_v_survival_prob_list = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line483")'> 483: </pre>
<pre id='line483' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line484")'> 484:     E_in    = params.E/param.GeV</pre>
<pre id='line484' class='code' style='background-color: #FFFF4f'>
  /* "optneuosc.pyx":484
 *     survival_prob_list = []
 * 
 *     E_in    = params.E/param.GeV             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # survival probability
 */
  __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__GeV);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  __pyx_t_9 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_params->E, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_9);<span class='error_goto'> if (unlikely((__pyx_t_11 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_E_in = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line485")'> 485: </pre>
<pre id='line485' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line486")'> 486:     # survival probability</pre>
<pre id='line486' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line487")'> 487:     p_survival = 1.0</pre>
<pre id='line487' class='code' style='background-color: #FFFFff'>
  /* "optneuosc.pyx":487
 * 
 *     # survival probability
 *     p_survival = 1.0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # starting interaction counters
 */
  __pyx_v_p_survival = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line488")'> 488: </pre>
<pre id='line488' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line489")'> 489:     # starting interaction counters</pre>
<pre id='line489' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line490")'> 490:     m = 0</pre>
<pre id='line490' class='code' style='background-color: #FFFFff'>
  /* "optneuosc.pyx":490
 * 
 *     # starting interaction counters
 *     m = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     n = 0
 *     k = 0
 */
  __pyx_v_m = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line491")'> 491:     n = 0</pre>
<pre id='line491' class='code' style='background-color: #FFFFff'>
  /* "optneuosc.pyx":491
 *     # starting interaction counters
 *     m = 0
 *     n = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     k = 0
 * 
 */
  __pyx_v_n = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line492")'> 492:     k = 0</pre>
<pre id='line492' class='code' style='background-color: #FFFFff'>
  /* "optneuosc.pyx":492
 *     m = 0
 *     n = 0
 *     k = 0             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     while r <code><</code> track.xend :
 */
  __pyx_v_k = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line493")'> 493: </pre>
<pre id='line493' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line494")'> 494:     while r &lt; track.xend :</pre>
<pre id='line494' class='code' style='background-color: #FFFF4d'>
  /* "optneuosc.pyx":494
 *     k = 0
 * 
 *     while r <code><</code> track.xend :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         # advancing one RK step
 *         r_old = r
 */
  while (1) {
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_r);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_track, __pyx_n_s__xend);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_9, __pyx_t_7, Py_LT);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (!__pyx_t_5) break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line495")'> 495:         # advancing one RK step</pre>
<pre id='line495' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line496")'> 496:         r_old = r</pre>
<pre id='line496' class='code' style='background-color: #FFFFff'>
    /* "optneuosc.pyx":496
 *     while r <code><</code> track.xend :
 *         # advancing one RK step
 *         r_old = r             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         params.rpos = r
 *         r,h,neu_state = evolve.apply(r,track.xend,h,neu_state)
 */
    __pyx_v_r_old = __pyx_v_r;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line497")'> 497:         params.rpos = r</pre>
<pre id='line497' class='code' style='background-color: #FFFF9f'>
    /* "optneuosc.pyx":497
 *         # advancing one RK step
 *         r_old = r
 *         params.rpos = r             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         r,h,neu_state = evolve.apply(r,track.xend,h,neu_state)
 *         r_new = r
 */
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_r);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_params->rpos);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_params->rpos);
    __pyx_v_params->rpos = __pyx_t_8;
    __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF15' onclick='toggleDiv("line498")'> 498:         r,h,neu_state = evolve.apply(r,track.xend,h,neu_state)</pre>
<pre id='line498' class='code' style='background-color: #FFFF15'>
    /* "optneuosc.pyx":498
 *         r_old = r
 *         params.rpos = r
 *         r,h,neu_state = evolve.apply(r,track.xend,h,neu_state)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         r_new = r
 * 
 */
    __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_evolve, __pyx_n_s__apply);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_r);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_track, __pyx_n_s__xend);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_h);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_7);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_9);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_neu_state);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_v_neu_state);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_neu_state);
    __pyx_t_7 = 0;
    __pyx_t_9 = 0;
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2) && likely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2) == 3)) {
      PyObject* tuple = __pyx_t_2;
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(tuple, 0); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_11 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(tuple, 1); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_12 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(tuple, 2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_r = __pyx_t_11;
      __pyx_v_h = __pyx_t_12;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neu_state);
      __pyx_v_neu_state = __pyx_t_9;
      __pyx_t_9 = 0;
    } else {
      __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_UnpackItem</span>(__pyx_t_7, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_12 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_UnpackItem</span>(__pyx_t_7, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_11 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_UnpackItem</span>(__pyx_t_7, 2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      if (<span class='pyx_c_api'>__Pyx_EndUnpack</span>(__pyx_t_7, 3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_v_r = __pyx_t_12;
      __pyx_v_h = __pyx_t_11;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neu_state);
      __pyx_v_neu_state = __pyx_t_9;
      __pyx_t_9 = 0;
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line499")'> 499:         r_new = r</pre>
<pre id='line499' class='code' style='background-color: #FFFFff'>
    /* "optneuosc.pyx":499
 *         params.rpos = r
 *         r,h,neu_state = evolve.apply(r,track.xend,h,neu_state)
 *         r_new = r             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         r_adv = r_new-r_old
 */
    __pyx_v_r_new = __pyx_v_r;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line500")'> 500: </pre>
<pre id='line500' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line501")'> 501:         r_adv = r_new-r_old</pre>
<pre id='line501' class='code' style='background-color: #FFFFff'>
    /* "optneuosc.pyx":501
 *         r_new = r
 * 
 *         r_adv = r_new-r_old             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # ZAZ beginning rediagonalization optimization ZAZ
 */
    __pyx_v_r_adv = (__pyx_v_r_new - __pyx_v_r_old);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line502")'> 502: </pre>
<pre id='line502' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line503")'> 503:         # ZAZ beginning rediagonalization optimization ZAZ</pre>
<pre id='line503' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line504")'> 504:         # CALCULATE exp(-i H0 (r-r0))</pre>
<pre id='line504' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line505")'> 505:         # where H0 = H(r_current) = cH</pre>
<pre id='line505' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line506")'> 506:         S = sp.linalg.matfuncs.expm2(-ii*params.cH*(r_adv))</pre>
<pre id='line506' class='code' style='background-color: #FFFF26'>
    /* "optneuosc.pyx":506
 *         # CALCULATE exp(-i H0 (r-r0))
 *         # where H0 = H(r_current) = cH
 *         S = sp.linalg.matfuncs.expm2(-ii*params.cH*(r_adv))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # saving this for next calculation
 */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__sp);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__linalg);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_9, __pyx_n_s__matfuncs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__expm2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __pyx_<span class='py_c_api'>PyComplex_FromComplex</span>(__Pyx_c_neg(__pyx_v_ii));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_t_2), __pyx_v_params->cH);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_r_adv);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_9, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_S);
    __pyx_v_S = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line507")'> 507: </pre>
<pre id='line507' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line508")'> 508:         # saving this for next calculation</pre>
<pre id='line508' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line509")'> 509:         params.H0 = params.cH</pre>
<pre id='line509' class='code' style='background-color: #FFFFd4'>
    /* "optneuosc.pyx":509
 * 
 *         # saving this for next calculation
 *         params.H0 = params.cH             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         # UNDO LAST TRANSFORMATION : psi = S psi
 *         neu_state = rvec(np.dot(S.conjugate().T,cvec(neu_state,param)),param)
 */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_params->cH);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_params->cH);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_params->H0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_params->H0);
    __pyx_v_params->H0 = __pyx_v_params->cH;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line510")'> 510:         # UNDO LAST TRANSFORMATION : psi = S psi</pre>
<pre id='line510' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2e' onclick='toggleDiv("line511")'> 511:         neu_state = rvec(np.dot(S.conjugate().T,cvec(neu_state,param)),param)</pre>
<pre id='line511' class='code' style='background-color: #FFFF2e'>
    /* "optneuosc.pyx":511
 *         params.H0 = params.cH
 *         # UNDO LAST TRANSFORMATION : psi = S psi
 *         neu_state = rvec(np.dot(S.conjugate().T,cvec(neu_state,param)),param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         if NCCC_int :
 */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__dot);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_S, __pyx_n_s__conjugate);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_9, __pyx_n_s__T);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = __pyx_v_param;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_t_8 = __pyx_f_9optneuosc_cvec(__pyx_v_neu_state, __pyx_t_9, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_9));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_8);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
    __pyx_t_3 = 0;
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
    __pyx_t_9 = __pyx_v_param;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_t_2 = __pyx_f_9optneuosc_rvec(__pyx_t_8, __pyx_t_9, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neu_state);
    __pyx_v_neu_state = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line512")'> 512: </pre>
<pre id='line512' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line513")'> 513:         if NCCC_int :</pre>
<pre id='line513' class='code' style='background-color: #FFFFaa'>
    /* "optneuosc.pyx":513
 *         neu_state = rvec(np.dot(S.conjugate().T,cvec(neu_state,param)),param)
 * 
 *         if NCCC_int :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             # CC-NC MONTECARLO
 *             E_GeV = params.E/param.GeV
 */
    __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_NCCC_int);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line514")'> 514:             # CC-NC MONTECARLO</pre>
<pre id='line514' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line515")'> 515:             E_GeV = params.E/param.GeV</pre>
<pre id='line515' class='code' style='background-color: #FFFF73'>
      /* "optneuosc.pyx":515
 *         if NCCC_int :
 *             # CC-NC MONTECARLO
 *             E_GeV = params.E/param.GeV             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             # pick my random point (E,p/E)
 *             E_MC = np.random.uniform(0.0,E_GeV,1)[0]
 */
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__GeV);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_params->E, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_E_GeV);
      __pyx_v_E_GeV = __pyx_t_9;
      __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line516")'> 516:             # pick my random point (E,p/E)</pre>
<pre id='line516' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line517")'> 517:             E_MC = np.random.uniform(0.0,E_GeV,1)[0]</pre>
<pre id='line517' class='code' style='background-color: #FFFF2a'>
      /* "optneuosc.pyx":517
 *             E_GeV = params.E/param.GeV
 *             # pick my random point (E,p/E)
 *             E_MC = np.random.uniform(0.0,E_GeV,1)[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             p_MC = np.random.uniform(0.0,1.0/E_GeV,1)[0]
 * 
 */
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_9, __pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__uniform);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_int_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_9, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_8);<span class='error_goto'> if (unlikely((__pyx_t_11 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_v_E_MC = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line518")'> 518:             p_MC = np.random.uniform(0.0,1.0/E_GeV,1)[0]</pre>
<pre id='line518' class='code' style='background-color: #FFFF24'>
      /* "optneuosc.pyx":518
 *             # pick my random point (E,p/E)
 *             E_MC = np.random.uniform(0.0,E_GeV,1)[0]
 *             p_MC = np.random.uniform(0.0,1.0/E_GeV,1)[0]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             # THIS LINES TURN OUT TO BE THE SAME AS Na = 1/AMU BY DEFINITION
 */
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_8, __pyx_n_s__random);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__uniform);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_9, __pyx_v_E_GeV);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_9));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_int_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_9);<span class='error_goto'> if (unlikely((__pyx_t_11 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_v_p_MC = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line519")'> 519: </pre>
<pre id='line519' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line520")'> 520:             # THIS LINES TURN OUT TO BE THE SAME AS Na = 1/AMU BY DEFINITION</pre>
<pre id='line520' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line521")'> 521:             #pfac = np.abs(body.density(track)*param.Na*(r_adv/param.cm))</pre>
<pre id='line521' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1d' onclick='toggleDiv("line522")'> 522:             pfac = np.abs((body.density(track)/param.atomic_mass_unit)*(r_adv/param.cm))</pre>
<pre id='line522' class='code' style='background-color: #FFFF1d'>
      /* "optneuosc.pyx":522
 *             # THIS LINES TURN OUT TO BE THE SAME AS Na = 1/AMU BY DEFINITION
 *             #pfac = np.abs(body.density(track)*param.Na*(r_adv/param.cm))
 *             pfac = np.abs((body.density(track)/param.atomic_mass_unit)*(r_adv/param.cm))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             # active flavors probabilities
 */
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_9, __pyx_n_s__abs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_body, __pyx_n_s__density);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_track);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_track);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_track);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_9, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__atomic_mass_unit);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_2, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_r_adv);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__cm);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_8, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pfac);
      __pyx_v_pfac = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line523")'> 523: </pre>
<pre id='line523' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line524")'> 524:             # active flavors probabilities</pre>
<pre id='line524' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line525")'> 525:             pe = neu_state[0]*neu_state[0]+neu_state[1]*neu_state[1]</pre>
<pre id='line525' class='code' style='background-color: #FFFF3f'>
      /* "optneuosc.pyx":525
 * 
 *             # active flavors probabilities
 *             pe = neu_state[0]*neu_state[0]+neu_state[1]*neu_state[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             pm = neu_state[2]*neu_state[2]+neu_state[3]*neu_state[3]
 *             pt = neu_state[4]*neu_state[4]+neu_state[5]*neu_state[5]
 */
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 1, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 1, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pe);
      __pyx_v_pe = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line526")'> 526:             pm = neu_state[2]*neu_state[2]+neu_state[3]*neu_state[3]</pre>
<pre id='line526' class='code' style='background-color: #FFFF3f'>
      /* "optneuosc.pyx":526
 *             # active flavors probabilities
 *             pe = neu_state[0]*neu_state[0]+neu_state[1]*neu_state[1]
 *             pm = neu_state[2]*neu_state[2]+neu_state[3]*neu_state[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             pt = neu_state[4]*neu_state[4]+neu_state[5]*neu_state[5]
 * 
 */
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 3, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 3, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pm);
      __pyx_v_pm = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line527")'> 527:             pt = neu_state[4]*neu_state[4]+neu_state[5]*neu_state[5]</pre>
<pre id='line527' class='code' style='background-color: #FFFF3f'>
      /* "optneuosc.pyx":527
 *             pe = neu_state[0]*neu_state[0]+neu_state[1]*neu_state[1]
 *             pm = neu_state[2]*neu_state[2]+neu_state[3]*neu_state[3]
 *             pt = neu_state[4]*neu_state[4]+neu_state[5]*neu_state[5]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             # probability that is an active neutrino
 */
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 4, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 4, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 5, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 5, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pt);
      __pyx_v_pt = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line528")'> 528: </pre>
<pre id='line528' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line529")'> 529:             # probability that is an active neutrino</pre>
<pre id='line529' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line530")'> 530:             p_active = pe+pm+pt</pre>
<pre id='line530' class='code' style='background-color: #FFFF73'>
      /* "optneuosc.pyx":530
 * 
 *             # probability that is an active neutrino
 *             p_active = pe+pm+pt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             # Figuring out if the neutrino will undergo an interaction
 */
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_pe, __pyx_v_pm);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_v_pt);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_p_active);
      __pyx_v_p_active = __pyx_t_9;
      __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line531")'> 531: </pre>
<pre id='line531' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line532")'> 532:             # Figuring out if the neutrino will undergo an interaction</pre>
<pre id='line532' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line533")'> 533:             # by stacking the diferential cross sections and selecting</pre>
<pre id='line533' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line534")'> 534:             # a random point in the plane dSigma/dE versus E plane.</pre>
<pre id='line534' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line535")'> 535: </pre>
<pre id='line535' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line536")'> 536:             dsde_NC     = xs.dsde_NC_opt(E_GeV,E_MC,param)</pre>
<pre id='line536' class='code' style='background-color: #FFFF3e'>
      /* "optneuosc.pyx":536
 *             # a random point in the plane dSigma/dE versus E plane.
 * 
 *             dsde_NC     = xs.dsde_NC_opt(E_GeV,E_MC,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             dsde_CC_e   = xs.dsde_CC_opt(E_GeV,E_MC,param,flv = 0)
 *             # Assuming that the muon diff. cross section is similar to the electron
 */
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__xs);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 536; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_9, __pyx_n_s__dsde_NC_opt);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 536; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_MC);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 536; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 536; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_9);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 536; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dsde_NC);
      __pyx_v_dsde_NC = __pyx_t_9;
      __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line537")'> 537:             dsde_CC_e   = xs.dsde_CC_opt(E_GeV,E_MC,param,flv = 0)</pre>
<pre id='line537' class='code' style='background-color: #FFFF31'>
      /* "optneuosc.pyx":537
 * 
 *             dsde_NC     = xs.dsde_NC_opt(E_GeV,E_MC,param)
 *             dsde_CC_e   = xs.dsde_CC_opt(E_GeV,E_MC,param,flv = 0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             # Assuming that the muon diff. cross section is similar to the electron
 *             dsde_CC_m   = dsde_CC_e
 */
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__xs);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_9, __pyx_n_s__dsde_CC_opt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_MC);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_9);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_9));
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, ((PyObject *)__pyx_n_s__flv), __pyx_int_0) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = <span class='py_c_api'>PyEval_CallObjectWithKeywords</span>(__pyx_t_3, ((PyObject *)__pyx_t_2), ((PyObject *)__pyx_t_9));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dsde_CC_e);
      __pyx_v_dsde_CC_e = __pyx_t_7;
      __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line538")'> 538:             # Assuming that the muon diff. cross section is similar to the electron</pre>
<pre id='line538' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line539")'> 539:             dsde_CC_m   = dsde_CC_e</pre>
<pre id='line539' class='code' style='background-color: #FFFFd4'>
      /* "optneuosc.pyx":539
 *             dsde_CC_e   = xs.dsde_CC_opt(E_GeV,E_MC,param,flv = 0)
 *             # Assuming that the muon diff. cross section is similar to the electron
 *             dsde_CC_m   = dsde_CC_e             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             # else we should use this line :
 *             #dsde_CC_mu = xs.dsde_CC_opt(E_GeV,E_MC,param,flv = 1)
 */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dsde_CC_e);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dsde_CC_m);
      __pyx_v_dsde_CC_m = __pyx_v_dsde_CC_e;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line540")'> 540:             # else we should use this line :</pre>
<pre id='line540' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line541")'> 541:             #dsde_CC_mu = xs.dsde_CC_opt(E_GeV,E_MC,param,flv = 1)</pre>
<pre id='line541' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line542")'> 542:             dsde_CC_t   = xs.dsde_CC_opt(E_GeV,E_MC,param,flv = 2)</pre>
<pre id='line542' class='code' style='background-color: #FFFF31'>
      /* "optneuosc.pyx":542
 *             # else we should use this line :
 *             #dsde_CC_mu = xs.dsde_CC_opt(E_GeV,E_MC,param,flv = 1)
 *             dsde_CC_t   = xs.dsde_CC_opt(E_GeV,E_MC,param,flv = 2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             # new xsections
 */
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__xs);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_7, __pyx_n_s__dsde_CC_opt);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_MC);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_7);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, ((PyObject *)__pyx_n_s__flv), __pyx_int_2) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_3 = <span class='py_c_api'>PyEval_CallObjectWithKeywords</span>(__pyx_t_9, ((PyObject *)__pyx_t_2), ((PyObject *)__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dsde_CC_t);
      __pyx_v_dsde_CC_t = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line543")'> 543: </pre>
<pre id='line543' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line544")'> 544:             # new xsections</pre>
<pre id='line544' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line545")'> 545:             sig_NC = xs.nuDISxsection_NC_NusigmaInt(E_GeV,param)</pre>
<pre id='line545' class='code' style='background-color: #FFFF48'>
      /* "optneuosc.pyx":545
 * 
 *             # new xsections
 *             sig_NC = xs.nuDISxsection_NC_NusigmaInt(E_GeV,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sig_CC_e = xs.nuDISxsection_CC_NusigmaInt(E_GeV,0,param)
 *             sig_CC_m = xs.nuDISxsection_CC_NusigmaInt(E_GeV,1,param)
 */
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__xs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s_14);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_7, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_NC);
      __pyx_v_sig_NC = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line546")'> 546:             sig_CC_e = xs.nuDISxsection_CC_NusigmaInt(E_GeV,0,param)</pre>
<pre id='line546' class='code' style='background-color: #FFFF44'>
      /* "optneuosc.pyx":546
 *             # new xsections
 *             sig_NC = xs.nuDISxsection_NC_NusigmaInt(E_GeV,param)
 *             sig_CC_e = xs.nuDISxsection_CC_NusigmaInt(E_GeV,0,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sig_CC_m = xs.nuDISxsection_CC_NusigmaInt(E_GeV,1,param)
 *             sig_CC_t = xs.nuDISxsection_CC_NusigmaInt(E_GeV,2,param)
 */
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__xs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s_15);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_0);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_CC_e);
      __pyx_v_sig_CC_e = __pyx_t_7;
      __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line547")'> 547:             sig_CC_m = xs.nuDISxsection_CC_NusigmaInt(E_GeV,1,param)</pre>
<pre id='line547' class='code' style='background-color: #FFFF44'>
      /* "optneuosc.pyx":547
 *             sig_NC = xs.nuDISxsection_NC_NusigmaInt(E_GeV,param)
 *             sig_CC_e = xs.nuDISxsection_CC_NusigmaInt(E_GeV,0,param)
 *             sig_CC_m = xs.nuDISxsection_CC_NusigmaInt(E_GeV,1,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sig_CC_t = xs.nuDISxsection_CC_NusigmaInt(E_GeV,2,param)
 * 
 */
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__xs);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_7, __pyx_n_s_15);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_int_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_CC_m);
      __pyx_v_sig_CC_m = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line548")'> 548:             sig_CC_t = xs.nuDISxsection_CC_NusigmaInt(E_GeV,2,param)</pre>
<pre id='line548' class='code' style='background-color: #FFFF44'>
      /* "optneuosc.pyx":548
 *             sig_CC_e = xs.nuDISxsection_CC_NusigmaInt(E_GeV,0,param)
 *             sig_CC_m = xs.nuDISxsection_CC_NusigmaInt(E_GeV,1,param)
 *             sig_CC_t = xs.nuDISxsection_CC_NusigmaInt(E_GeV,2,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             sig_total_active = sig_NC*p_active + sig_CC_e*pe + sig_CC_m*pm +sig_CC_t*pt
 */
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__xs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s_15);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_7, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_CC_t);
      __pyx_v_sig_CC_t = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line549")'> 549: </pre>
<pre id='line549' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line550")'> 550:             sig_total_active = sig_NC*p_active + sig_CC_e*pe + sig_CC_m*pm +sig_CC_t*pt</pre>
<pre id='line550' class='code' style='background-color: #FFFF31'>
      /* "optneuosc.pyx":550
 *             sig_CC_t = xs.nuDISxsection_CC_NusigmaInt(E_GeV,2,param)
 * 
 *             sig_total_active = sig_NC*p_active + sig_CC_e*pe + sig_CC_m*pm +sig_CC_t*pt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             if p_MC <code><</code>= (dsde_NC*p_active/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):
 */
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sig_NC, __pyx_v_p_active);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sig_CC_e, __pyx_v_pe);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sig_CC_m, __pyx_v_pm);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sig_CC_t, __pyx_v_pt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_total_active);
      __pyx_v_sig_total_active = __pyx_t_7;
      __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line551")'> 551: </pre>
<pre id='line551' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1c' onclick='toggleDiv("line552")'> 552:             if p_MC &lt;= (dsde_NC*p_active/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):</pre>
<pre id='line552' class='code' style='background-color: #FFFF1c'>
      /* "optneuosc.pyx":552
 *             sig_total_active = sig_NC*p_active + sig_CC_e*pe + sig_CC_m*pm +sig_CC_t*pt
 * 
 *             if p_MC <code><</code>= (dsde_NC*p_active/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 # changing energy due to NC interaction
 *                 params.E = E_MC*param.GeV
 */
      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_p_MC);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_dsde_NC, __pyx_v_p_active);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_2 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_3, __pyx_v_sig_total_active);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_9, __pyx_n_s__exp);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_v_pfac);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_v_sig_total_active);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_9));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_7, __pyx_t_1, Py_LE);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line553")'> 553:                 # changing energy due to NC interaction</pre>
<pre id='line553' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line554")'> 554:                 params.E = E_MC*param.GeV</pre>
<pre id='line554' class='code' style='background-color: #FFFF5b'>
        /* "optneuosc.pyx":554
 *             if p_MC <code><</code>= (dsde_NC*p_active/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):
 *                 # changing energy due to NC interaction
 *                 params.E = E_MC*param.GeV             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 m = m + 1
 *             elif p_MC <code><</code>= ((dsde_NC*p_active + dsde_CC_e*pe + dsde_CC_m*pm)/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):
 */
        __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_MC);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__GeV);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
        __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_v_params->E);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_params->E);
        __pyx_v_params->E = __pyx_t_7;
        __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line555")'> 555:                 m = m + 1</pre>
<pre id='line555' class='code' style='background-color: #FFFFff'>
        /* "optneuosc.pyx":555
 *                 # changing energy due to NC interaction
 *                 params.E = E_MC*param.GeV
 *                 m = m + 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             elif p_MC <code><</code>= ((dsde_NC*p_active + dsde_CC_e*pe + dsde_CC_m*pm)/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):
 *                 # discart event because of CC interation with e or muon.
 */
        __pyx_v_m = (__pyx_v_m + 1);
        goto __pyx_L7;
      }
</pre><pre class='line' style='background-color: #FFFF16' onclick='toggleDiv("line556")'> 556:             elif p_MC &lt;= ((dsde_NC*p_active + dsde_CC_e*pe + dsde_CC_m*pm)/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):</pre>
<pre id='line556' class='code' style='background-color: #FFFF16'>
      /* "optneuosc.pyx":556
 *                 params.E = E_MC*param.GeV
 *                 m = m + 1
 *             elif p_MC <code><</code>= ((dsde_NC*p_active + dsde_CC_e*pe + dsde_CC_m*pm)/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 # discart event because of CC interation with e or muon.
 *                 k = k + 1
 */
      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_p_MC);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_dsde_NC, __pyx_v_p_active);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_dsde_CC_e, __pyx_v_pe);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_dsde_CC_m, __pyx_v_pm);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_1, __pyx_v_sig_total_active);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_2, __pyx_n_s__exp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_v_pfac);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_v_sig_total_active);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_7, __pyx_t_8, Py_LE);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line557")'> 557:                 # discart event because of CC interation with e or muon.</pre>
<pre id='line557' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line558")'> 558:                 k = k + 1</pre>
<pre id='line558' class='code' style='background-color: #FFFFff'>
        /* "optneuosc.pyx":558
 *             elif p_MC <code><</code>= ((dsde_NC*p_active + dsde_CC_e*pe + dsde_CC_m*pm)/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):
 *                 # discart event because of CC interation with e or muon.
 *                 k = k + 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 neu_state   = [0.0]*(dim)
 *                 result      = [0.0]*(dim/2)
 */
        __pyx_v_k = (__pyx_v_k + 1);
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line559")'> 559:                 neu_state   = [0.0]*(dim)</pre>
<pre id='line559' class='code' style='background-color: #FFFF4b'>
        /* "optneuosc.pyx":559
 *                 # discart event because of CC interation with e or muon.
 *                 k = k + 1
 *                 neu_state   = [0.0]*(dim)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 result      = [0.0]*(dim/2)
 *                 break
 */
        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_dim);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_t_8), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neu_state);
        __pyx_v_neu_state = __pyx_t_7;
        __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line560")'> 560:                 result      = [0.0]*(dim/2)</pre>
<pre id='line560' class='code' style='background-color: #FFFF4b'>
        /* "optneuosc.pyx":560
 *                 k = k + 1
 *                 neu_state   = [0.0]*(dim)
 *                 result      = [0.0]*(dim/2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 break
 *             elif p_MC <code><</code>= ((dsde_NC*p_active + dsde_CC_e*pe + dsde_CC_m*pm+dsde_CC_t*pt)/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):
 */
        __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = <span class='py_c_api'>PyInt_FromLong</span>(__Pyx_div_long(__pyx_v_dim, 2));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_t_2), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_result);
        __pyx_v_result = __pyx_t_8;
        __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line561")'> 561:                 break</pre>
<pre id='line561' class='code' style='background-color: #FFFFff'>
        /* "optneuosc.pyx":561
 *                 neu_state   = [0.0]*(dim)
 *                 result      = [0.0]*(dim/2)
 *                 break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             elif p_MC <code><</code>= ((dsde_NC*p_active + dsde_CC_e*pe + dsde_CC_m*pm+dsde_CC_t*pt)/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):
 *                 # decay tau
 */
        goto __pyx_L5_break;
        goto __pyx_L7;
      }
</pre><pre class='line' style='background-color: #FFFF14' onclick='toggleDiv("line562")'> 562:             elif p_MC &lt;= ((dsde_NC*p_active + dsde_CC_e*pe + dsde_CC_m*pm+dsde_CC_t*pt)/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):</pre>
<pre id='line562' class='code' style='background-color: #FFFF14'>
      /* "optneuosc.pyx":562
 *                 result      = [0.0]*(dim/2)
 *                 break
 *             elif p_MC <code><</code>= ((dsde_NC*p_active + dsde_CC_e*pe + dsde_CC_m*pm+dsde_CC_t*pt)/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 # decay tau
 *                 if not PC.tauola_init:
 */
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_p_MC);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_dsde_NC, __pyx_v_p_active);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_dsde_CC_e, __pyx_v_pe);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_dsde_CC_m, __pyx_v_pm);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_dsde_CC_t, __pyx_v_pt);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_9, __pyx_v_sig_total_active);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(1.0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_7, __pyx_n_s__exp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_v_pfac);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_v_sig_total_active);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_1, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_9, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_8, __pyx_t_3, Py_LE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line563")'> 563:                 # decay tau</pre>
<pre id='line563' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line564")'> 564:                 if not PC.tauola_init:</pre>
<pre id='line564' class='code' style='background-color: #FFFF6a'>
        /* "optneuosc.pyx":564
 *             elif p_MC <code><</code>= ((dsde_NC*p_active + dsde_CC_e*pe + dsde_CC_m*pm+dsde_CC_t*pt)/sig_total_active)*(1.0-np.exp(-pfac*sig_total_active)):
 *                 # decay tau
 *                 if not PC.tauola_init:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     # decay and initialize tauola
 *                     neutrino_energies = td.TaudecayNeutrinos(E_MC)
 */
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__PC);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_7, __pyx_n_s__tauola_init);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_5 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_13 = (!__pyx_t_5);
        if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line565")'> 565:                     # decay and initialize tauola</pre>
<pre id='line565' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line566")'> 566:                     neutrino_energies = td.TaudecayNeutrinos(E_MC)</pre>
<pre id='line566' class='code' style='background-color: #FFFF44'>
          /* "optneuosc.pyx":566
 *                 if not PC.tauola_init:
 *                     # decay and initialize tauola
 *                     neutrino_energies = td.TaudecayNeutrinos(E_MC)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 else:
 *                     # decay
 */
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__td);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__TaudecayNeutrinos);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_MC);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_7, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neutrino_energies);
          __pyx_v_neutrino_energies = __pyx_t_3;
          __pyx_t_3 = 0;
          goto __pyx_L8;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line567")'> 567:                 else:</pre>
<pre id='line567' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line568")'> 568:                     # decay</pre>
<pre id='line568' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line569")'> 569:                     neutrino_energies = td.TaudecayNeutrinos(E_MC,1)</pre>
<pre id='line569' class='code' style='background-color: #FFFF41'>
          /* "optneuosc.pyx":569
 *                 else:
 *                     # decay
 *                     neutrino_energies = td.TaudecayNeutrinos(E_MC,1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *                 PC.tauola_init = True
 */
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__td);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__TaudecayNeutrinos);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_MC);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_int_1);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
          __pyx_t_3 = 0;
          __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neutrino_energies);
          __pyx_v_neutrino_energies = __pyx_t_3;
          __pyx_t_3 = 0;
        }
        __pyx_L8:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line570")'> 570: </pre>
<pre id='line570' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line571")'> 571:                 PC.tauola_init = True</pre>
<pre id='line571' class='code' style='background-color: #FFFF6a'>
        /* "optneuosc.pyx":571
 *                     neutrino_energies = td.TaudecayNeutrinos(E_MC,1)
 * 
 *                 PC.tauola_init = True             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 if neutrino_energies != []:
 *                     for i in range(0,len(neutrino_energies),2):
 */
        __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__PC);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_t_7, __pyx_n_s__tauola_init, __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line572")'> 572:                 if neutrino_energies != []:</pre>
<pre id='line572' class='code' style='background-color: #FFFF5e'>
        /* "optneuosc.pyx":572
 * 
 *                 PC.tauola_init = True
 *                 if neutrino_energies != []:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                     for i in range(0,len(neutrino_energies),2):
 *                         params.track.xini = r
 */
        __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 572; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
        __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_neutrino_energies, ((PyObject *)__pyx_t_7), Py_NE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 572; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
        __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 572; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFF1f' onclick='toggleDiv("line573")'> 573:                     for i in range(0,len(neutrino_energies),2):</pre>
<pre id='line573' class='code' style='background-color: #FFFF1f'>
          /* "optneuosc.pyx":573
 *                 PC.tauola_init = True
 *                 if neutrino_energies != []:
 *                     for i in range(0,len(neutrino_energies),2):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         params.track.xini = r
 *                         if int(neutrino_energies[i]>0):
 */
          __pyx_t_15 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_neutrino_energies);<span class='error_goto'> if (unlikely(__pyx_t_15 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 573; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 573; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 573; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_int_0);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_3);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_int_2);
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_2);
          __pyx_t_3 = 0;
          __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_range, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 573; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
          if (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
            __pyx_t_14 = 0; __pyx_t_7 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          } else {
            __pyx_t_14 = -1; __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 573; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          for (;;) {
            if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7))) {
              if (__pyx_t_14 >= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_7)) break;
              __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_7, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_14++;
            } else if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7))) {
              if (__pyx_t_14 >= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_7)) break;
              __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_7, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_14++;
            } else {
              __pyx_t_3 = <span class='py_c_api'>PyIter_Next</span>(__pyx_t_7);
              if (!__pyx_t_3) {
                if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>()))<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 573; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                break;
              }
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_i);
            __pyx_v_i = __pyx_t_3;
            __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line574")'> 574:                         params.track.xini = r</pre>
<pre id='line574' class='code' style='background-color: #FFFF79'>
            /* "optneuosc.pyx":574
 *                 if neutrino_energies != []:
 *                     for i in range(0,len(neutrino_energies),2):
 *                         params.track.xini = r             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         if int(neutrino_energies[i]>0):
 *                             param.neutype = "neutrino"
 */
            __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_r);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_v_params->track, __pyx_n_s__xini, __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line575")'> 575:                         if int(neutrino_energies[i]&gt;0):</pre>
<pre id='line575' class='code' style='background-color: #FFFF41'>
            /* "optneuosc.pyx":575
 *                     for i in range(0,len(neutrino_energies),2):
 *                         params.track.xini = r
 *                         if int(neutrino_energies[i]>0):             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             param.neutype = "neutrino"
 *                             if int(neutrino_energies[i]) == 12:
 */
            __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 575; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
            __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_int_0, Py_GT);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 575; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 575; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_8);
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
            __pyx_t_8 = 0;
            __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 575; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
            __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 575; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line576")'> 576:                             param.neutype = "neutrino"</pre>
<pre id='line576' class='code' style='background-color: #FFFFaa'>
              /* "optneuosc.pyx":576
 *                         params.track.xini = r
 *                         if int(neutrino_energies[i]>0):
 *                             param.neutype = "neutrino"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             if int(neutrino_energies[i]) == 12:
 *                                 # create electron-neutrino
 */
              if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_v_param, __pyx_n_s__neutype, ((PyObject *)__pyx_n_s__neutrino)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 576; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line577")'> 577:                             if int(neutrino_energies[i]) == 12:</pre>
<pre id='line577' class='code' style='background-color: #FFFF41'>
              /* "optneuosc.pyx":577
 *                         if int(neutrino_energies[i]>0):
 *                             param.neutype = "neutrino"
 *                             if int(neutrino_energies[i]) == 12:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # create electron-neutrino
 *                                 CalNeuOscGSL(0,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 */
              __pyx_t_8 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
              __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_8);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
              __pyx_t_8 = 0;
              __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
              __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_8, __pyx_int_12, Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
              __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
              if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line578")'> 578:                                 # create electron-neutrino</pre>
<pre id='line578' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line579")'> 579:                                 CalNeuOscGSL(0,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)</pre>
<pre id='line579' class='code' style='background-color: #FFFF34'>
                /* "optneuosc.pyx":579
 *                             if int(neutrino_energies[i]) == 12:
 *                                 # create electron-neutrino
 *                                 CalNeuOscGSL(0,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             elif int(neutrino_energies[i]) == 14:
 *                                 # create muon-neutrino
 */
                __pyx_t_3 = __pyx_int_0;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
                __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
                __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_t_8);<span class='error_goto'> if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
                __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__GeV);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
                __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
                __pyx_t_8 = __pyx_v_params->track;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
                __pyx_t_2 = __pyx_v_params->body;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
                __pyx_t_1 = __pyx_v_flavorM2;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
                __pyx_t_6 = __pyx_v_param;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
                __pyx_t_16 = __pyx_v_file;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
                __pyx_t_17 = __pyx_v_family;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
                __pyx_t_19.__pyx_n = 2;
                __pyx_t_19.file = __pyx_t_16;
                __pyx_t_19.family = __pyx_t_17;
                __pyx_t_18 = __pyx_f_9optneuosc_CalNeuOscGSL(__pyx_t_3, __pyx_t_9, __pyx_t_8, __pyx_t_2, __pyx_t_1, __pyx_t_6, 0, &__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                goto __pyx_L13;
              }
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line580")'> 580:                             elif int(neutrino_energies[i]) == 14:</pre>
<pre id='line580' class='code' style='background-color: #FFFF41'>
              /* "optneuosc.pyx":580
 *                                 # create electron-neutrino
 *                                 CalNeuOscGSL(0,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 *                             elif int(neutrino_energies[i]) == 14:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # create muon-neutrino
 *                                 CalNeuOscGSL(1,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 */
              __pyx_t_18 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_18) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
              __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_17));
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_18);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_18);
              __pyx_t_18 = 0;
              __pyx_t_18 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_17), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_17)); __pyx_t_17 = 0;
              __pyx_t_17 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_18, __pyx_int_14, Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
              __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_17);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
              if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line581")'> 581:                                 # create muon-neutrino</pre>
<pre id='line581' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line582")'> 582:                                 CalNeuOscGSL(1,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)</pre>
<pre id='line582' class='code' style='background-color: #FFFF34'>
                /* "optneuosc.pyx":582
 *                             elif int(neutrino_energies[i]) == 14:
 *                                 # create muon-neutrino
 *                                 CalNeuOscGSL(1,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             elif int(neutrino_energies[i]) == 16:
 *                                 # create tau-neutrino
 */
                __pyx_t_17 = __pyx_int_1;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
                __pyx_t_18 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
                __pyx_t_16 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_t_18);<span class='error_goto'> if (!__pyx_t_16) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                __pyx_t_18 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__GeV);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
                __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_16, __pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                __pyx_t_18 = __pyx_v_params->track;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
                __pyx_t_16 = __pyx_v_params->body;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
                __pyx_t_1 = __pyx_v_flavorM2;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
                __pyx_t_2 = __pyx_v_param;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
                __pyx_t_8 = __pyx_v_file;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
                __pyx_t_9 = __pyx_v_family;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
                __pyx_t_19.__pyx_n = 2;
                __pyx_t_19.file = __pyx_t_8;
                __pyx_t_19.family = __pyx_t_9;
                __pyx_t_3 = __pyx_f_9optneuosc_CalNeuOscGSL(__pyx_t_17, __pyx_t_6, __pyx_t_18, __pyx_t_16, __pyx_t_1, __pyx_t_2, 0, &__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                goto __pyx_L13;
              }
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line583")'> 583:                             elif int(neutrino_energies[i]) == 16:</pre>
<pre id='line583' class='code' style='background-color: #FFFF41'>
              /* "optneuosc.pyx":583
 *                                 # create muon-neutrino
 *                                 CalNeuOscGSL(1,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 *                             elif int(neutrino_energies[i]) == 16:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # create tau-neutrino
 *                                 CalNeuOscGSL(2,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 */
              __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
              __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_9));
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_3);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
              __pyx_t_3 = 0;
              __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
              __pyx_t_9 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_int_16, Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
              __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
              if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line584")'> 584:                                 # create tau-neutrino</pre>
<pre id='line584' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line585")'> 585:                                 CalNeuOscGSL(2,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)</pre>
<pre id='line585' class='code' style='background-color: #FFFF34'>
                /* "optneuosc.pyx":585
 *                             elif int(neutrino_energies[i]) == 16:
 *                                 # create tau-neutrino
 *                                 CalNeuOscGSL(2,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                         else:
 *                             param.neutype = "antineutrino"
 */
                __pyx_t_9 = __pyx_int_2;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
                __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                __pyx_t_8 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_t_3);<span class='error_goto'> if (!__pyx_t_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__GeV);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_3 = __pyx_v_params->track;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
                __pyx_t_8 = __pyx_v_params->body;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
                __pyx_t_1 = __pyx_v_flavorM2;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
                __pyx_t_16 = __pyx_v_param;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
                __pyx_t_18 = __pyx_v_file;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
                __pyx_t_6 = __pyx_v_family;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
                __pyx_t_19.__pyx_n = 2;
                __pyx_t_19.file = __pyx_t_18;
                __pyx_t_19.family = __pyx_t_6;
                __pyx_t_17 = __pyx_f_9optneuosc_CalNeuOscGSL(__pyx_t_9, __pyx_t_2, __pyx_t_3, __pyx_t_8, __pyx_t_1, __pyx_t_16, 0, &__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                goto __pyx_L13;
              }
              __pyx_L13:;
              goto __pyx_L12;
            }
            /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line586")'> 586:                         else:</pre>
<pre id='line586' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line587")'> 587:                             param.neutype = "antineutrino"</pre>
<pre id='line587' class='code' style='background-color: #FFFFaa'>
              /* "optneuosc.pyx":587
 *                                 CalNeuOscGSL(2,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 *                         else:
 *                             param.neutype = "antineutrino"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             if int(neutrino_energies[i]) == -12:
 *                                 # create electron-antineutrino
 */
              if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_v_param, __pyx_n_s__neutype, ((PyObject *)__pyx_n_s__antineutrino)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line588")'> 588:                             if int(neutrino_energies[i]) == -12:</pre>
<pre id='line588' class='code' style='background-color: #FFFF41'>
              /* "optneuosc.pyx":588
 *                         else:
 *                             param.neutype = "antineutrino"
 *                             if int(neutrino_energies[i]) == -12:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # create electron-antineutrino
 *                                 CalNeuOscGSL(0,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 */
              __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_17) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
              __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_6));
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_17);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_17);
              __pyx_t_17 = 0;
              __pyx_t_17 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_6), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
              __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_17, __pyx_int_neg_12, Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
              __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
              if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line589")'> 589:                                 # create electron-antineutrino</pre>
<pre id='line589' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line590")'> 590:                                 CalNeuOscGSL(0,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)</pre>
<pre id='line590' class='code' style='background-color: #FFFF34'>
                /* "optneuosc.pyx":590
 *                             if int(neutrino_energies[i]) == -12:
 *                                 # create electron-antineutrino
 *                                 CalNeuOscGSL(0,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             elif int(neutrino_energies[i]) == -14:
 *                                 # create muon-antineutrino
 */
                __pyx_t_6 = __pyx_int_0;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
                __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
                __pyx_t_18 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_t_17);<span class='error_goto'> if (!__pyx_t_18) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                __pyx_t_17 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__GeV);<span class='error_goto'> if (unlikely(!__pyx_t_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
                __pyx_t_16 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_18, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                __pyx_t_17 = __pyx_v_params->track;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
                __pyx_t_18 = __pyx_v_params->body;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
                __pyx_t_1 = __pyx_v_flavorM2;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
                __pyx_t_8 = __pyx_v_param;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
                __pyx_t_3 = __pyx_v_file;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
                __pyx_t_2 = __pyx_v_family;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
                __pyx_t_19.__pyx_n = 2;
                __pyx_t_19.file = __pyx_t_3;
                __pyx_t_19.family = __pyx_t_2;
                __pyx_t_9 = __pyx_f_9optneuosc_CalNeuOscGSL(__pyx_t_6, __pyx_t_16, __pyx_t_17, __pyx_t_18, __pyx_t_1, __pyx_t_8, 0, &__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
                goto __pyx_L14;
              }
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line591")'> 591:                             elif int(neutrino_energies[i]) == -14:</pre>
<pre id='line591' class='code' style='background-color: #FFFF41'>
              /* "optneuosc.pyx":591
 *                                 # create electron-antineutrino
 *                                 CalNeuOscGSL(0,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 *                             elif int(neutrino_energies[i]) == -14:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # create muon-antineutrino
 *                                 CalNeuOscGSL(1,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 */
              __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
              __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
              __pyx_t_9 = 0;
              __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
              __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_9, __pyx_int_neg_14, Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
              __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
              if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line592")'> 592:                                 # create muon-antineutrino</pre>
<pre id='line592' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF34' onclick='toggleDiv("line593")'> 593:                                 CalNeuOscGSL(1,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)</pre>
<pre id='line593' class='code' style='background-color: #FFFF34'>
                /* "optneuosc.pyx":593
 *                             elif int(neutrino_energies[i]) == -14:
 *                                 # create muon-antineutrino
 *                                 CalNeuOscGSL(1,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                             elif int(neutrino_energies[i]) == -16:
 *                                 # create tau-antineutrino
 */
                __pyx_t_2 = __pyx_int_1;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
                __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 593; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
                __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_t_9);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 593; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
                __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__GeV);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 593; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
                __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 593; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
                __pyx_t_9 = __pyx_v_params->track;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
                __pyx_t_3 = __pyx_v_params->body;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
                __pyx_t_1 = __pyx_v_flavorM2;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
                __pyx_t_18 = __pyx_v_param;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
                __pyx_t_17 = __pyx_v_file;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
                __pyx_t_16 = __pyx_v_family;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
                __pyx_t_19.__pyx_n = 2;
                __pyx_t_19.file = __pyx_t_17;
                __pyx_t_19.family = __pyx_t_16;
                __pyx_t_6 = __pyx_f_9optneuosc_CalNeuOscGSL(__pyx_t_2, __pyx_t_8, __pyx_t_9, __pyx_t_3, __pyx_t_1, __pyx_t_18, 0, &__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 593; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                goto __pyx_L14;
              }
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line594")'> 594:                             elif int(neutrino_energies[i]) == -16:</pre>
<pre id='line594' class='code' style='background-color: #FFFF41'>
              /* "optneuosc.pyx":594
 *                                 # create muon-antineutrino
 *                                 CalNeuOscGSL(1,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 *                             elif int(neutrino_energies[i]) == -16:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                                 # create tau-antineutrino
 *                                 CalNeuOscGSL(2,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 */
              __pyx_t_6 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_v_i);<span class='error_goto'> if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 594; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
              __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 594; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_16));
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_t_6);
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_6);
              __pyx_t_6 = 0;
              __pyx_t_6 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_16), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 594; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_16)); __pyx_t_16 = 0;
              __pyx_t_16 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_int_neg_16, Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 594; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_16);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
              __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_16);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 594; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
              if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line595")'> 595:                                 # create tau-antineutrino</pre>
<pre id='line595' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line596")'> 596:                                 CalNeuOscGSL(2,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)</pre>
<pre id='line596' class='code' style='background-color: #FFFF33'>
                /* "optneuosc.pyx":596
 *                             elif int(neutrino_energies[i]) == -16:
 *                                 # create tau-antineutrino
 *                                 CalNeuOscGSL(2,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 # count tau
 *                 n = n + 1
 */
                __pyx_t_16 = __pyx_int_2;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
                __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 596; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
                __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_neutrino_energies, __pyx_t_6);<span class='error_goto'> if (!__pyx_t_17) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 596; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_17);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                __pyx_t_6 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__GeV);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 596; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_6);
                __pyx_t_18 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_17, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 596; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_18);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                __pyx_t_6 = __pyx_v_params->track;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
                __pyx_t_17 = __pyx_v_params->body;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
                __pyx_t_1 = __pyx_v_flavorM2;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
                __pyx_t_3 = __pyx_v_param;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
                __pyx_t_9 = __pyx_v_file;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
                __pyx_t_8 = __pyx_v_family;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
                __pyx_t_19.__pyx_n = 2;
                __pyx_t_19.file = __pyx_t_9;
                __pyx_t_19.family = __pyx_t_8;
                __pyx_t_2 = __pyx_f_9optneuosc_CalNeuOscGSL(__pyx_t_16, __pyx_t_18, __pyx_t_6, __pyx_t_17, __pyx_t_1, __pyx_t_3, 0, &__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 596; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
                <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                goto __pyx_L14;
              }
              __pyx_L14:;
            }
            __pyx_L12:;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          goto __pyx_L9;
        }
        __pyx_L9:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line597")'> 597:                 # count tau</pre>
<pre id='line597' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line598")'> 598:                 n = n + 1</pre>
<pre id='line598' class='code' style='background-color: #FFFFff'>
        /* "optneuosc.pyx":598
 *                                 CalNeuOscGSL(2,neutrino_energies[i+1]*param.GeV,params.track,params.body,flavorM2,param,file,family)
 *                 # count tau
 *                 n = n + 1             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 break
 *             if E_GeV <code><</code>= E_threshold :
 */
        __pyx_v_n = (__pyx_v_n + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line599")'> 599:                 break</pre>
<pre id='line599' class='code' style='background-color: #FFFFff'>
        /* "optneuosc.pyx":599
 *                 # count tau
 *                 n = n + 1
 *                 break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             if E_GeV <code><</code>= E_threshold :
 *                 # discart event because of energy treshold
 */
        goto __pyx_L5_break;
        goto __pyx_L7;
      }
      __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line600")'> 600:             if E_GeV &lt;= E_threshold :</pre>
<pre id='line600' class='code' style='background-color: #FFFF79'>
      /* "optneuosc.pyx":600
 *                 n = n + 1
 *                 break
 *             if E_GeV <code><</code>= E_threshold :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 # discart event because of energy treshold
 *                 result = [0.0]*(dim/2)
 */
      __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_E_GeV, __pyx_v_E_threshold, Py_LE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line601")'> 601:                 # discart event because of energy treshold</pre>
<pre id='line601' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4b' onclick='toggleDiv("line602")'> 602:                 result = [0.0]*(dim/2)</pre>
<pre id='line602' class='code' style='background-color: #FFFF4b'>
        /* "optneuosc.pyx":602
 *             if E_GeV <code><</code>= E_threshold :
 *                 # discart event because of energy treshold
 *                 result = [0.0]*(dim/2)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 break
 *         else:
 */
        __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(0.0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = <span class='py_c_api'>PyInt_FromLong</span>(__Pyx_div_long(__pyx_v_dim, 2));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_t_2), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_result);
        __pyx_v_result = __pyx_t_8;
        __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line603")'> 603:                 break</pre>
<pre id='line603' class='code' style='background-color: #FFFFff'>
        /* "optneuosc.pyx":603
 *                 # discart event because of energy treshold
 *                 result = [0.0]*(dim/2)
 *                 break             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             E_GeV = params.E/param.GeV
 */
        goto __pyx_L5_break;
        goto __pyx_L15;
      }
      __pyx_L15:;
      goto __pyx_L6;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line604")'> 604:         else:</pre>
<pre id='line604' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line605")'> 605:             E_GeV = params.E/param.GeV</pre>
<pre id='line605' class='code' style='background-color: #FFFF73'>
      /* "optneuosc.pyx":605
 *                 break
 *         else:
 *             E_GeV = params.E/param.GeV             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             # calculate probability survival
 *             pfac = np.abs((body.density(track)/param.atomic_mass_unit)*(r_adv/param.cm))
 */
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__GeV);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_v_params->E, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_E_GeV);
      __pyx_v_E_GeV = __pyx_t_7;
      __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line606")'> 606:             # calculate probability survival</pre>
<pre id='line606' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF1d' onclick='toggleDiv("line607")'> 607:             pfac = np.abs((body.density(track)/param.atomic_mass_unit)*(r_adv/param.cm))</pre>
<pre id='line607' class='code' style='background-color: #FFFF1d'>
      /* "optneuosc.pyx":607
 *             E_GeV = params.E/param.GeV
 *             # calculate probability survival
 *             pfac = np.abs((body.density(track)/param.atomic_mass_unit)*(r_adv/param.cm))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             pe = neu_state[0]*neu_state[0]+neu_state[1]*neu_state[1]
 */
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_7, __pyx_n_s__abs);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_body, __pyx_n_s__density);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_track);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_track);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_track);
      __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_7, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__atomic_mass_unit);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_7 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_r_adv);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__cm);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_3 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_2, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_9);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_3), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pfac);
      __pyx_v_pfac = __pyx_t_9;
      __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line608")'> 608: </pre>
<pre id='line608' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line609")'> 609:             pe = neu_state[0]*neu_state[0]+neu_state[1]*neu_state[1]</pre>
<pre id='line609' class='code' style='background-color: #FFFF3f'>
      /* "optneuosc.pyx":609
 *             pfac = np.abs((body.density(track)/param.atomic_mass_unit)*(r_adv/param.cm))
 * 
 *             pe = neu_state[0]*neu_state[0]+neu_state[1]*neu_state[1]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             pm = neu_state[2]*neu_state[2]+neu_state[3]*neu_state[3]
 *             pt = neu_state[4]*neu_state[4]+neu_state[5]*neu_state[5]
 */
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 0, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 1, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 1, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pe);
      __pyx_v_pe = __pyx_t_9;
      __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line610")'> 610:             pm = neu_state[2]*neu_state[2]+neu_state[3]*neu_state[3]</pre>
<pre id='line610' class='code' style='background-color: #FFFF3f'>
      /* "optneuosc.pyx":610
 * 
 *             pe = neu_state[0]*neu_state[0]+neu_state[1]*neu_state[1]
 *             pm = neu_state[2]*neu_state[2]+neu_state[3]*neu_state[3]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             pt = neu_state[4]*neu_state[4]+neu_state[5]*neu_state[5]
 * 
 */
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 2, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 3, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 3, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pm);
      __pyx_v_pm = __pyx_t_9;
      __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line611")'> 611:             pt = neu_state[4]*neu_state[4]+neu_state[5]*neu_state[5]</pre>
<pre id='line611' class='code' style='background-color: #FFFF3f'>
      /* "optneuosc.pyx":611
 *             pe = neu_state[0]*neu_state[0]+neu_state[1]*neu_state[1]
 *             pm = neu_state[2]*neu_state[2]+neu_state[3]*neu_state[3]
 *             pt = neu_state[4]*neu_state[4]+neu_state[5]*neu_state[5]             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             p_active = pe+pm+pt
 */
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 4, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 4, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 5, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_neu_state, 5, sizeof(long), PyInt_FromLong);<span class='error_goto'> if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pt);
      __pyx_v_pt = __pyx_t_9;
      __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line612")'> 612: </pre>
<pre id='line612' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line613")'> 613:             p_active = pe+pm+pt</pre>
<pre id='line613' class='code' style='background-color: #FFFF73'>
      /* "optneuosc.pyx":613
 *             pt = neu_state[4]*neu_state[4]+neu_state[5]*neu_state[5]
 * 
 *             p_active = pe+pm+pt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             # new xsections
 */
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_pe, __pyx_v_pm);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 613; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_v_pt);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 613; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_p_active);
      __pyx_v_p_active = __pyx_t_7;
      __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line614")'> 614: </pre>
<pre id='line614' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line615")'> 615:             # new xsections</pre>
<pre id='line615' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line616")'> 616:             sig_NC = xs.nuDISxsection_NC_NusigmaInt(E_GeV,param)</pre>
<pre id='line616' class='code' style='background-color: #FFFF48'>
      /* "optneuosc.pyx":616
 * 
 *             # new xsections
 *             sig_NC = xs.nuDISxsection_NC_NusigmaInt(E_GeV,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sig_CC_e = xs.nuDISxsection_CC_NusigmaInt(E_GeV,0,param)
 *             sig_CC_m = xs.nuDISxsection_CC_NusigmaInt(E_GeV,1,param)
 */
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__xs);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_7, __pyx_n_s_14);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_9, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_NC);
      __pyx_v_sig_NC = __pyx_t_8;
      __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line617")'> 617:             sig_CC_e = xs.nuDISxsection_CC_NusigmaInt(E_GeV,0,param)</pre>
<pre id='line617' class='code' style='background-color: #FFFF44'>
      /* "optneuosc.pyx":617
 *             # new xsections
 *             sig_NC = xs.nuDISxsection_NC_NusigmaInt(E_GeV,param)
 *             sig_CC_e = xs.nuDISxsection_CC_NusigmaInt(E_GeV,0,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sig_CC_m = xs.nuDISxsection_CC_NusigmaInt(E_GeV,1,param)
 *             sig_CC_t = xs.nuDISxsection_CC_NusigmaInt(E_GeV,2,param)
 */
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__xs);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_8, __pyx_n_s_15);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_int_0);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_9 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_7, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_CC_e);
      __pyx_v_sig_CC_e = __pyx_t_9;
      __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line618")'> 618:             sig_CC_m = xs.nuDISxsection_CC_NusigmaInt(E_GeV,1,param)</pre>
<pre id='line618' class='code' style='background-color: #FFFF44'>
      /* "optneuosc.pyx":618
 *             sig_NC = xs.nuDISxsection_NC_NusigmaInt(E_GeV,param)
 *             sig_CC_e = xs.nuDISxsection_CC_NusigmaInt(E_GeV,0,param)
 *             sig_CC_m = xs.nuDISxsection_CC_NusigmaInt(E_GeV,1,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             sig_CC_t = xs.nuDISxsection_CC_NusigmaInt(E_GeV,2,param)
 * 
 */
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__xs);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 618; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_9, __pyx_n_s_15);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 618; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 618; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_9));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_int_1);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_9), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 618; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_CC_m);
      __pyx_v_sig_CC_m = __pyx_t_7;
      __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line619")'> 619:             sig_CC_t = xs.nuDISxsection_CC_NusigmaInt(E_GeV,2,param)</pre>
<pre id='line619' class='code' style='background-color: #FFFF44'>
      /* "optneuosc.pyx":619
 *             sig_CC_e = xs.nuDISxsection_CC_NusigmaInt(E_GeV,0,param)
 *             sig_CC_m = xs.nuDISxsection_CC_NusigmaInt(E_GeV,1,param)
 *             sig_CC_t = xs.nuDISxsection_CC_NusigmaInt(E_GeV,2,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             sig_total_active = sig_NC*p_active + sig_CC_e*pe + sig_CC_m*pm +sig_CC_t*pt
 */
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__xs);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_7, __pyx_n_s_15);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_E_GeV);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_int_2);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_9, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_CC_t);
      __pyx_v_sig_CC_t = __pyx_t_8;
      __pyx_t_8 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line620")'> 620: </pre>
<pre id='line620' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF31' onclick='toggleDiv("line621")'> 621:             sig_total_active = sig_NC*p_active + sig_CC_e*pe + sig_CC_m*pm +sig_CC_t*pt</pre>
<pre id='line621' class='code' style='background-color: #FFFF31'>
      /* "optneuosc.pyx":621
 *             sig_CC_t = xs.nuDISxsection_CC_NusigmaInt(E_GeV,2,param)
 * 
 *             sig_total_active = sig_NC*p_active + sig_CC_e*pe + sig_CC_m*pm +sig_CC_t*pt             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             p_survival = p_survival*np.exp(-pfac*sig_total_active)
 */
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sig_NC, __pyx_v_p_active);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sig_CC_e, __pyx_v_pe);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sig_CC_m, __pyx_v_pm);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sig_CC_t, __pyx_v_pt);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_total_active);
      __pyx_v_sig_total_active = __pyx_t_9;
      __pyx_t_9 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line622")'> 622: </pre>
<pre id='line622' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line623")'> 623:             p_survival = p_survival*np.exp(-pfac*sig_total_active)</pre>
<pre id='line623' class='code' style='background-color: #FFFF27'>
      /* "optneuosc.pyx":623
 *             sig_total_active = sig_NC*p_active + sig_CC_e*pe + sig_CC_m*pm +sig_CC_t*pt
 * 
 *             p_survival = p_survival*np.exp(-pfac*sig_total_active)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *             if survival_prob :
 */
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_p_survival);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_7, __pyx_n_s__exp);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_v_pfac);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_v_sig_total_active);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_3);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely((__pyx_t_11 == (double)-1) && <span class='py_c_api'>PyErr_Occurred</span>())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_v_p_survival = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line624")'> 624: </pre>
<pre id='line624' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line625")'> 625:             if survival_prob :</pre>
<pre id='line625' class='code' style='background-color: #FFFFaa'>
      /* "optneuosc.pyx":625
 *             p_survival = p_survival*np.exp(-pfac*sig_total_active)
 * 
 *             if survival_prob :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *                 survival_prob_list.append([ineu,neu,E_GeV,r/(body.Radius*param.km),p_survival])
 * 
 */
      __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_survival_prob);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line626")'> 626:                 survival_prob_list.append([ineu,neu,E_GeV,r/(body.Radius*param.km),p_survival])</pre>
<pre id='line626' class='code' style='background-color: #FFFF23'>
        /* "optneuosc.pyx":626
 * 
 *             if survival_prob :
 *                 survival_prob_list.append([ineu,neu,E_GeV,r/(body.Radius*param.km),p_survival])             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     if r >= track.xend or k>0.0:
 */
        if (unlikely(__pyx_v_survival_prob_list == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError, "'NoneType' object has no attribute 'append'");<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> 
        }
        __pyx_t_7 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_neu);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
        __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_r);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
        __pyx_t_9 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_body, __pyx_n_s__Radius);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_9);
        __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__km);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = __Pyx_<span class='py_c_api'>PyNumber_Divide</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_p_survival);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
        __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ineu);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_ineu);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_ineu);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_7);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_v_E_GeV);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_t_8);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 4, __pyx_t_2);
        <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
        __pyx_t_7 = 0;
        __pyx_t_8 = 0;
        __pyx_t_2 = 0;
        __pyx_t_10 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_survival_prob_list, ((PyObject *)__pyx_t_3));<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
        goto __pyx_L16;
      }
      __pyx_L16:;
    }
    __pyx_L6:;
  }
  __pyx_L5_break:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line627")'> 627: </pre>
<pre id='line627' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line628")'> 628:     if r &gt;= track.xend or k&gt;0.0:</pre>
<pre id='line628' class='code' style='background-color: #FFFF4d'>
  /* "optneuosc.pyx":628
 *                 survival_prob_list.append([ineu,neu,E_GeV,r/(body.Radius*param.km),p_survival])
 * 
 *     if r >= track.xend or k>0.0:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         # if it is out or it had a CC-mu-e interaction
 *         if complete_decoherence :
 */
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_r);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_track, __pyx_n_s__xend);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
  __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_GE);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (!__pyx_t_13) {
    __pyx_t_5 = (__pyx_v_k > 0.0);
    __pyx_t_20 = __pyx_t_5;
  } else {
    __pyx_t_20 = __pyx_t_13;
  }
  if (__pyx_t_20) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line629")'> 629:         # if it is out or it had a CC-mu-e interaction</pre>
<pre id='line629' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line630")'> 630:         if complete_decoherence :</pre>
<pre id='line630' class='code' style='background-color: #FFFFaa'>
    /* "optneuosc.pyx":630
 *     if r >= track.xend or k>0.0:
 *         # if it is out or it had a CC-mu-e interaction
 *         if complete_decoherence :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             PMNS = no.MixMatrix(param)
 *             result = CompleteDecoherenceOscProb(cvec(neu_state,param),PMNS,param)
 */
    __pyx_t_20 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_complete_decoherence);<span class='error_goto'> if (unlikely(__pyx_t_20 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 630; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (__pyx_t_20) {
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line631")'> 631:             PMNS = no.MixMatrix(param)</pre>
<pre id='line631' class='code' style='background-color: #FFFF4d'>
      /* "optneuosc.pyx":631
 *         # if it is out or it had a CC-mu-e interaction
 *         if complete_decoherence :
 *             PMNS = no.MixMatrix(param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result = CompleteDecoherenceOscProb(cvec(neu_state,param),PMNS,param)
 *         else :
 */
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__no);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_8, __pyx_n_s__MixMatrix);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_param);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
      __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_PMNS);
      __pyx_v_PMNS = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line632")'> 632:             result = CompleteDecoherenceOscProb(cvec(neu_state,param),PMNS,param)</pre>
<pre id='line632' class='code' style='background-color: #FFFF9f'>
      /* "optneuosc.pyx":632
 *         if complete_decoherence :
 *             PMNS = no.MixMatrix(param)
 *             result = CompleteDecoherenceOscProb(cvec(neu_state,param),PMNS,param)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else :
 *             result = map(float,OscProb(cvec(neu_state,param),param))
 */
      __pyx_t_3 = __pyx_v_param;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_8 = __pyx_f_9optneuosc_cvec(__pyx_v_neu_state, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __pyx_v_param;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_2 = __pyx_f_9optneuosc_CompleteDecoherenceOscProb(__pyx_t_8, __pyx_v_PMNS, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_result);
      __pyx_v_result = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L18;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line633")'> 633:         else :</pre>
<pre id='line633' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line634")'> 634:             result = map(float,OscProb(cvec(neu_state,param),param))</pre>
<pre id='line634' class='code' style='background-color: #FFFF55'>
      /* "optneuosc.pyx":634
 *             result = CompleteDecoherenceOscProb(cvec(neu_state,param),PMNS,param)
 *         else :
 *             result = map(float,OscProb(cvec(neu_state,param),param))             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     else :
 *         # discart event
 */
      __pyx_t_2 = __pyx_v_param;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      __pyx_t_3 = __pyx_f_9optneuosc_cvec(__pyx_v_neu_state, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __pyx_v_param;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      __pyx_t_8 = __pyx_f_9optneuosc_OscProb(__pyx_t_3, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((PyObject*)(&PyFloat_Type))));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)((PyObject*)(&PyFloat_Type))));
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)((PyObject*)(&PyFloat_Type))));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_8);
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_builtin_map, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_result);
      __pyx_v_result = __pyx_t_8;
      __pyx_t_8 = 0;
    }
    __pyx_L18:;
    goto __pyx_L17;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line635")'> 635:     else :</pre>
<pre id='line635' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line636")'> 636:         # discart event</pre>
<pre id='line636' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line637")'> 637:         result = []</pre>
<pre id='line637' class='code' style='background-color: #FFFF9f'>
    /* "optneuosc.pyx":637
 *     else :
 *         # discart event
 *         result = []             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     if not only_osc_prob:
 */
    __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_result);
    __pyx_v_result = ((PyObject *)__pyx_t_8);
    __pyx_t_8 = 0;
  }
  __pyx_L17:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line638")'> 638: </pre>
<pre id='line638' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line639")'> 639:     if not only_osc_prob:</pre>
<pre id='line639' class='code' style='background-color: #FFFFaa'>
  /* "optneuosc.pyx":639
 *         result = []
 * 
 *     if not only_osc_prob:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.insert(0,E_GeV)
 *         result.insert(0,E_in)
 */
  __pyx_t_20 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_only_osc_prob);<span class='error_goto'> if (unlikely(__pyx_t_20 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_13 = (!__pyx_t_20);
  if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line640")'> 640:         result.insert(0,E_GeV)</pre>
<pre id='line640' class='code' style='background-color: #FFFF4f'>
    /* "optneuosc.pyx":640
 * 
 *     if not only_osc_prob:
 *         result.insert(0,E_GeV)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.insert(0,E_in)
 *         if neu == 1:
 */
    __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_result, __pyx_n_s__insert);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_0);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_GeV);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_E_GeV);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_E_GeV);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_t_2), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line641")'> 641:         result.insert(0,E_in)</pre>
<pre id='line641' class='code' style='background-color: #FFFF46'>
    /* "optneuosc.pyx":641
 *     if not only_osc_prob:
 *         result.insert(0,E_GeV)
 *         result.insert(0,E_in)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if neu == 1:
 *             result.insert(0,1)
 */
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_result, __pyx_n_s__insert);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_in);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_int_0);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_2);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line642")'> 642:         if neu == 1:</pre>
<pre id='line642' class='code' style='background-color: #FFFFff'>
    /* "optneuosc.pyx":642
 *         result.insert(0,E_GeV)
 *         result.insert(0,E_in)
 *         if neu == 1:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             result.insert(0,1)
 *         else:
 */
    __pyx_t_13 = (__pyx_v_neu == 1);
    if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line643")'> 643:             result.insert(0,1)</pre>
<pre id='line643' class='code' style='background-color: #FFFF52'>
      /* "optneuosc.pyx":643
 *         result.insert(0,E_in)
 *         if neu == 1:
 *             result.insert(0,1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             result.insert(0,0)
 */
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_result, __pyx_n_s__insert);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_k_tuple_16), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L20;
    }
    /*else*/ {

  /* "optneuosc.pyx":643
 *         result.insert(0,E_in)
 *         if neu == 1:
 *             result.insert(0,1)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else:
 *             result.insert(0,0)
 */
  __pyx_k_tuple_16 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_k_tuple_16));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_16, 0, __pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_16, 1, __pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_1);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_16));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line644")'> 644:         else:</pre>
<pre id='line644' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line645")'> 645:             result.insert(0,0)</pre>
<pre id='line645' class='code' style='background-color: #FFFF52'>
      /* "optneuosc.pyx":645
 *             result.insert(0,1)
 *         else:
 *             result.insert(0,0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.insert(0,ineu)
 *         result.insert(0,family)
 */
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_result, __pyx_n_s__insert);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
      __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_8, ((PyObject *)__pyx_k_tuple_17), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_L20:;

  /* "optneuosc.pyx":645
 *             result.insert(0,1)
 *         else:
 *             result.insert(0,0)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.insert(0,ineu)
 *         result.insert(0,family)
 */
  __pyx_k_tuple_17 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_k_tuple_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_k_tuple_17));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_17, 0, __pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_k_tuple_17, 1, __pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_k_tuple_17));
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line646")'> 646:         result.insert(0,ineu)</pre>
<pre id='line646' class='code' style='background-color: #FFFF4f'>
    /* "optneuosc.pyx":646
 *         else:
 *             result.insert(0,0)
 *         result.insert(0,ineu)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         result.insert(0,family)
 * 
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_result, __pyx_n_s__insert);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_int_0);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ineu);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_ineu);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_ineu);
    __pyx_t_3 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF4f' onclick='toggleDiv("line647")'> 647:         result.insert(0,family)</pre>
<pre id='line647' class='code' style='background-color: #FFFF4f'>
    /* "optneuosc.pyx":647
 *             result.insert(0,0)
 *         result.insert(0,ineu)
 *         result.insert(0,family)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *         # adding also the survival probability.
 */
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_result, __pyx_n_s__insert);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_int_0);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_family);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_family);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_family);
    __pyx_t_2 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_3, ((PyObject *)__pyx_t_8), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line648")'> 648: </pre>
<pre id='line648' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line649")'> 649:         # adding also the survival probability.</pre>
<pre id='line649' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line650")'> 650:         result.insert(5+param.numneu,p_survival)</pre>
<pre id='line650' class='code' style='background-color: #FFFF37'>
    /* "optneuosc.pyx":650
 * 
 *         # adding also the survival probability.
 *         result.insert(5+param.numneu,p_survival)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     if file == None:
 */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_result, __pyx_n_s__insert);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    __pyx_t_8 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_v_param, __pyx_n_s__numneu);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_int_5, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_p_survival);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_7));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_3);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_8);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_t_8);
    __pyx_t_3 = 0;
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyObject_Call</span>(__pyx_t_2, ((PyObject *)__pyx_t_7), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    goto __pyx_L19;
  }
  __pyx_L19:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line651")'> 651: </pre>
<pre id='line651' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line652")'> 652:     if file == None:</pre>
<pre id='line652' class='code' style='background-color: #FFFF79'>
  /* "optneuosc.pyx":652
 *         result.insert(5+param.numneu,p_survival)
 * 
 *     if file == None:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         if survival_prob:
 *             return survival_prob_list
 */
  __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_file, Py_None, Py_EQ);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line653")'> 653:         if survival_prob:</pre>
<pre id='line653' class='code' style='background-color: #FFFFaa'>
    /* "optneuosc.pyx":653
 * 
 *     if file == None:
 *         if survival_prob:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *             return survival_prob_list
 *         else :
 */
    __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_survival_prob);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line654")'> 654:             return survival_prob_list</pre>
<pre id='line654' class='code' style='background-color: #FFFFd4'>
      /* "optneuosc.pyx":654
 *     if file == None:
 *         if survival_prob:
 *             return survival_prob_list             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         else :
 *             return result
 */
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_survival_prob_list));
      __pyx_r = ((PyObject *)__pyx_v_survival_prob_list);
      goto __pyx_L0;
      goto __pyx_L22;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line655")'> 655:         else :</pre>
<pre id='line655' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line656")'> 656:             return result</pre>
<pre id='line656' class='code' style='background-color: #FFFFd4'>
      /* "optneuosc.pyx":656
 *             return survival_prob_list
 *         else :
 *             return result             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     elif survival_prob:
 *         gt.hwritefile(file,survival_prob_list,param,header = False)
 */
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
      __pyx_r = __pyx_v_result;
      goto __pyx_L0;
    }
    __pyx_L22:;
    goto __pyx_L21;
  }
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line657")'> 657:     elif survival_prob:</pre>
<pre id='line657' class='code' style='background-color: #FFFFaa'>
  /* "optneuosc.pyx":657
 *         else :
 *             return result
 *     elif survival_prob:             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         gt.hwritefile(file,survival_prob_list,param,header = False)
 *     else :
 */
  __pyx_t_13 = __Pyx_<span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_survival_prob);<span class='error_goto'> if (unlikely(__pyx_t_13 <code><</code> 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 657; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_13) {
</pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line658")'> 658:         gt.hwritefile(file,survival_prob_list,param,header = False)</pre>
<pre id='line658' class='code' style='background-color: #FFFF2f'>
    /* "optneuosc.pyx":658
 *             return result
 *     elif survival_prob:
 *         gt.hwritefile(file,survival_prob_list,param,header = False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     else :
 *         gt.hwritefile(file,result,param,header = False)
 */
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__gt);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_8);
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_8, __pyx_n_s__hwritefile);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_file);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_file);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_survival_prob_list));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, ((PyObject *)__pyx_v_survival_prob_list));
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(((PyObject *)__pyx_v_survival_prob_list));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_v_param);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_2));
    __pyx_t_3 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, ((PyObject *)__pyx_n_s__header), __pyx_t_3) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyEval_CallObjectWithKeywords</span>(__pyx_t_7, ((PyObject *)__pyx_t_8), ((PyObject *)__pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L21;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line659")'> 659:     else :</pre>
<pre id='line659' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2f' onclick='toggleDiv("line660")'> 660:         gt.hwritefile(file,result,param,header = False)</pre>
<pre id='line660' class='code' style='background-color: #FFFF2f'>
    /* "optneuosc.pyx":660
 *         gt.hwritefile(file,survival_prob_list,param,header = False)
 *     else :
 *         gt.hwritefile(file,result,param,header = False)             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     # cleaning up #
 */
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetName</span>(__pyx_m, __pyx_n_s__gt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetAttr</span>(__pyx_t_3, __pyx_n_s__hwritefile);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_3));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_file);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_file);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_file);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_result);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_result);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_v_param);
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GIVEREF</span></span>(__pyx_v_param);
    __pyx_t_8 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(((PyObject *)__pyx_t_8));
    __pyx_t_7 = __Pyx_<span class='py_c_api'>PyBool_FromLong</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, ((PyObject *)__pyx_n_s__header), __pyx_t_7) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyEval_CallObjectWithKeywords</span>(__pyx_t_2, ((PyObject *)__pyx_t_3), ((PyObject *)__pyx_t_8));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  __pyx_L21:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line661")'> 661: </pre>
<pre id='line661' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line662")'> 662:     # cleaning up #</pre>
<pre id='line662' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line663")'> 663:     if neu == 0 :</pre>
<pre id='line663' class='code' style='background-color: #FFFFff'>
    /* "optneuosc.pyx":663
 * 
 *     # cleaning up #
 *     if neu == 0 :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         param.neutype = "neutrino"
 *     elif neu == 1 :
 */
    case 0:
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line664")'> 664:         param.neutype = "neutrino"</pre>
<pre id='line664' class='code' style='background-color: #FFFFaa'>
    /* "optneuosc.pyx":664
 *     # cleaning up #
 *     if neu == 0 :
 *         param.neutype = "neutrino"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *     elif neu == 1 :
 *         param.neutype = "antineutrino"
 */
    if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_v_param, __pyx_n_s__neutype, ((PyObject *)__pyx_n_s__neutrino)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 664; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line665")'> 665:     elif neu == 1 :</pre>
<pre id='line665' class='code' style='background-color: #FFFFff'>
  /* "optneuosc.pyx":665
 *     if neu == 0 :
 *         param.neutype = "neutrino"
 *     elif neu == 1 :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         param.neutype = "antineutrino"
 * 
 */
  switch (__pyx_v_neu) {

    /* "optneuosc.pyx":665
 *     if neu == 0 :
 *         param.neutype = "neutrino"
 *     elif neu == 1 :             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 *         param.neutype = "antineutrino"
 * 
 */
    case 1:
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line666")'> 666:         param.neutype = "antineutrino"</pre>
<pre id='line666' class='code' style='background-color: #FFFFaa'>
    /* "optneuosc.pyx":666
 *         param.neutype = "neutrino"
 *     elif neu == 1 :
 *         param.neutype = "antineutrino"             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 * 
 *     params = ParamsContainer()
 */
    if (<span class='py_c_api'>PyObject_SetAttr</span>(__pyx_v_param, __pyx_n_s__neutype, ((PyObject *)__pyx_n_s__antineutrino)) <code><</code> 0)<span class='error_goto'> {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    break;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line667")'> 667: </pre>
<pre id='line667' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2c' onclick='toggleDiv("line668")'> 668:     params = ParamsContainer()</pre>
<pre id='line668' class='code' style='background-color: #FFFF2c'>
  /* "optneuosc.pyx":668
 *         param.neutype = "antineutrino"
 * 
 *     params = ParamsContainer()             # <code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code><code><</code>
 */
  __pyx_t_7 = <span class='py_c_api'>PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_9optneuosc_ParamsContainer)), ((PyObject *)__pyx_empty_tuple), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 668; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_GOTREF</span></span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_params));
  __pyx_v_params = ((struct __pyx_obj_9optneuosc_ParamsContainer *)__pyx_t_7);
  __pyx_t_7 = 0;

  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("optneuosc.CalNeuOscGSL");
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_v_params);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_stepper);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_step);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_control);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_evolve);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neu_state);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_survival_prob_list);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_S);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_E_GeV);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pfac);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pe);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pm);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_pt);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_p_active);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dsde_NC);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dsde_CC_e);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dsde_CC_m);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dsde_CC_t);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_NC);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_CC_e);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_CC_m);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_CC_t);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_sig_total_active);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_neutrino_energies);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_PMNS);
  <span class='pyx_macro_api'><span class='refnanny'>__Pyx_XGIVEREF</span></span>(__pyx_r);
  <span class='pyx_c_api'><span class='refnanny'>__Pyx_RefNannyFinishContext</span></span>();
  return __pyx_r;
}
</pre></body></html>
